/*! For license information please see module.js.LICENSE.txt */
define(["react","@grafana/ui","emotion","@grafana/data","lodash","@grafana/runtime","rxjs"],(function(e,t,r,n,a,i,o){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/",r(r.s=57)}([function(t,r){t.exports=e},function(e,r){e.exports=t},function(e,t){e.exports=r},function(e,t){e.exports=n},function(e,t){e.exports=a},function(e,t){e.exports=i},function(e,t,r){const n=r(10);e.exports={re:n.re,src:n.src,tokens:n.t,SEMVER_SPEC_VERSION:r(13).SEMVER_SPEC_VERSION,SemVer:r(7),compareIdentifiers:r(19).compareIdentifiers,rcompareIdentifiers:r(19).rcompareIdentifiers,parse:r(11),valid:r(30),clean:r(31),inc:r(32),diff:r(33),major:r(34),minor:r(35),patch:r(36),prerelease:r(37),compare:r(8),rcompare:r(38),compareLoose:r(39),compareBuild:r(21),sort:r(40),rsort:r(41),gt:r(16),lt:r(22),eq:r(20),neq:r(26),gte:r(23),lte:r(24),cmp:r(27),coerce:r(42),Comparator:r(17),Range:r(9),satisfies:r(18),toComparators:r(46),maxSatisfying:r(47),minSatisfying:r(48),minVersion:r(49),validRange:r(50),outside:r(25),gtr:r(51),ltr:r(52),intersects:r(53),simplifyRange:r(54),subset:r(55)}},function(e,t,r){const n=r(14),{MAX_LENGTH:a,MAX_SAFE_INTEGER:i}=r(13),{re:o,t:s}=r(10),l=r(15),{compareIdentifiers:u}=r(19);class c{constructor(e,t){if(t=l(t),e instanceof c){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError("Invalid Version: "+e);if(e.length>a)throw new TypeError(`version is longer than ${a} characters`);n("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const r=e.trim().match(t.loose?o[s.LOOSE]:o[s.FULL]);if(!r)throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>i||this.major<0)throw new TypeError("Invalid major version");if(this.minor>i||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>i||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<i)return t}return e}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version}toString(){return this.version}compare(e){if(n("SemVer.compare",this.version,this.options,e),!(e instanceof c)){if("string"==typeof e&&e===this.version)return 0;e=new c(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof c||(e=new c(e,this.options)),u(this.major,e.major)||u(this.minor,e.minor)||u(this.patch,e.patch)}comparePre(e){if(e instanceof c||(e=new c(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const r=this.prerelease[t],a=e.prerelease[t];if(n("prerelease compare",t,r,a),void 0===r&&void 0===a)return 0;if(void 0===a)return 1;if(void 0===r)return-1;if(r!==a)return u(r,a)}while(++t)}compareBuild(e){e instanceof c||(e=new c(e,this.options));let t=0;do{const r=this.build[t],a=e.build[t];if(n("prerelease compare",t,r,a),void 0===r&&void 0===a)return 0;if(void 0===a)return 1;if(void 0===r)return-1;if(r!==a)return u(r,a)}while(++t)}inc(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{let e=this.prerelease.length;for(;--e>=0;)"number"==typeof this.prerelease[e]&&(this.prerelease[e]++,e=-2);-1===e&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this.raw=this.version,this}}e.exports=c},function(e,t,r){const n=r(7);e.exports=(e,t,r)=>new n(e,r).compare(new n(t,r))},function(e,t,r){class n{constructor(e,t){if(t=i(t),e instanceof n)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new n(e.raw,t);if(e instanceof o)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map(e=>this.parseRange(e.trim())).filter(e=>e.length),!this.set.length)throw new TypeError("Invalid SemVer Range: "+e);if(this.set.length>1){const e=this.set[0];if(this.set=this.set.filter(e=>!h(e[0])),0===this.set.length)this.set=[e];else if(this.set.length>1)for(const e of this.set)if(1===e.length&&m(e[0])){this.set=[e];break}}this.format()}format(){return this.range=this.set.map(e=>e.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(e){e=e.trim();const t=`parseRange:${Object.keys(this.options).join(",")}:${e}`,r=a.get(t);if(r)return r;const n=this.options.loose,i=n?u[c.HYPHENRANGELOOSE]:u[c.HYPHENRANGE];e=e.replace(i,T(this.options.includePrerelease)),s("hyphen replace",e),e=e.replace(u[c.COMPARATORTRIM],d),s("comparator trim",e,u[c.COMPARATORTRIM]),e=(e=(e=e.replace(u[c.TILDETRIM],p)).replace(u[c.CARETTRIM],f)).split(/\s+/).join(" ");const l=n?u[c.COMPARATORLOOSE]:u[c.COMPARATOR],m=e.split(" ").map(e=>g(e,this.options)).join(" ").split(/\s+/).map(e=>I(e,this.options)).filter(this.options.loose?e=>!!e.match(l):()=>!0).map(e=>new o(e,this.options)),v=(m.length,new Map);for(const e of m){if(h(e))return[e];v.set(e.value,e)}v.size>1&&v.has("")&&v.delete("");const y=[...v.values()];return a.set(t,y),y}intersects(e,t){if(!(e instanceof n))throw new TypeError("a Range is required");return this.set.some(r=>v(r,t)&&e.set.some(e=>v(e,t)&&r.every(r=>e.every(e=>r.intersects(e,t)))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new l(e,this.options)}catch(e){return!1}for(let t=0;t<this.set.length;t++)if(P(this.set[t],e,this.options))return!0;return!1}}e.exports=n;const a=new(r(43))({max:1e3}),i=r(15),o=r(17),s=r(14),l=r(7),{re:u,t:c,comparatorTrimReplace:d,tildeTrimReplace:p,caretTrimReplace:f}=r(10),h=e=>"<0.0.0-0"===e.value,m=e=>""===e.value,v=(e,t)=>{let r=!0;const n=e.slice();let a=n.pop();for(;r&&n.length;)r=n.every(e=>a.intersects(e,t)),a=n.pop();return r},g=(e,t)=>(s("comp",e,t),e=w(e,t),s("caret",e),e=b(e,t),s("tildes",e),e=S(e,t),s("xrange",e),e=_(e,t),s("stars",e),e),y=e=>!e||"x"===e.toLowerCase()||"*"===e,b=(e,t)=>e.trim().split(/\s+/).map(e=>E(e,t)).join(" "),E=(e,t)=>{const r=t.loose?u[c.TILDELOOSE]:u[c.TILDE];return e.replace(r,(t,r,n,a,i)=>{let o;return s("tilde",e,t,r,n,a,i),y(r)?o="":y(n)?o=`>=${r}.0.0 <${+r+1}.0.0-0`:y(a)?o=`>=${r}.${n}.0 <${r}.${+n+1}.0-0`:i?(s("replaceTilde pr",i),o=`>=${r}.${n}.${a}-${i} <${r}.${+n+1}.0-0`):o=`>=${r}.${n}.${a} <${r}.${+n+1}.0-0`,s("tilde return",o),o})},w=(e,t)=>e.trim().split(/\s+/).map(e=>x(e,t)).join(" "),x=(e,t)=>{s("caret",e,t);const r=t.loose?u[c.CARETLOOSE]:u[c.CARET],n=t.includePrerelease?"-0":"";return e.replace(r,(t,r,a,i,o)=>{let l;return s("caret",e,t,r,a,i,o),y(r)?l="":y(a)?l=`>=${r}.0.0${n} <${+r+1}.0.0-0`:y(i)?l="0"===r?`>=${r}.${a}.0${n} <${r}.${+a+1}.0-0`:`>=${r}.${a}.0${n} <${+r+1}.0.0-0`:o?(s("replaceCaret pr",o),l="0"===r?"0"===a?`>=${r}.${a}.${i}-${o} <${r}.${a}.${+i+1}-0`:`>=${r}.${a}.${i}-${o} <${r}.${+a+1}.0-0`:`>=${r}.${a}.${i}-${o} <${+r+1}.0.0-0`):(s("no pr"),l="0"===r?"0"===a?`>=${r}.${a}.${i}${n} <${r}.${a}.${+i+1}-0`:`>=${r}.${a}.${i}${n} <${r}.${+a+1}.0-0`:`>=${r}.${a}.${i} <${+r+1}.0.0-0`),s("caret return",l),l})},S=(e,t)=>(s("replaceXRanges",e,t),e.split(/\s+/).map(e=>O(e,t)).join(" ")),O=(e,t)=>{e=e.trim();const r=t.loose?u[c.XRANGELOOSE]:u[c.XRANGE];return e.replace(r,(r,n,a,i,o,l)=>{s("xRange",e,r,n,a,i,o,l);const u=y(a),c=u||y(i),d=c||y(o),p=d;return"="===n&&p&&(n=""),l=t.includePrerelease?"-0":"",u?r=">"===n||"<"===n?"<0.0.0-0":"*":n&&p?(c&&(i=0),o=0,">"===n?(n=">=",c?(a=+a+1,i=0,o=0):(i=+i+1,o=0)):"<="===n&&(n="<",c?a=+a+1:i=+i+1),"<"===n&&(l="-0"),r=`${n+a}.${i}.${o}${l}`):c?r=`>=${a}.0.0${l} <${+a+1}.0.0-0`:d&&(r=`>=${a}.${i}.0${l} <${a}.${+i+1}.0-0`),s("xRange return",r),r})},_=(e,t)=>(s("replaceStars",e,t),e.trim().replace(u[c.STAR],"")),I=(e,t)=>(s("replaceGTE0",e,t),e.trim().replace(u[t.includePrerelease?c.GTE0PRE:c.GTE0],"")),T=e=>(t,r,n,a,i,o,s,l,u,c,d,p,f)=>`${r=y(n)?"":y(a)?`>=${n}.0.0${e?"-0":""}`:y(i)?`>=${n}.${a}.0${e?"-0":""}`:o?">="+r:`>=${r}${e?"-0":""}`} ${l=y(u)?"":y(c)?`<${+u+1}.0.0-0`:y(d)?`<${u}.${+c+1}.0-0`:p?`<=${u}.${c}.${d}-${p}`:e?`<${u}.${c}.${+d+1}-0`:"<="+l}`.trim(),P=(e,t,r)=>{for(let r=0;r<e.length;r++)if(!e[r].test(t))return!1;if(t.prerelease.length&&!r.includePrerelease){for(let r=0;r<e.length;r++)if(s(e[r].semver),e[r].semver!==o.ANY&&e[r].semver.prerelease.length>0){const n=e[r].semver;if(n.major===t.major&&n.minor===t.minor&&n.patch===t.patch)return!0}return!1}return!0}},function(e,t,r){const{MAX_SAFE_COMPONENT_LENGTH:n}=r(13),a=r(14),i=(t=e.exports={}).re=[],o=t.src=[],s=t.t={};let l=0;const u=(e,t,r)=>{const n=l++;a(n,t),s[e]=n,o[n]=t,i[n]=new RegExp(t,r?"g":void 0)};u("NUMERICIDENTIFIER","0|[1-9]\\d*"),u("NUMERICIDENTIFIERLOOSE","[0-9]+"),u("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),u("MAINVERSION",`(${o[s.NUMERICIDENTIFIER]})\\.(${o[s.NUMERICIDENTIFIER]})\\.(${o[s.NUMERICIDENTIFIER]})`),u("MAINVERSIONLOOSE",`(${o[s.NUMERICIDENTIFIERLOOSE]})\\.(${o[s.NUMERICIDENTIFIERLOOSE]})\\.(${o[s.NUMERICIDENTIFIERLOOSE]})`),u("PRERELEASEIDENTIFIER",`(?:${o[s.NUMERICIDENTIFIER]}|${o[s.NONNUMERICIDENTIFIER]})`),u("PRERELEASEIDENTIFIERLOOSE",`(?:${o[s.NUMERICIDENTIFIERLOOSE]}|${o[s.NONNUMERICIDENTIFIER]})`),u("PRERELEASE",`(?:-(${o[s.PRERELEASEIDENTIFIER]}(?:\\.${o[s.PRERELEASEIDENTIFIER]})*))`),u("PRERELEASELOOSE",`(?:-?(${o[s.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${o[s.PRERELEASEIDENTIFIERLOOSE]})*))`),u("BUILDIDENTIFIER","[0-9A-Za-z-]+"),u("BUILD",`(?:\\+(${o[s.BUILDIDENTIFIER]}(?:\\.${o[s.BUILDIDENTIFIER]})*))`),u("FULLPLAIN",`v?${o[s.MAINVERSION]}${o[s.PRERELEASE]}?${o[s.BUILD]}?`),u("FULL",`^${o[s.FULLPLAIN]}$`),u("LOOSEPLAIN",`[v=\\s]*${o[s.MAINVERSIONLOOSE]}${o[s.PRERELEASELOOSE]}?${o[s.BUILD]}?`),u("LOOSE",`^${o[s.LOOSEPLAIN]}$`),u("GTLT","((?:<|>)?=?)"),u("XRANGEIDENTIFIERLOOSE",o[s.NUMERICIDENTIFIERLOOSE]+"|x|X|\\*"),u("XRANGEIDENTIFIER",o[s.NUMERICIDENTIFIER]+"|x|X|\\*"),u("XRANGEPLAIN",`[v=\\s]*(${o[s.XRANGEIDENTIFIER]})(?:\\.(${o[s.XRANGEIDENTIFIER]})(?:\\.(${o[s.XRANGEIDENTIFIER]})(?:${o[s.PRERELEASE]})?${o[s.BUILD]}?)?)?`),u("XRANGEPLAINLOOSE",`[v=\\s]*(${o[s.XRANGEIDENTIFIERLOOSE]})(?:\\.(${o[s.XRANGEIDENTIFIERLOOSE]})(?:\\.(${o[s.XRANGEIDENTIFIERLOOSE]})(?:${o[s.PRERELEASELOOSE]})?${o[s.BUILD]}?)?)?`),u("XRANGE",`^${o[s.GTLT]}\\s*${o[s.XRANGEPLAIN]}$`),u("XRANGELOOSE",`^${o[s.GTLT]}\\s*${o[s.XRANGEPLAINLOOSE]}$`),u("COERCE",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?(?:$|[^\\d])`),u("COERCERTL",o[s.COERCE],!0),u("LONETILDE","(?:~>?)"),u("TILDETRIM",`(\\s*)${o[s.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",u("TILDE",`^${o[s.LONETILDE]}${o[s.XRANGEPLAIN]}$`),u("TILDELOOSE",`^${o[s.LONETILDE]}${o[s.XRANGEPLAINLOOSE]}$`),u("LONECARET","(?:\\^)"),u("CARETTRIM",`(\\s*)${o[s.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",u("CARET",`^${o[s.LONECARET]}${o[s.XRANGEPLAIN]}$`),u("CARETLOOSE",`^${o[s.LONECARET]}${o[s.XRANGEPLAINLOOSE]}$`),u("COMPARATORLOOSE",`^${o[s.GTLT]}\\s*(${o[s.LOOSEPLAIN]})$|^$`),u("COMPARATOR",`^${o[s.GTLT]}\\s*(${o[s.FULLPLAIN]})$|^$`),u("COMPARATORTRIM",`(\\s*)${o[s.GTLT]}\\s*(${o[s.LOOSEPLAIN]}|${o[s.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",u("HYPHENRANGE",`^\\s*(${o[s.XRANGEPLAIN]})\\s+-\\s+(${o[s.XRANGEPLAIN]})\\s*$`),u("HYPHENRANGELOOSE",`^\\s*(${o[s.XRANGEPLAINLOOSE]})\\s+-\\s+(${o[s.XRANGEPLAINLOOSE]})\\s*$`),u("STAR","(<|>)?=?\\s*\\*"),u("GTE0","^\\s*>=\\s*0.0.0\\s*$"),u("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")},function(e,t,r){const{MAX_LENGTH:n}=r(13),{re:a,t:i}=r(10),o=r(7),s=r(15);e.exports=(e,t)=>{if(t=s(t),e instanceof o)return e;if("string"!=typeof e)return null;if(e.length>n)return null;if(!(t.loose?a[i.LOOSE]:a[i.FULL]).test(e))return null;try{return new o(e,t)}catch(e){return null}}},function(e,t){e.exports=o},function(e,t){const r=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:r,MAX_SAFE_COMPONENT_LENGTH:16}},function(e,t,r){(function(t){const r="object"==typeof t&&t.env&&t.env.NODE_DEBUG&&/\bsemver\b/i.test(t.env.NODE_DEBUG)?(...e)=>{}:()=>{};e.exports=r}).call(this,r(29))},function(e,t){const r=["includePrerelease","loose","rtl"];e.exports=e=>e?"object"!=typeof e?{loose:!0}:r.filter(t=>e[t]).reduce((e,t)=>(e[t]=!0,e),{}):{}},function(e,t,r){const n=r(8);e.exports=(e,t,r)=>n(e,t,r)>0},function(e,t,r){const n=Symbol("SemVer ANY");class a{static get ANY(){return n}constructor(e,t){if(t=i(t),e instanceof a){if(e.loose===!!t.loose)return e;e=e.value}u("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===n?this.value="":this.value=this.operator+this.semver.version,u("comp",this)}parse(e){const t=this.options.loose?o[s.COMPARATORLOOSE]:o[s.COMPARATOR],r=e.match(t);if(!r)throw new TypeError("Invalid comparator: "+e);this.operator=void 0!==r[1]?r[1]:"","="===this.operator&&(this.operator=""),r[2]?this.semver=new c(r[2],this.options.loose):this.semver=n}toString(){return this.value}test(e){if(u("Comparator.test",e,this.options.loose),this.semver===n||e===n)return!0;if("string"==typeof e)try{e=new c(e,this.options)}catch(e){return!1}return l(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof a))throw new TypeError("a Comparator is required");if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),""===this.operator)return""===this.value||new d(e.value,t).test(this.value);if(""===e.operator)return""===e.value||new d(this.value,t).test(e.semver);const r=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),n=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),i=this.semver.version===e.semver.version,o=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),s=l(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),u=l(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return r||n||i&&o||s||u}}e.exports=a;const i=r(15),{re:o,t:s}=r(10),l=r(27),u=r(14),c=r(7),d=r(9)},function(e,t,r){const n=r(9);e.exports=(e,t,r)=>{try{t=new n(t,r)}catch(e){return!1}return t.test(e)}},function(e,t){const r=/^[0-9]+$/,n=(e,t)=>{const n=r.test(e),a=r.test(t);return n&&a&&(e=+e,t=+t),e===t?0:n&&!a?-1:a&&!n?1:e<t?-1:1};e.exports={compareIdentifiers:n,rcompareIdentifiers:(e,t)=>n(t,e)}},function(e,t,r){const n=r(8);e.exports=(e,t,r)=>0===n(e,t,r)},function(e,t,r){const n=r(7);e.exports=(e,t,r)=>{const a=new n(e,r),i=new n(t,r);return a.compare(i)||a.compareBuild(i)}},function(e,t,r){const n=r(8);e.exports=(e,t,r)=>n(e,t,r)<0},function(e,t,r){const n=r(8);e.exports=(e,t,r)=>n(e,t,r)>=0},function(e,t,r){const n=r(8);e.exports=(e,t,r)=>n(e,t,r)<=0},function(e,t,r){const n=r(7),a=r(17),{ANY:i}=a,o=r(9),s=r(18),l=r(16),u=r(22),c=r(24),d=r(23);e.exports=(e,t,r,p)=>{let f,h,m,v,g;switch(e=new n(e,p),t=new o(t,p),r){case">":f=l,h=c,m=u,v=">",g=">=";break;case"<":f=u,h=d,m=l,v="<",g="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(s(e,t,p))return!1;for(let r=0;r<t.set.length;++r){const n=t.set[r];let o=null,s=null;if(n.forEach(e=>{e.semver===i&&(e=new a(">=0.0.0")),o=o||e,s=s||e,f(e.semver,o.semver,p)?o=e:m(e.semver,s.semver,p)&&(s=e)}),o.operator===v||o.operator===g)return!1;if((!s.operator||s.operator===v)&&h(e,s.semver))return!1;if(s.operator===g&&m(e,s.semver))return!1}return!0}},function(e,t,r){const n=r(8);e.exports=(e,t,r)=>0!==n(e,t,r)},function(e,t,r){const n=r(20),a=r(26),i=r(16),o=r(23),s=r(22),l=r(24);e.exports=(e,t,r,u)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e===r;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e!==r;case"":case"=":case"==":return n(e,r,u);case"!=":return a(e,r,u);case">":return i(e,r,u);case">=":return o(e,r,u);case"<":return s(e,r,u);case"<=":return l(e,r,u);default:throw new TypeError("Invalid operator: "+t)}}},function(e,t,r){"use strict";e.exports=r(56)},function(e,t){var r,n,a=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(r===setTimeout)return setTimeout(e,0);if((r===i||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:i}catch(e){r=i}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var l,u=[],c=!1,d=-1;function p(){c&&l&&(c=!1,l.length?u=l.concat(u):d=-1,u.length&&f())}function f(){if(!c){var e=s(p);c=!0;for(var t=u.length;t;){for(l=u,u=[];++d<t;)l&&l[d].run();d=-1,t=u.length}l=null,c=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function m(){}a.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new h(e,t)),1!==u.length||c||s(f)},h.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=m,a.addListener=m,a.once=m,a.off=m,a.removeListener=m,a.removeAllListeners=m,a.emit=m,a.prependListener=m,a.prependOnceListener=m,a.listeners=function(e){return[]},a.binding=function(e){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},function(e,t,r){const n=r(11);e.exports=(e,t)=>{const r=n(e,t);return r?r.version:null}},function(e,t,r){const n=r(11);e.exports=(e,t)=>{const r=n(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null}},function(e,t,r){const n=r(7);e.exports=(e,t,r,a)=>{"string"==typeof r&&(a=r,r=void 0);try{return new n(e,r).inc(t,a).version}catch(e){return null}}},function(e,t,r){const n=r(11),a=r(20);e.exports=(e,t)=>{if(a(e,t))return null;{const r=n(e),a=n(t),i=r.prerelease.length||a.prerelease.length,o=i?"pre":"",s=i?"prerelease":"";for(const e in r)if(("major"===e||"minor"===e||"patch"===e)&&r[e]!==a[e])return o+e;return s}}},function(e,t,r){const n=r(7);e.exports=(e,t)=>new n(e,t).major},function(e,t,r){const n=r(7);e.exports=(e,t)=>new n(e,t).minor},function(e,t,r){const n=r(7);e.exports=(e,t)=>new n(e,t).patch},function(e,t,r){const n=r(11);e.exports=(e,t)=>{const r=n(e,t);return r&&r.prerelease.length?r.prerelease:null}},function(e,t,r){const n=r(8);e.exports=(e,t,r)=>n(t,e,r)},function(e,t,r){const n=r(8);e.exports=(e,t)=>n(e,t,!0)},function(e,t,r){const n=r(21);e.exports=(e,t)=>e.sort((e,r)=>n(e,r,t))},function(e,t,r){const n=r(21);e.exports=(e,t)=>e.sort((e,r)=>n(r,e,t))},function(e,t,r){const n=r(7),a=r(11),{re:i,t:o}=r(10);e.exports=(e,t)=>{if(e instanceof n)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;let r=null;if((t=t||{}).rtl){let t;for(;(t=i[o.COERCERTL].exec(e))&&(!r||r.index+r[0].length!==e.length);)r&&t.index+t[0].length===r.index+r[0].length||(r=t),i[o.COERCERTL].lastIndex=t.index+t[1].length+t[2].length;i[o.COERCERTL].lastIndex=-1}else r=e.match(i[o.COERCE]);return null===r?null:a(`${r[2]}.${r[3]||"0"}.${r[4]||"0"}`,t)}},function(e,t,r){"use strict";const n=r(44),a=Symbol("max"),i=Symbol("length"),o=Symbol("lengthCalculator"),s=Symbol("allowStale"),l=Symbol("maxAge"),u=Symbol("dispose"),c=Symbol("noDisposeOnSet"),d=Symbol("lruList"),p=Symbol("cache"),f=Symbol("updateAgeOnGet"),h=()=>1;const m=(e,t,r)=>{const n=e[p].get(t);if(n){const t=n.value;if(v(e,t)){if(y(e,n),!e[s])return}else r&&(e[f]&&(n.value.now=Date.now()),e[d].unshiftNode(n));return t.value}},v=(e,t)=>{if(!t||!t.maxAge&&!e[l])return!1;const r=Date.now()-t.now;return t.maxAge?r>t.maxAge:e[l]&&r>e[l]},g=e=>{if(e[i]>e[a])for(let t=e[d].tail;e[i]>e[a]&&null!==t;){const r=t.prev;y(e,t),t=r}},y=(e,t)=>{if(t){const r=t.value;e[u]&&e[u](r.key,r.value),e[i]-=r.length,e[p].delete(r.key),e[d].removeNode(t)}};class b{constructor(e,t,r,n,a){this.key=e,this.value=t,this.length=r,this.now=n,this.maxAge=a||0}}const E=(e,t,r,n)=>{let a=r.value;v(e,a)&&(y(e,r),e[s]||(a=void 0)),a&&t.call(n,a.value,a.key,e)};e.exports=class{constructor(e){if("number"==typeof e&&(e={max:e}),e||(e={}),e.max&&("number"!=typeof e.max||e.max<0))throw new TypeError("max must be a non-negative number");this[a]=e.max||1/0;const t=e.length||h;if(this[o]="function"!=typeof t?h:t,this[s]=e.stale||!1,e.maxAge&&"number"!=typeof e.maxAge)throw new TypeError("maxAge must be a number");this[l]=e.maxAge||0,this[u]=e.dispose,this[c]=e.noDisposeOnSet||!1,this[f]=e.updateAgeOnGet||!1,this.reset()}set max(e){if("number"!=typeof e||e<0)throw new TypeError("max must be a non-negative number");this[a]=e||1/0,g(this)}get max(){return this[a]}set allowStale(e){this[s]=!!e}get allowStale(){return this[s]}set maxAge(e){if("number"!=typeof e)throw new TypeError("maxAge must be a non-negative number");this[l]=e,g(this)}get maxAge(){return this[l]}set lengthCalculator(e){"function"!=typeof e&&(e=h),e!==this[o]&&(this[o]=e,this[i]=0,this[d].forEach(e=>{e.length=this[o](e.value,e.key),this[i]+=e.length})),g(this)}get lengthCalculator(){return this[o]}get length(){return this[i]}get itemCount(){return this[d].length}rforEach(e,t){t=t||this;for(let r=this[d].tail;null!==r;){const n=r.prev;E(this,e,r,t),r=n}}forEach(e,t){t=t||this;for(let r=this[d].head;null!==r;){const n=r.next;E(this,e,r,t),r=n}}keys(){return this[d].toArray().map(e=>e.key)}values(){return this[d].toArray().map(e=>e.value)}reset(){this[u]&&this[d]&&this[d].length&&this[d].forEach(e=>this[u](e.key,e.value)),this[p]=new Map,this[d]=new n,this[i]=0}dump(){return this[d].map(e=>!v(this,e)&&{k:e.key,v:e.value,e:e.now+(e.maxAge||0)}).toArray().filter(e=>e)}dumpLru(){return this[d]}set(e,t,r){if((r=r||this[l])&&"number"!=typeof r)throw new TypeError("maxAge must be a number");const n=r?Date.now():0,s=this[o](t,e);if(this[p].has(e)){if(s>this[a])return y(this,this[p].get(e)),!1;const o=this[p].get(e).value;return this[u]&&(this[c]||this[u](e,o.value)),o.now=n,o.maxAge=r,o.value=t,this[i]+=s-o.length,o.length=s,this.get(e),g(this),!0}const f=new b(e,t,s,n,r);return f.length>this[a]?(this[u]&&this[u](e,t),!1):(this[i]+=f.length,this[d].unshift(f),this[p].set(e,this[d].head),g(this),!0)}has(e){if(!this[p].has(e))return!1;const t=this[p].get(e).value;return!v(this,t)}get(e){return m(this,e,!0)}peek(e){return m(this,e,!1)}pop(){const e=this[d].tail;return e?(y(this,e),e.value):null}del(e){y(this,this[p].get(e))}load(e){this.reset();const t=Date.now();for(let r=e.length-1;r>=0;r--){const n=e[r],a=n.e||0;if(0===a)this.set(n.k,n.v);else{const e=a-t;e>0&&this.set(n.k,n.v,e)}}}prune(){this[p].forEach((e,t)=>m(this,t,!1))}}},function(e,t,r){"use strict";function n(e){var t=this;if(t instanceof n||(t=new n),t.tail=null,t.head=null,t.length=0,e&&"function"==typeof e.forEach)e.forEach((function(e){t.push(e)}));else if(arguments.length>0)for(var r=0,a=arguments.length;r<a;r++)t.push(arguments[r]);return t}function a(e,t,r){var n=t===e.head?new s(r,null,t,e):new s(r,t,t.next,e);return null===n.next&&(e.tail=n),null===n.prev&&(e.head=n),e.length++,n}function i(e,t){e.tail=new s(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function o(e,t){e.head=new s(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function s(e,t,r,n){if(!(this instanceof s))return new s(e,t,r,n);this.list=n,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,r?(r.prev=this,this.next=r):this.next=null}e.exports=n,n.Node=s,n.create=n,n.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,r=e.prev;return t&&(t.prev=r),r&&(r.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=r),e.list.length--,e.next=null,e.prev=null,e.list=null,t},n.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},n.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},n.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)i(this,arguments[e]);return this.length},n.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)o(this,arguments[e]);return this.length},n.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},n.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},n.prototype.forEach=function(e,t){t=t||this;for(var r=this.head,n=0;null!==r;n++)e.call(t,r.value,n,this),r=r.next},n.prototype.forEachReverse=function(e,t){t=t||this;for(var r=this.tail,n=this.length-1;null!==r;n--)e.call(t,r.value,n,this),r=r.prev},n.prototype.get=function(e){for(var t=0,r=this.head;null!==r&&t<e;t++)r=r.next;if(t===e&&null!==r)return r.value},n.prototype.getReverse=function(e){for(var t=0,r=this.tail;null!==r&&t<e;t++)r=r.prev;if(t===e&&null!==r)return r.value},n.prototype.map=function(e,t){t=t||this;for(var r=new n,a=this.head;null!==a;)r.push(e.call(t,a.value,this)),a=a.next;return r},n.prototype.mapReverse=function(e,t){t=t||this;for(var r=new n,a=this.tail;null!==a;)r.push(e.call(t,a.value,this)),a=a.prev;return r},n.prototype.reduce=function(e,t){var r,n=this.head;if(arguments.length>1)r=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");n=this.head.next,r=this.head.value}for(var a=0;null!==n;a++)r=e(r,n.value,a),n=n.next;return r},n.prototype.reduceReverse=function(e,t){var r,n=this.tail;if(arguments.length>1)r=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");n=this.tail.prev,r=this.tail.value}for(var a=this.length-1;null!==n;a--)r=e(r,n.value,a),n=n.prev;return r},n.prototype.toArray=function(){for(var e=new Array(this.length),t=0,r=this.head;null!==r;t++)e[t]=r.value,r=r.next;return e},n.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,r=this.tail;null!==r;t++)e[t]=r.value,r=r.prev;return e},n.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var r=new n;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var a=0,i=this.head;null!==i&&a<e;a++)i=i.next;for(;null!==i&&a<t;a++,i=i.next)r.push(i.value);return r},n.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var r=new n;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var a=this.length,i=this.tail;null!==i&&a>t;a--)i=i.prev;for(;null!==i&&a>e;a--,i=i.prev)r.push(i.value);return r},n.prototype.splice=function(e,t,...r){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var n=0,i=this.head;null!==i&&n<e;n++)i=i.next;var o=[];for(n=0;i&&n<t;n++)o.push(i.value),i=this.removeNode(i);null===i&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev);for(n=0;n<r.length;n++)i=a(this,i,r[n]);return o},n.prototype.reverse=function(){for(var e=this.head,t=this.tail,r=e;null!==r;r=r.prev){var n=r.prev;r.prev=r.next,r.next=n}return this.head=t,this.tail=e,this};try{r(45)(n)}catch(e){}},function(e,t,r){"use strict";e.exports=function(e){e.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}},function(e,t,r){const n=r(9);e.exports=(e,t)=>new n(e,t).set.map(e=>e.map(e=>e.value).join(" ").trim().split(" "))},function(e,t,r){const n=r(7),a=r(9);e.exports=(e,t,r)=>{let i=null,o=null,s=null;try{s=new a(t,r)}catch(e){return null}return e.forEach(e=>{s.test(e)&&(i&&-1!==o.compare(e)||(i=e,o=new n(i,r)))}),i}},function(e,t,r){const n=r(7),a=r(9);e.exports=(e,t,r)=>{let i=null,o=null,s=null;try{s=new a(t,r)}catch(e){return null}return e.forEach(e=>{s.test(e)&&(i&&1!==o.compare(e)||(i=e,o=new n(i,r)))}),i}},function(e,t,r){const n=r(7),a=r(9),i=r(16);e.exports=(e,t)=>{e=new a(e,t);let r=new n("0.0.0");if(e.test(r))return r;if(r=new n("0.0.0-0"),e.test(r))return r;r=null;for(let t=0;t<e.set.length;++t){const a=e.set[t];let o=null;a.forEach(e=>{const t=new n(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":o&&!i(t,o)||(o=t);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+e.operator)}}),!o||r&&!i(r,o)||(r=o)}return r&&e.test(r)?r:null}},function(e,t,r){const n=r(9);e.exports=(e,t)=>{try{return new n(e,t).range||"*"}catch(e){return null}}},function(e,t,r){const n=r(25);e.exports=(e,t,r)=>n(e,t,">",r)},function(e,t,r){const n=r(25);e.exports=(e,t,r)=>n(e,t,"<",r)},function(e,t,r){const n=r(9);e.exports=(e,t,r)=>(e=new n(e,r),t=new n(t,r),e.intersects(t))},function(e,t,r){const n=r(18),a=r(8);e.exports=(e,t,r)=>{const i=[];let o=null,s=null;const l=e.sort((e,t)=>a(e,t,r));for(const e of l){n(e,t,r)?(s=e,o||(o=e)):(s&&i.push([o,s]),s=null,o=null)}o&&i.push([o,null]);const u=[];for(const[e,t]of i)e===t?u.push(e):t||e!==l[0]?t?e===l[0]?u.push("<="+t):u.push(`${e} - ${t}`):u.push(">="+e):u.push("*");const c=u.join(" || "),d="string"==typeof t.raw?t.raw:String(t);return c.length<d.length?c:t}},function(e,t,r){const n=r(9),a=r(17),{ANY:i}=a,o=r(18),s=r(8),l=(e,t,r)=>{if(e===t)return!0;if(1===e.length&&e[0].semver===i){if(1===t.length&&t[0].semver===i)return!0;e=r.includePrerelease?[new a(">=0.0.0-0")]:[new a(">=0.0.0")]}if(1===t.length&&t[0].semver===i){if(r.includePrerelease)return!0;t=[new a(">=0.0.0")]}const n=new Set;let l,d,p,f,h,m,v;for(const t of e)">"===t.operator||">="===t.operator?l=u(l,t,r):"<"===t.operator||"<="===t.operator?d=c(d,t,r):n.add(t.semver);if(n.size>1)return null;if(l&&d){if(p=s(l.semver,d.semver,r),p>0)return null;if(0===p&&(">="!==l.operator||"<="!==d.operator))return null}for(const e of n){if(l&&!o(e,String(l),r))return null;if(d&&!o(e,String(d),r))return null;for(const n of t)if(!o(e,String(n),r))return!1;return!0}let g=!(!d||r.includePrerelease||!d.semver.prerelease.length)&&d.semver,y=!(!l||r.includePrerelease||!l.semver.prerelease.length)&&l.semver;g&&1===g.prerelease.length&&"<"===d.operator&&0===g.prerelease[0]&&(g=!1);for(const e of t){if(v=v||">"===e.operator||">="===e.operator,m=m||"<"===e.operator||"<="===e.operator,l)if(y&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===y.major&&e.semver.minor===y.minor&&e.semver.patch===y.patch&&(y=!1),">"===e.operator||">="===e.operator){if(f=u(l,e,r),f===e&&f!==l)return!1}else if(">="===l.operator&&!o(l.semver,String(e),r))return!1;if(d)if(g&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===g.major&&e.semver.minor===g.minor&&e.semver.patch===g.patch&&(g=!1),"<"===e.operator||"<="===e.operator){if(h=c(d,e,r),h===e&&h!==d)return!1}else if("<="===d.operator&&!o(d.semver,String(e),r))return!1;if(!e.operator&&(d||l)&&0!==p)return!1}return!(l&&m&&!d&&0!==p)&&(!(d&&v&&!l&&0!==p)&&(!y&&!g))},u=(e,t,r)=>{if(!e)return t;const n=s(e.semver,t.semver,r);return n>0?e:n<0||">"===t.operator&&">="===e.operator?t:e},c=(e,t,r)=>{if(!e)return t;const n=s(e.semver,t.semver,r);return n<0?e:n>0||"<"===t.operator&&"<="===e.operator?t:e};e.exports=(e,t,r={})=>{if(e===t)return!0;e=new n(e,r),t=new n(t,r);let a=!1;e:for(const n of e.set){for(const e of t.set){const t=l(n,e,r);if(a=a||null!==t,t)continue e}if(a)return!1}return!0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={DataSource:{TestData:{QueryTab:{scenarioSelectContainer:"Test Data Query scenario select container",scenarioSelect:"Test Data Query scenario select",max:"TestData max",min:"TestData min",noise:"TestData noise",seriesCount:"TestData series count",spread:"TestData spread",startValue:"TestData start value"}}},Panels:{Panel:{title:function(e){return"Panel header title item "+e},headerItems:function(e){return"Panel header item "+e},containerByTitle:function(e){return"Panel container title "+e},headerCornerInfo:function(e){return"Panel header "+e}},Visualization:{Graph:{VisualizationTab:{legendSection:"Legend section"},Legend:{legendItemAlias:function(e){return"gpl alias "+e},showLegendSwitch:"gpl show legend"},xAxis:{labels:function(){return"div.flot-x-axis > div.flot-tick-label"}}},BarGauge:{value:"Bar gauge value"},Text:{container:function(){return".markdown-html"}}}},Drawer:{General:{title:function(e){return"Drawer title "+e},expand:"Drawer expand",contract:"Drawer contract",close:"Drawer close",rcContentWrapper:function(){return".drawer-content-wrapper"}}},PanelEditor:{General:{content:"Panel editor content"},OptionsPane:{content:"Panel editor option pane content",close:"Page toolbar button Close options pane",open:"Page toolbar button Open options pane",select:"Panel editor option pane select",tab:function(e){return"Panel editor option pane tab "+e}},DataPane:{content:"Panel editor data pane content"},FieldOptions:{propertyEditor:function(e){return e+" field property editor"}}},PanelInspector:{Data:{content:"Panel inspector Data content"},Stats:{content:"Panel inspector Stats content"},Json:{content:"Panel inspector Json content"},Query:{content:"Panel inspector Query content",refreshButton:"Panel inspector Query refresh button",jsonObjectKeys:function(){return".json-formatter-key"}}},Tab:{title:function(e){return"Tab "+e},active:function(){return'[class*="-activeTabStyle"]'}},RefreshPicker:{runButton:"RefreshPicker run button"},QueryTab:{content:"Query editor tab content",queryInspectorButton:"Query inspector button",addQuery:"Query editor add query button"},QueryEditorRows:{rows:"Query editor row"},QueryEditorRow:{actionButton:function(e){return e+" query operation action"},title:function(e){return"Query editor row title "+e}},AlertTab:{content:"Alert editor tab content"},Alert:{alert:function(e){return"Alert "+e}},TransformTab:{content:"Transform editor tab content",newTransform:function(e){return"New transform "+e},transformationEditor:function(e){return"Transformation editor "+e},transformationEditorDebugger:function(e){return"Transformation editor debugger "+e}},Transforms:{card:function(e){return"New transform "+e},Reduce:{modeLabel:"Transform mode label",calculationsLabel:"Transform calculations label"},searchInput:"search transformations"},PageToolbar:{container:function(){return".page-toolbar"},item:function(e){return"Page toolbar button "+e}},QueryEditorToolbarItem:{button:function(e){return"QueryEditor toolbar item button "+e}},BackButton:{backArrow:"Go Back button"},OptionsGroup:{toggle:function(e){return e?"Options group "+e:"Options group"}},PluginVisualization:{item:function(e){return"Plugin visualization item "+e},current:function(){return'[class*="-currentVisualizationItem"]'}},Select:{option:"Select option",input:function(){return'input[id*="react-select-"]'},singleValue:function(){return'div[class*="-singleValue"]'}},FieldConfigEditor:{content:"Field config editor content"},OverridesConfigEditor:{content:"Field overrides editor content"},FolderPicker:{container:"Folder picker select container"},DataSourcePicker:{container:"Data source picker select container"},TimeZonePicker:{container:"Time zone picker select container"},TraceViewer:{spanBar:function(){return'[data-test-id="SpanBar--wrapper"]'}},QueryField:{container:"Query field"},ValuePicker:{button:"Value picker add button",select:function(e){return"Value picker select "+e}},Search:{section:"Search section",items:"Search items"},DashboardLinks:{container:"Dashboard link container",dropDown:"Dashboard link dropdown",link:"Dashboard link"},CallToActionCard:{button:function(e){return"Call to action button "+e}},DataLinksContextMenu:{singleLink:"Data link"}},a={pages:{Login:{url:"/login",username:"Username input field",password:"Password input field",submit:"Login button",skip:"Skip change password button"},Home:{url:"/"},DataSource:{name:"Data source settings page name input field",delete:"Data source settings page Delete button",saveAndTest:"Data source settings page Save and Test button",alert:"Data source settings page Alert"},DataSources:{url:"/datasources",dataSources:function(e){return"Data source list item "+e}},AddDataSource:{url:"/datasources/new",dataSourcePlugins:function(e){return"Data source plugin item "+e}},ConfirmModal:{delete:"Confirm Modal Danger Button"},AddDashboard:{url:"/dashboard/new",addNewPanel:"Add new panel"},Dashboard:{url:function(e){return"/d/"+e},SubMenu:{submenuItem:"Dashboard template variables submenu item",submenuItemLabels:function(e){return"Dashboard template variables submenu Label "+e},submenuItemValueDropDownValueLinkTexts:function(e){return"Dashboard template variables Variable Value DropDown value link text "+e},submenuItemValueDropDownDropDown:"Dashboard template variables Variable Value DropDown DropDown",submenuItemValueDropDownOptionTexts:function(e){return"Dashboard template variables Variable Value DropDown option text "+e}},Settings:{General:{deleteDashBoard:"Dashboard settings page delete dashboard button",sectionItems:function(e){return"Dashboard settings section item "+e},saveDashBoard:"Dashboard settings aside actions Save button",saveAsDashBoard:"Dashboard settings aside actions Save As button",timezone:"Time zone picker select container",title:"Dashboard settings page title"},Annotations:{List:{addAnnotationCTA:n.CallToActionCard.button("Add Annotation Query")}},Variables:{List:{addVariableCTA:n.CallToActionCard.button("Add variable"),newButton:"Variable editor New variable button",table:"Variable editor Table",tableRowNameFields:function(e){return"Variable editor Table Name field "+e},tableRowDefinitionFields:function(e){return"Variable editor Table Definition field "+e},tableRowArrowUpButtons:function(e){return"Variable editor Table ArrowUp button "+e},tableRowArrowDownButtons:function(e){return"Variable editor Table ArrowDown button "+e},tableRowDuplicateButtons:function(e){return"Variable editor Table Duplicate button "+e},tableRowRemoveButtons:function(e){return"Variable editor Table Remove button "+e}},Edit:{General:{headerLink:"Variable editor Header link",modeLabelNew:"Variable editor Header mode New",modeLabelEdit:"Variable editor Header mode Edit",generalNameInput:"Variable editor Form Name field",generalTypeSelect:"Variable editor Form Type select",generalLabelInput:"Variable editor Form Label field",generalHideSelect:"Variable editor Form Hide select",selectionOptionsMultiSwitch:"Variable editor Form Multi switch",selectionOptionsIncludeAllSwitch:"Variable editor Form IncludeAll switch",selectionOptionsCustomAllInput:"Variable editor Form IncludeAll field",previewOfValuesOption:"Variable editor Preview of Values option",submitButton:"Variable editor Submit button"},QueryVariable:{queryOptionsDataSourceSelect:n.DataSourcePicker.container,queryOptionsRefreshSelect:"Variable editor Form Query Refresh select",queryOptionsRegExInput:"Variable editor Form Query RegEx field",queryOptionsSortSelect:"Variable editor Form Query Sort select",queryOptionsQueryInput:"Variable editor Form Default Variable Query Editor textarea",valueGroupsTagsEnabledSwitch:"Variable editor Form Query UseTags switch",valueGroupsTagsTagsQueryInput:"Variable editor Form Query TagsQuery field",valueGroupsTagsTagsValuesQueryInput:"Variable editor Form Query TagsValuesQuery field"},ConstantVariable:{constantOptionsQueryInput:"Variable editor Form Constant Query field"},TextBoxVariable:{textBoxOptionsQueryInput:"Variable editor Form TextBox Query field"}}}}},Dashboards:{url:"/dashboards",dashboards:function(e){return"Dashboard search item "+e}},SaveDashboardAsModal:{newName:"Save dashboard title field",save:"Save dashboard button"},SaveDashboardModal:{save:"Dashboard settings Save Dashboard Modal Save button",saveVariables:"Dashboard settings Save Dashboard Modal Save variables checkbox",saveTimerange:"Dashboard settings Save Dashboard Modal Save timerange checkbox"},SharePanelModal:{linkToRenderedImage:"Link to rendered image"},Explore:{url:"/explore",General:{container:"Explore",graph:"Explore Graph",table:"Explore Table",scrollBar:function(){return".scrollbar-view"}},Toolbar:{navBar:function(){return".explore-toolbar"}}},SoloPanel:{url:function(e){return"/d-solo/"+e}},PluginsList:{page:"Plugins list page",list:"Plugins list",listItem:"Plugins list item",signatureErrorNotice:"Unsigned plugins notice"},PluginPage:{page:"Plugin page",signatureInfo:"Plugin signature info"}},components:n};t.selectors=a},function(e,t,r){"use strict";r.r(t);var n=r(3),a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var o=function(){return(o=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function s(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r}function l(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{l(n.next(e))}catch(e){i(e)}}function s(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}l((n=n.apply(e,t||[])).next())}))}function u(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}Object.create;function c(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function d(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,a,i=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)o.push(n.value)}catch(e){a={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return o}function p(e,t){for(var r=0,n=t.length,a=e.length;r<n;r++,a++)e[a]=t[r];return e}function f(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}Object.create;var h=r(4),m=r.n(h),v=r(12),g=function(e,t){return(g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function y(e,t){function r(){this.constructor=e}g(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function b(e){return"function"==typeof e}var E=!1,w={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){if(e);E=e},get useDeprecatedSynchronousErrorHandling(){return E}};function x(e){setTimeout((function(){throw e}),0)}var S={closed:!0,next:function(e){},error:function(e){if(w.useDeprecatedSynchronousErrorHandling)throw e;x(e)},complete:function(){}},O=function(){return Array.isArray||function(e){return e&&"number"==typeof e.length}}();var _=function(){function e(e){return Error.call(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e}(),I=function(){function e(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}return e.prototype.unsubscribe=function(){var t;if(!this.closed){var r,n=this._parentOrParents,a=this._ctorUnsubscribe,i=this._unsubscribe,o=this._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,n instanceof e)n.remove(this);else if(null!==n)for(var s=0;s<n.length;++s){n[s].remove(this)}if(b(i)){a&&(this._unsubscribe=void 0);try{i.call(this)}catch(e){t=e instanceof _?T(e.errors):[e]}}if(O(o)){s=-1;for(var l=o.length;++s<l;){var u=o[s];if(null!==(r=u)&&"object"==typeof r)try{u.unsubscribe()}catch(e){t=t||[],e instanceof _?t=t.concat(T(e.errors)):t.push(e)}}}if(t)throw new _(t)}},e.prototype.add=function(t){var r=t;if(!t)return e.EMPTY;switch(typeof t){case"function":r=new e(t);case"object":if(r===this||r.closed||"function"!=typeof r.unsubscribe)return r;if(this.closed)return r.unsubscribe(),r;if(!(r instanceof e)){var n=r;(r=new e)._subscriptions=[n]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var a=r._parentOrParents;if(null===a)r._parentOrParents=this;else if(a instanceof e){if(a===this)return r;r._parentOrParents=[a,this]}else{if(-1!==a.indexOf(this))return r;a.push(this)}var i=this._subscriptions;return null===i?this._subscriptions=[r]:i.push(r),r},e.prototype.remove=function(e){var t=this._subscriptions;if(t){var r=t.indexOf(e);-1!==r&&t.splice(r,1)}},e.EMPTY=function(e){return e.closed=!0,e}(new e),e}();function T(e){return e.reduce((function(e,t){return e.concat(t instanceof _?t.errors:t)}),[])}var P=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),A=function(e){function t(r,n,a){var i=e.call(this)||this;switch(i.syncErrorValue=null,i.syncErrorThrown=!1,i.syncErrorThrowable=!1,i.isStopped=!1,arguments.length){case 0:i.destination=S;break;case 1:if(!r){i.destination=S;break}if("object"==typeof r){r instanceof t?(i.syncErrorThrowable=r.syncErrorThrowable,i.destination=r,r.add(i)):(i.syncErrorThrowable=!0,i.destination=new F(i,r));break}default:i.syncErrorThrowable=!0,i.destination=new F(i,r,n,a)}return i}return y(t,e),t.prototype[P]=function(){return this},t.create=function(e,r,n){var a=new t(e,r,n);return a.syncErrorThrowable=!1,a},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t.prototype._unsubscribeAndRecycle=function(){var e=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this},t}(I),F=function(e){function t(t,r,n,a){var i,o=e.call(this)||this;o._parentSubscriber=t;var s=o;return b(r)?i=r:r&&(i=r.next,n=r.error,a=r.complete,r!==S&&(b((s=Object.create(r)).unsubscribe)&&o.add(s.unsubscribe.bind(s)),s.unsubscribe=o.unsubscribe.bind(o))),o._context=s,o._next=i,o._error=n,o._complete=a,o}return y(t,e),t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;w.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}},t.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber,r=w.useDeprecatedSynchronousErrorHandling;if(this._error)r&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)r?(t.syncErrorValue=e,t.syncErrorThrown=!0):x(e),this.unsubscribe();else{if(this.unsubscribe(),r)throw e;x(e)}}},t.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var r=function(){return e._complete.call(e._context)};w.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,r),this.unsubscribe()):(this.__tryOrUnsub(r),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(e){if(this.unsubscribe(),w.useDeprecatedSynchronousErrorHandling)throw e;x(e)}},t.prototype.__tryOrSetError=function(e,t,r){if(!w.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,r)}catch(t){return w.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=t,e.syncErrorThrown=!0,!0):(x(t),!0)}return!1},t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()},t}(A);function k(e,t){return function(r){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return r.lift(new N(e,t))}}var j,D,N=function(){function e(e,t){this.project=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new L(e,this.project,this.thisArg))},e}(),L=function(e){function t(t,r,n){var a=e.call(this,t)||this;return a.project=r,a.count=0,a.thisArg=n||a,a}return y(t,e),t.prototype._next=function(e){var t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(A);function R(e,t){var r=(t=t||{}).delimiter||".",n=t.maxDepth||3,a=1,i={};return function e(o,s){Object.keys(o).forEach((function(l){var u=o[l],c=(null==t?void 0:t.safe)&&Array.isArray(u),d="[object Object]"===Object.prototype.toString.call(u),p=s?s+r+l:l;if((null==t?void 0:t.maxDepth)||(n=a+1),!c&&d&&Object.keys(u).length&&a<n)return++a,e(u,p);i[p]=u}))}(e,null),i}!function(e){e.Lucene="lucene",e.PPL="PPL"}(j||(j={})),function(e){e.Elasticsearch="elasticsearch",e.OpenSearch="opensearch"}(D||(D={}));var $,C=function(e){return B[e.type].requiresField},M=function(e){return B[e.type].isPipelineAgg},V=function(e){return B[e.type].supportsMultipleBucketPaths},q=function(e){return B[e.type].hasSettings},B={count:{label:"Count",requiresField:!1,isPipelineAgg:!1,supportsMissing:!1,supportsMultipleBucketPaths:!1,hasSettings:!1,hasMeta:!1,supportsInlineScript:!1,defaults:{}},avg:{label:"Average",requiresField:!0,supportsInlineScript:!0,supportsMissing:!0,isPipelineAgg:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,hasMeta:!1,defaults:{}},sum:{label:"Sum",requiresField:!0,supportsInlineScript:!0,supportsMissing:!0,isPipelineAgg:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,hasMeta:!1,defaults:{}},max:{label:"Max",requiresField:!0,supportsInlineScript:!0,supportsMissing:!0,isPipelineAgg:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,hasMeta:!1,defaults:{}},min:{label:"Min",requiresField:!0,supportsInlineScript:!0,supportsMissing:!0,isPipelineAgg:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,hasMeta:!1,defaults:{}},extended_stats:{label:"Extended Stats",requiresField:!0,supportsMissing:!0,supportsInlineScript:!0,isPipelineAgg:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,hasMeta:!0,defaults:{meta:{std_deviation_bounds_lower:!0,std_deviation_bounds_upper:!0}}},percentiles:{label:"Percentiles",requiresField:!0,supportsMissing:!0,supportsInlineScript:!0,isPipelineAgg:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,hasMeta:!1,defaults:{settings:{percents:["25","50","75","95","99"]}}},cardinality:{label:"Unique Count",requiresField:!0,supportsMissing:!0,isPipelineAgg:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,supportsInlineScript:!1,hasMeta:!1,defaults:{}},moving_avg:{label:"Moving Average",requiresField:!0,isPipelineAgg:!0,supportsMissing:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,supportsInlineScript:!1,hasMeta:!1,defaults:{settings:{model:"simple",window:5}}},moving_fn:{label:"Moving Function",requiresField:!0,isPipelineAgg:!0,supportsMultipleBucketPaths:!1,supportsInlineScript:!1,supportsMissing:!1,hasMeta:!1,hasSettings:!0,defaults:{},versionRange:($={},$[D.Elasticsearch]=">=7.0.0",$)},derivative:{label:"Derivative",requiresField:!0,isPipelineAgg:!0,supportsMissing:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,supportsInlineScript:!1,hasMeta:!1,defaults:{}},cumulative_sum:{label:"Cumulative Sum",requiresField:!0,isPipelineAgg:!0,supportsMissing:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,supportsInlineScript:!1,hasMeta:!1,defaults:{}},bucket_script:{label:"Bucket Script",requiresField:!1,isPipelineAgg:!0,supportsMissing:!1,supportsMultipleBucketPaths:!0,hasSettings:!0,supportsInlineScript:!1,hasMeta:!1,defaults:{pipelineVariables:[{name:"var1",pipelineAgg:""}]}},raw_document:{label:"Raw Document (legacy)",requiresField:!1,isSingleMetric:!0,isPipelineAgg:!1,supportsMissing:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,supportsInlineScript:!1,hasMeta:!1,defaults:{settings:{size:"500"}}},raw_data:{label:"Raw Data",requiresField:!1,isSingleMetric:!0,isPipelineAgg:!1,supportsMissing:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,supportsInlineScript:!1,hasMeta:!1,defaults:{settings:{size:"500"}}},logs:{label:"Logs",requiresField:!1,isPipelineAgg:!1,supportsMissing:!1,supportsMultipleBucketPaths:!1,hasSettings:!1,supportsInlineScript:!1,hasMeta:!1,defaults:{}}},Q={moving_avg:[{label:"window",default:5},{label:"model",default:"simple"},{label:"predict"},{label:"minimize",default:!1}],moving_fn:[{label:"window",default:5},{label:"script"}],derivative:[{label:"unit"}],cumulative_sum:[{label:"format"}],bucket_script:[]},G=[{label:"Avg",value:"avg"},{label:"Min",value:"min"},{label:"Max",value:"max"},{label:"Sum",value:"sum"},{label:"Count",value:"count"},{label:"Std Dev",value:"std_deviation"},{label:"Std Dev Upper",value:"std_deviation_bounds_upper"},{label:"Std Dev Lower",value:"std_deviation_bounds_lower"}],U=[{label:"Simple",value:"simple"},{label:"Linear",value:"linear"},{label:"Exponentially Weighted",value:"ewma"},{label:"Holt Linear",value:"holt"},{label:"Holt Winters",value:"holt_winters"}];function z(e){return void 0===e&&(e="1"),{type:"count",id:e}}function H(e){return void 0===e&&(e="1"),{type:"date_histogram",id:e,settings:{interval:"auto"}}}var W=function(e,t){return e.find((function(e){return e.id===t}))};var Y=function(){function e(e){var t,r,n,a;if(this.columns=[],this.columnMap={},this.rows=[],this.type="table",e){if(e.columns)try{for(var i=c(e.columns),o=i.next();!o.done;o=i.next()){var s=o.value;this.addColumn(s)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}if(e.rows)try{for(var l=c(e.rows),u=l.next();!u.done;u=l.next()){var d=u.value;this.addRow(d)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(a=l.return)&&a.call(l)}finally{if(n)throw n.error}}}}return e.prototype.sort=function(e){null===e.col||this.columns.length<=e.col||(this.rows.sort((function(t,r){return+(null==(t=t[e.col]))-+(null==(r=r[e.col]))||+(t>r)||-(t<r)})),e.desc&&this.rows.reverse(),this.columns[e.col].sort=!0,this.columns[e.col].desc=e.desc)},e.prototype.addColumn=function(e){this.columnMap[e.text]||(this.columns.push(e),this.columnMap[e.text]=e)},e.prototype.addRow=function(e){this.rows.push(e)},e}(),X=Y;function J(e){return(J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var K=function(e){return C(e)?B[e.type].label+" "+e.field:B[e.type].label},Z=function e(t){return Object.entries(t).reduce((function(t,r){var n,a,i=d(r,2),s=i[0],l=i[1];if(null==l)return o({},t);if(Array.isArray(l)&&0===l.length)return o({},t);if(0===(null==l?void 0:l.length))return o({},t);if(!Array.isArray(l)&&"object"===J(l)){var u=e(l);return 0===Object.keys(u).length?o({},t):o(o({},t),((n={})[s]=u,n))}return o(o({},t),((a={})[s]=l,a))}),{})},ee=function(){function e(e,t,r){var n=this;void 0===r&&(r=j.Lucene),this.targets=e,this.response=t,this.targetType=r,this.processResponseToSeries=function(){for(var e,t=[],r=0;r<n.response.responses.length;r++){var a=n.response.responses[r],i=n.targets[r];if(a.error)throw n.getErrorFromResponse(n.response,a.error);if(a.hits&&a.hits.hits.length>0&&n.processHits(a.hits,t,i),a.aggregations){var o=a.aggregations,s=n.targets[r],l=[],u=new X;u.refId=s.refId,n.processBuckets(o,s,l,u,{},0),n.trimDatapoints(l,s),n.nameSeries(l,s);for(var c=0;c<l.length;c++)t.push(l[c]);u.rows.length>0&&t.push(u)}}return{data:t,key:null===(e=n.targets[0])||void 0===e?void 0:e.refId}},this.processPPLResponseToSeries=function(){var e,t=n.targets[0],r=n.response,a=[];if(r.datarows.length>0){if(r.error)throw n.getErrorFromResponse(n.response,r.error);var i=ne(r),o=i.datapoints,s=i.targetVal;if(i.invalidTS)throw n.getInvalidPPLQuery(n.response);var l={datapoints:o,props:r.schema,refId:t.refId,target:s};a.push(l)}return{data:a,key:null===(e=n.targets[0])||void 0===e?void 0:e.refId}},this.targets=e,this.response=t,this.targetType=r}return e.prototype.processMetrics=function(e,t,r,n){for(var a,i=0;i<t.metrics.length;i++){var o=t.metrics[i];if(!o.hide)switch(o.type){case"count":a={datapoints:[],metric:"count",props:n,refId:t.refId};for(var s=0;s<e.buckets.length;s++){var l=(h=e.buckets[s]).doc_count;a.datapoints.push([l,h.key])}r.push(a);break;case"percentiles":if(0===e.buckets.length)break;var u=e.buckets[0][o.id].values;for(var c in u){a={datapoints:[],metric:"p"+c,props:n,field:o.field,refId:t.refId};for(s=0;s<e.buckets.length;s++){var d=(h=e.buckets[s])[o.id].values;a.datapoints.push([d[c],h.key])}r.push(a)}break;case"extended_stats":for(var p in o.meta)if(o.meta[p]){a={datapoints:[],metric:p,props:n,field:o.field,refId:t.refId};for(s=0;s<e.buckets.length;s++){var f=(h=e.buckets[s])[o.id];f.std_deviation_bounds_upper=f.std_deviation_bounds.upper,f.std_deviation_bounds_lower=f.std_deviation_bounds.lower,a.datapoints.push([f[p],h.key])}r.push(a)}break;default:a={datapoints:[],metric:o.type,metricId:o.id,props:n,refId:t.refId},C(o)&&(a.field=o.field);for(s=0;s<e.buckets.length;s++){var h;void 0!==(l=(h=e.buckets[s])[o.id])&&(l.normalized_value?a.datapoints.push([l.normalized_value,h.key]):a.datapoints.push([l.value,h.key]))}r.push(a)}}},e.prototype.processAggregationDocs=function(e,t,r,n,a){var i,o,s,l,u,d,p,f,h;if(0===n.columns.length){try{for(var v=c(m.a.keys(a)),g=v.next();!g.done;g=v.next()){var y=g.value;n.addColumn({text:y,filterable:!0})}}catch(e){i={error:e}}finally{try{g&&!g.done&&(o=v.return)&&o.call(v)}finally{if(i)throw i.error}}n.addColumn({text:t.field,filterable:!0})}var b=function(e,t,r){n.addColumn({text:t}),e.push(r)},E=m.a.isArray(e.buckets)?e.buckets:[e.buckets];try{for(var w=c(E),x=w.next();!x.done;x=w.next()){var S=x.value,O=[];try{for(var _=(u=void 0,c(m.a.values(a))),I=_.next();!I.done;I=_.next()){var T=I.value;O.push(T)}}catch(e){u={error:e}}finally{try{I&&!I.done&&(d=_.return)&&d.call(_)}finally{if(u)throw u.error}}O.push(S.key);try{for(var P=(p=void 0,c(r.metrics||[])),A=P.next();!A.done;A=P.next()){var F=A.value;switch(F.type){case"count":b(O,this.getMetricName(F.type),S.doc_count);break;case"extended_stats":for(var k in F.meta)if(F.meta[k]){var j=S[F.id];j.std_deviation_bounds_upper=j.std_deviation_bounds.upper,j.std_deviation_bounds_lower=j.std_deviation_bounds.lower,b(O,this.getMetricName(k),j[k])}break;case"percentiles":var D=S[F.id].values;for(var N in D)b(O,"p"+N+" "+F.field,D[N]);break;default:var L=this.getMetricName(F.type);m.a.filter(r.metrics,{type:F.type}).length>1&&(C(F)&&(L+=" "+F.field),"bucket_script"===F.type&&(L=(null===(h=F.settings)||void 0===h?void 0:h.script)||"")),b(O,L,S[F.id].value)}}}catch(e){p={error:e}}finally{try{A&&!A.done&&(f=P.return)&&f.call(P)}finally{if(p)throw p.error}}n.rows.push(O)}}catch(e){s={error:e}}finally{try{x&&!x.done&&(l=w.return)&&l.call(w)}finally{if(s)throw s.error}}},e.prototype.processBuckets=function(e,t,r,n,a,i){var o,s,l,u,c=t.bucketAggs.length-1;for(u in e)if(s=m.a.find(t.bucketAggs,{id:u}),l=e[u],s)if(i===c)"date_histogram"===s.type?this.processMetrics(l,t,r,a):this.processAggregationDocs(l,s,t,n,a);else for(var d in l.buckets)o=l.buckets[d],a=m.a.clone(a),void 0!==o.key?a[s.field]=o.key:a.filter=d,o.key_as_string&&(a[s.field]=o.key_as_string),this.processBuckets(o,t,r,n,a,i+1)},e.prototype.getMetricName=function(e){var t=Object.entries(B).filter((function(t){return d(t,1)[0]===e})).map((function(e){var t=d(e,2);t[0];return t[1]}))[0];if(t)return t.label;var r=G.find((function(t){return t.value===e}));return r?r.label:e},e.prototype.getSeriesName=function(e,t,r){var n,a,i=this.getMetricName(e.metric);if(t.alias){return t.alias.replace(/\{\{([\s\S]+?)\}\}/g,(function(t,r,n){var a=r||n;return 0===a.indexOf("term ")?e.props[a.substring(5)]:void 0!==e.props[a]?e.props[a]:"metric"===a?i:"field"===a?e.field||"":t}))}if(e.metric in Q)if(e.metric&&function(e){return!!B[e].supportsMultipleBucketPaths}(e.metric)){var o=m.a.find(t.metrics,{id:e.metricId});if(o&&o.settings.script){i=o.settings.script;try{for(var s=c(o.pipelineVariables),l=s.next();!l.done;l=s.next()){var u=l.value;(d=m.a.find(t.metrics,{id:u.pipelineAgg}))&&(i=i.replace("params."+u.name,K(d)))}}catch(e){n={error:e}}finally{try{l&&!l.done&&(a=s.return)&&a.call(s)}finally{if(n)throw n.error}}}else i="Unset"}else{var d;(d=m.a.find(t.metrics,{id:e.field}))?i+=" "+K(d):i="Unset"}else e.field&&(i+=" "+e.field);if(0===m.a.keys(e.props).length)return i;var p="";for(var f in e.props)p+=e.props[f]+" ";return 1===r?p.trim():p.trim()+" "+i},e.prototype.nameSeries=function(e,t){for(var r=m.a.uniq(m.a.map(e,"metric")).length,n=0;n<e.length;n++){var a=e[n];a.target=this.getSeriesName(a,t,r)}},e.prototype.processHits=function(e,t,r){var n,a,i,o,s="number"==typeof e.total?e.total:e.total.value,l={target:r.refId,type:"docs",refId:r.refId,datapoints:[],total:s,filterable:!0};for(o=0;o<e.hits.length;o++){if(i={_id:(a=e.hits[o])._id,_type:a._type,_index:a._index},a._source)for(n in a._source)i[n]=a._source[n];for(n in a.fields)i[n]=a.fields[n];l.datapoints.push(i)}t.push(l)},e.prototype.trimDatapoints=function(e,t){var r=m.a.find(t.bucketAggs,{type:"date_histogram"});if(r&&r.settings&&r.settings.trimEdges){var n=r.settings.trimEdges;for(var a in e){var i=e[a];i.datapoints.length>2*n&&(i.datapoints=i.datapoints.slice(n,i.datapoints.length-n))}}},e.prototype.getErrorFromResponse=function(e,t){var r={};return r.data=JSON.stringify(t,null,4),t.root_cause&&t.root_cause.length>0&&t.root_cause[0].reason?r.message=t.root_cause[0].reason:r.message=t.reason||"Unknown OpenSearch error response",e.$$config&&(r.config=e.$$config),r},e.prototype.getInvalidPPLQuery=function(e){var t={message:"Invalid time series query"};return e.$$config&&(t.config=e.$$config),t},e.prototype.getTimeSeries=function(){return this.targetType===j.PPL?this.processPPLResponseToSeries():this.targets.some((function(e){var t;return null===(t=e.metrics)||void 0===t?void 0:t.some((function(e){return"raw_data"===e.type}))}))?this.processResponseToDataFrames(!1):this.processResponseToSeries()},e.prototype.getLogs=function(e,t){return this.targetType===j.PPL?this.processPPLResponseToDataFrames(!0,e,t):this.processResponseToDataFrames(!0,e,t)},e.prototype.getTable=function(){return this.processPPLResponseToDataFrames(!1)},e.prototype.processResponseToDataFrames=function(e,t,r){for(var a,i,o,s=[],l=0;l<this.response.responses.length;l++){var u=this.response.responses[l];if(u.error)throw this.getErrorFromResponse(this.response,u.error);if(u.hits&&u.hits.hits.length>0){var d=te(u.hits.hits),p=d.propNames,f=d.docs;if(f.length>0){var h=ae(p,this.targets[0].timeField,e,this.targetType,t,r);try{for(var m=(a=void 0,c(f)),v=m.next();!v.done;v=m.next()){var g=v.value;r&&(g.level=g[r]),h.add(g)}}catch(e){a={error:e}}finally{try{v&&!v.done&&(i=m.return)&&i.call(m)}finally{if(a)throw a.error}}e&&(h=ie(h,"logs"));var y=this.targets[l];h.refId=y.refId,s.push(h)}}if(u.aggregations){var b=u.aggregations,E=(y=this.targets[l],[]),w=new X;if(this.processBuckets(b,y,E,w,{},0),this.trimDatapoints(E,y),this.nameSeries(E,y),w.rows.length>0)(h=Object(n.toDataFrame)(w)).refId=y.refId,s.push(h);for(var x=0;x<E.length;x++){h=Object(n.toDataFrame)(E[x]);e&&(h=ie(h,"graph")),h.refId=y.refId,s.push(h)}}}return{data:s,key:null===(o=this.targets[0])||void 0===o?void 0:o.refId}},e.prototype.processPPLResponseToDataFrames=function(e,t,r){var n,a,i;if(this.response.error)throw this.getErrorFromResponse(this.response,this.response.error);var o=[],s=this.response.schema.map((function(e){return e.name})),l=m.a.map(this.response.datarows,(function(e){return m.a.zipObject(s,e)})),u=re(l),d=u.flattenSchema,p=u.docs;if(l.length>0){var f=ae(d,this.targets[0].timeField,e,this.targetType,t,r);try{for(var h=c(p),v=h.next();!v.done;v=h.next()){var g=v.value;r&&(g.level=g[r]),f.add(g)}}catch(e){n={error:e}}finally{try{v&&!v.done&&(a=h.return)&&a.call(h)}finally{if(n)throw n.error}}e&&(f=ie(f,"logs"));var y=this.targets[0];f.refId=y.refId,o.push(f)}return{data:o,key:null===(i=this.targets[0])||void 0===i?void 0:i.refId}},e}(),te=function(e){var t,r,n,a,i=[],s=[];try{for(var l=c(e),u=l.next();!u.done;u=l.next()){var d=u.value,p=d._source?R(d._source):{},f=o({_id:d._id,_type:d._type,_index:d._index,_source:o({},p)},p);try{for(var h=(n=void 0,c(Object.keys(f))),m=h.next();!m.done;m=h.next()){var v=m.value;-1===s.indexOf(v)&&s.push(v)}}catch(e){n={error:e}}finally{try{m&&!m.done&&(a=h.return)&&a.call(h)}finally{if(n)throw n.error}}i.push(f)}}catch(e){t={error:e}}finally{try{u&&!u.done&&(r=l.return)&&r.call(l)}finally{if(t)throw t.error}}return s.sort(),{docs:i,propNames:s}},re=function(e){var t,r,n,a,i=[],o=[];try{for(var s=c(e),l=s.next();!l.done;l=s.next()){var u=R(l.value);try{for(var d=(n=void 0,c(Object.keys(u))),p=d.next();!p.done;p=d.next()){var f=p.value;-1===o.indexOf(f)&&o.push(f)}}catch(e){n={error:e}}finally{try{p&&!p.done&&(a=d.return)&&a.call(d)}finally{if(n)throw n.error}}i.push(u)}}catch(e){t={error:e}}finally{try{l&&!l.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}return{docs:i,flattenSchema:o}},ne=function(e){var t,r=!1,a=m.a.findIndex(e.schema,(function(e){return"timestamp"===e.type||"datetime"===e.type||"date"===e.type})),i=0===a?1:0;return-1!==a&&2===e.datarows[0].length&&"number"==typeof e.datarows[0][i]||(r=!0),{datapoints:m.a.map(e.datarows,(function(e){var t=m.a.clone(e),r=d(t.splice(a,1),1)[0];return t.push(1e3*Object(n.dateTime)(r).unix()),t})),targetVal:null===(t=e.schema[i])||void 0===t?void 0:t.name,invalidTS:r}},ae=function(e,t,r,a,i,o){var s,l,u=new n.MutableDataFrame({fields:[]});(a===j.Lucene||r)&&u.addField({config:{filterable:!0},name:t,type:n.FieldType.time}),i&&(u.addField({name:i,type:n.FieldType.string}).parse=function(e){return e||""}),o&&(u.addField({name:"level",type:n.FieldType.string}).parse=function(e){return e||""});var d=u.fields.map((function(e){return e.name}));try{for(var p=c(e),f=p.next();!f.done;f=p.next()){var h=f.value;d.includes(h)||(r||"_source"!==h)&&(u.addField({config:{filterable:!0},name:h,type:n.FieldType.string}).parse=function(e){return e||""})}}catch(e){s={error:e}}finally{try{f&&!f.done&&(l=p.return)&&l.call(p)}finally{if(s)throw s.error}}return u},ie=function(e,t){var r=e;return r.meta?r.meta.preferredVisualisationType=t:r.meta={preferredVisualisationType:t},r},oe={Hourly:{startOf:"hour",amount:"hours"},Daily:{startOf:"day",amount:"days"},Weekly:{startOf:"isoWeek",amount:"weeks"},Monthly:{startOf:"month",amount:"months"},Yearly:{startOf:"year",amount:"years"}},se=function(){function e(e,t){this.pattern=e,this.interval=t,this.dateLocale="en"}return e.prototype.getIndexForToday=function(){return this.interval?Object(n.toUtc)().locale(this.dateLocale).format(this.pattern):this.pattern},e.prototype.getIndexList=function(e,t){if(!this.interval)return this.pattern;for(var r=oe[this.interval],a=Object(n.dateTime)(e||Object(n.dateTime)(t).add(-7,r.amount)).utc().startOf(r.startOf),i=Object(n.dateTime)(t||Object(n.dateTime)(e).add(7,r.amount)).utc().startOf(r.startOf).valueOf(),o=[];a.valueOf()<=i;)o.push(a.locale(this.dateLocale).format(this.pattern)),a.add(1,r.amount);return o},e.prototype.getPPLIndexPattern=function(){if(!this.interval)return this.pattern;var e=this.pattern.match(/\[(.*?)\]/)[1];return this.pattern.startsWith("[")?e+="*":this.pattern.endsWith("]")&&(e="*"+e),e},e}(),le=r(6),ue=function(){function e(e){this.timeField=e.timeField,this.version=e.version,this.flavor=e.flavor}return e.prototype.getRangeFilter=function(){var e={};return e[this.timeField]={gte:"$timeFrom",lte:"$timeTo",format:"epoch_millis"},e},e.prototype.buildTermsAgg=function(e,t,r){var n,a,i,o;if(t.terms={field:e.field},!e.settings)return t;var s=(null===(i=e.settings)||void 0===i?void 0:i.size)?parseInt(e.settings.size,10):500;if(t.terms.size=0===s?500:s,void 0!==e.settings.orderBy&&(t.terms.order={},"_term"===e.settings.orderBy&&(this.flavor===D.Elasticsearch&&Object(le.gte)(this.version,"6.0.0")||this.flavor===D.OpenSearch)?t.terms.order._key=e.settings.order:t.terms.order[e.settings.orderBy]=e.settings.order,o=parseInt(e.settings.orderBy,10),!isNaN(o)))try{for(var l=c(r.metrics||[]),u=l.next();!u.done;u=l.next()){var d=u.value;if(d.id===e.settings.orderBy){t.aggs={},t.aggs[d.id]={},C(d)&&(t.aggs[d.id][d.type]={field:d.field});break}}}catch(e){n={error:e}}finally{try{u&&!u.done&&(a=l.return)&&a.call(l)}finally{if(n)throw n.error}}return void 0!==e.settings.min_doc_count&&(t.terms.min_doc_count=parseInt(e.settings.min_doc_count,10),isNaN(t.terms.min_doc_count)&&(t.terms.min_doc_count=e.settings.min_doc_count)),e.settings.missing&&(t.terms.missing=e.settings.missing),t},e.prototype.getDateHistogramAgg=function(e){var t={},r=e.settings||{};return t.interval=r.interval,t.field=this.timeField,t.min_doc_count=r.min_doc_count||0,t.extended_bounds={min:"$timeFrom",max:"$timeTo"},t.format="epoch_millis",""!==r.offset&&(t.offset=r.offset),"auto"===t.interval&&(t.interval="$__interval"),t},e.prototype.getHistogramAgg=function(e){var t={},r=e.settings||{};return t.interval=r.interval,t.field=e.field,t.min_doc_count=r.min_doc_count||0,t},e.prototype.getFiltersAgg=function(e){var t,r,n,a={};try{for(var i=c((null===(n=e.settings)||void 0===n?void 0:n.filters)||[]),o=i.next();!o.done;o=i.next()){var s=o.value,l=s.query;a[s.label||l]={query_string:{query:l,analyze_wildcard:!0}}}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return a},e.prototype.documentQuery=function(e,t){return e.size=t,e.sort={},e.sort[this.timeField]={order:"desc",unmapped_type:"boolean"},this.flavor===D.Elasticsearch&&Object(le.lt)(this.version,"5.0.0")&&(e.fields=["*","_source"]),e.script_fields={},e},e.prototype.addAdhocFilters=function(e,t){var r,n,a,i;if(t)for(r=0;r<t.length;r++)switch((a={})[(n=t[r]).key]=n.value,(i={})[n.key]={query:n.value},n.operator){case"=":e.query.bool.must||(e.query.bool.must=[]),e.query.bool.must.push({match_phrase:i});break;case"!=":e.query.bool.must_not||(e.query.bool.must_not=[]),e.query.bool.must_not.push({match_phrase:i});break;case"<":a[n.key]={lt:n.value},e.query.bool.filter.push({range:a});break;case">":a[n.key]={gt:n.value},e.query.bool.filter.push({range:a});break;case"=~":e.query.bool.filter.push({regexp:a});break;case"!~":e.query.bool.filter.push({bool:{must_not:{regexp:a}}})}},e.prototype.build=function(e,t,r){var n,a,i,s,l,u,c,d,p,f,h;e.metrics=e.metrics||[z()],e.bucketAggs=e.bucketAggs||[H()],e.timeField=this.timeField,e.queryType=j.Lucene;var m={size:0,query:{bool:{filter:[{range:this.getRangeFilter()},{query_string:{analyze_wildcard:!0,query:r}}]}}};if(this.addAdhocFilters(m,t),0===e.bucketAggs.length&&(!(h=e.metrics[0])||"raw_document"!==h.type&&"raw_data"!==h.type))throw{message:"Invalid query"};if("raw_document"===(null===(a=null===(n=e.metrics)||void 0===n?void 0:n[0])||void 0===a?void 0:a.type)||"raw_data"===(null===(s=null===(i=e.metrics)||void 0===i?void 0:i[0])||void 0===s?void 0:s.type)){var v=(null===(l=(h=e.metrics[0]).settings)||void 0===l?void 0:l.size)?parseInt(h.settings.size,10):500;return this.documentQuery(m,v||500)}for(f=m,c=0;c<e.bucketAggs.length;c++){var g=e.bucketAggs[c],y={};switch(g.type){case"date_histogram":y.date_histogram=this.getDateHistogramAgg(g);break;case"histogram":y.histogram=this.getHistogramAgg(g);break;case"filters":y.filters={filters:this.getFiltersAgg(g)};break;case"terms":this.buildTermsAgg(g,y,e);break;case"geohash_grid":y.geohash_grid={field:g.field,precision:null===(u=g.settings)||void 0===u?void 0:u.precision}}f.aggs=f.aggs||{},f.aggs[g.id]=y,f=y}for(f.aggs={},c=0;c<e.metrics.length;c++)if("count"!==(h=e.metrics[c]).type){var b={},E=null;if(M(h))if(V(h)){if(!h.pipelineVariables)continue;for(E={buckets_path:{}},d=0;d<h.pipelineVariables.length;d++){if((p=h.pipelineVariables[d]).name&&p.pipelineAgg&&/^\d*$/.test(p.pipelineAgg))(w=W(e.metrics,p.pipelineAgg))&&("count"===w.type?E.buckets_path[p.name]="_count":E.buckets_path[p.name]=p.pipelineAgg)}}else{if(!h.field||!/^\d*$/.test(h.field))continue;var w;(w=W(e.metrics,h.field))&&(E="count"===w.type?{buckets_path:"_count"}:{buckets_path:h.field})}else C(h)&&(E={field:h.field});E=o(o({},E),q(h)&&h.settings),b[h.type]=E,f.aggs[h.id]=b}return m},e.prototype.getTermsQuery=function(e){var t={size:0,query:{bool:{filter:[{range:this.getRangeFilter()}]}}};e.query&&t.query.bool.filter.push({query_string:{analyze_wildcard:!0,query:e.query}});var r=500;e.size&&(r=e.size),t.aggs={1:{terms:{field:e.field,size:r,order:{}}}};var n=e.orderBy,a=void 0===n?"key":n,i=e.order,o=void 0===i?"doc_count"===a?"desc":"asc":i;if(["asc","desc"].indexOf(o)<0)throw{message:"Invalid query sort order "+o};switch(a){case"key":case"term":var s=this.flavor===D.Elasticsearch&&Object(le.lt)(this.version,"6.0.0")?"_term":"_key";t.aggs[1].terms.order[s]=o;break;case"doc_count":t.aggs[1].terms.order._count=o;break;default:throw{message:"Invalid query sort type "+a}}return t},e.prototype.getLogsQuery=function(e,t,r){var n={size:0,query:{bool:{filter:[{range:this.getRangeFilter()}]}}};return this.addAdhocFilters(n,t),e.query&&n.query.bool.filter.push({query_string:{analyze_wildcard:!0,query:r}}),n=this.documentQuery(n,500),o(o({},n),{aggs:this.build(e,null,r).aggs})},e.prototype.addPPLAdhocFilters=function(e,t){var r,a,i;for(r=0;r<t.length;r++){if(n.dateMath.isValid(t[r].value))a="timestamp('"+Object(n.dateTime)(t[r].value).format("YYYY-MM-DD HH:mm:ss.SSSSSS")+"')";else a="string"==typeof t[r].value?"'"+t[r].value+"'":t[r].value;i="`"+t[r].key+"` "+t[r].operator+" "+a,e+=r>0?" and "+i:" | where "+i}return e},e.prototype.buildPPLQuery=function(e,t,r){e.format=e.format||"table",e.queryType=j.PPL,e.isLogsQuery="logs"===e.format,t&&(r=this.addPPLAdhocFilters(r,t));var n=" where $timestamp >= timestamp('$timeFrom') and $timestamp <= timestamp('$timeTo')";if(r){var a=r.indexOf("|");r=-1===a?[r.trimEnd(),n].join(" |"):[r.slice(0,a).trimEnd(),n,r.slice(a+1)].join(" |")}return{query:r}},e}(),ce=r(5),de={terms:{label:"Terms",requiresField:!0,defaultSettings:{min_doc_count:"0",size:"10",order:"desc",orderBy:"_term"}},filters:{label:"Filters",requiresField:!1,defaultSettings:{filters:[{label:"",query:"*"}]}},geohash_grid:{label:"Geo Hash Grid",requiresField:!0,defaultSettings:{precision:"3"}},date_histogram:{label:"Date Histogram",requiresField:!0,defaultSettings:{interval:"auto",min_doc_count:"0",trimEdges:"0"}},histogram:{label:"Histogram",requiresField:!0,defaultSettings:{interval:"1000",min_doc_count:"0"}}},pe=[{label:"Top",value:"desc"},{label:"Bottom",value:"asc"}],fe=[{label:"No limit",value:"0"},{label:"1",value:"1"},{label:"2",value:"2"},{label:"3",value:"3"},{label:"5",value:"5"},{label:"10",value:"10"},{label:"15",value:"15"},{label:"20",value:"20"}],he=[{label:"Term value",value:"_term"},{label:"Doc Count",value:"_count"}],me=[{label:"auto",value:"auto"},{label:"10s",value:"10s"},{label:"1m",value:"1m"},{label:"5m",value:"5m"},{label:"10m",value:"10m"},{label:"20m",value:"20m"},{label:"1h",value:"1h"},{label:"1d",value:"1d"}],ve=function(e){return de[e.type].requiresField};function ge(e){return(ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var ye=["_index","_type","_id","_source","_size","_field_names","_ignored","_routing","_meta"],be=function(e){function t(t){var r,n,a=e.call(this,t)||this;a.basicAuth=t.basicAuth,a.withCredentials=t.withCredentials,a.url=t.url,a.name=t.name;var i=t.jsonData||{};return a.index=null!==(r=i.database)&&void 0!==r?r:"",a.timeField=i.timeField,a.flavor=i.flavor||D.OpenSearch,a.version=i.version,a.indexPattern=new se(a.index,i.interval),a.interval=i.timeInterval,a.maxConcurrentShardRequests=i.maxConcurrentShardRequests,a.queryBuilder=new ue({timeField:a.timeField,flavor:a.flavor,version:a.version}),a.logMessageField=i.logMessageField||"",a.logLevelField=i.logLevelField||"",a.dataLinks=i.dataLinks||[],""===a.logMessageField&&(a.logMessageField=void 0),""===a.logLevelField&&(a.logLevelField=void 0),a.pplEnabled=null===(n=i.pplEnabled)||void 0===n||n,a}return i(t,e),t.prototype.request=function(e,t,r){var n={url:this.url+"/"+t,method:e,data:r};return(this.basicAuth||this.withCredentials)&&(n.withCredentials=!0),this.basicAuth&&(n.headers={Authorization:this.basicAuth}),Object(ce.getBackendSrv)().datasourceRequest(n).catch((function(e){if(e.data&&e.data.error)throw{message:"OpenSearch error: "+e.data.error.reason+". "+e.data.error.details,error:e.data.error};throw e}))},t.prototype.get=function(e,t){void 0===t&&(t=Object(n.getDefaultTimeRange)());var r=this.indexPattern.getIndexList(t.from,t.to);return m.a.isArray(r)&&r.length?this.requestAllIndices(r,e).then((function(e){return e.data.$$config=e.config,e.data})):this.request("GET",this.indexPattern.getIndexForToday()+e).then((function(e){return e.data.$$config=e.config,e.data}))},t.prototype.requestAllIndices=function(e,t){return l(this,void 0,Promise,(function(){var r,n,a,i;return u(this,(function(o){switch(o.label){case 0:r=7,n=e.length,a=0,o.label=1;case 1:if(!(a<Math.min(n,r)))return[3,6];o.label=2;case 2:return o.trys.push([2,4,,5]),[4,this.request("GET",e[n-a-1]+t)];case 3:return[2,o.sent()];case 4:if(404!==(i=o.sent()).status||a===r-1)throw i;return[3,5];case 5:return a++,[3,1];case 6:return[2]}}))}))},t.prototype.post=function(e,t){return this.request("POST",e,t).then((function(e){return e.data.$$config=e.config,e.data}))},t.prototype.annotationQuery=function(e){var t=e.annotation,r=t.timeField||"@timestamp",a=t.timeEndField||null,i=t.query||"*",o=t.tagsField||"tags",s=t.textField||null,l=[],u={};if(u[r]={from:e.range.from.valueOf(),to:e.range.to.valueOf(),format:"epoch_millis"},l.push({range:u}),a){var c={};c[a]={from:e.range.from.valueOf(),to:e.range.to.valueOf(),format:"epoch_millis"},l.push({range:c})}var d={query:{bool:{filter:[{bool:{should:l,minimum_should_match:1}},{query_string:{query:Object(ce.getTemplateSrv)().replace(i,{},"lucene")}}]}},size:1e4};this.flavor===D.Elasticsearch&&Object(le.lt)(this.version,"5.0.0")&&(d.fields=[r,"_source"]);var p={search_type:"query_then_fetch",ignore_unavailable:!0};t.index?p.index=t.index:p.index=this.indexPattern.getIndexList(e.range.from,e.range.to);var f=JSON.stringify(p)+"\n"+JSON.stringify(d)+"\n";return this.post("_msearch",f).then((function(e){for(var i=[],l=e.responses[0].hits.hits,u=function(e,t){if(t){for(var r=t.split("."),n=e,a=0;a<r.length;a++)if(!(n=n[r[a]]))return"";return n}},c=0;c<l.length;c++){var d=l[c]._source,p=u(d,r);if(void 0!==l[c].fields){var f=l[c].fields;(m.a.isString(f[r])||m.a.isNumber(f[r]))&&(p=f[r])}var h={annotation:t,time:Object(n.toUtc)(p).valueOf(),text:u(d,s),tags:u(d,o)};if(a){var v=u(d,a);v&&(h.timeEnd=Object(n.toUtc)(v).valueOf())}if(t.titleField){var g=u(d,t.titleField);g&&(h.text=g+"\n"+h.text)}"string"==typeof h.tags&&(h.tags=h.tags.split(",")),i.push(h)}return i}))},t.prototype.interpolateLuceneQuery=function(e,t){return Object(ce.getTemplateSrv)().replace(e,t,"lucene")||"*"},t.prototype.interpolatePPLQuery=function(e,t){return Object(ce.getTemplateSrv)().replace(e,t,"pipe")},t.prototype.interpolateVariablesInQueries=function(e,t){var r=this,n=e;return e&&e.length>0&&(n=e.map((function(e){var n,a,i,s,l,u;u=e.queryType===j.PPL?r.interpolatePPLQuery(e.query||"",t):r.interpolateLuceneQuery(e.query||"",t);var d=o(o({},e),{datasource:r.name,query:u});try{for(var p=c(e.bucketAggs||[]),f=p.next();!f.done;f=p.next()){var h=f.value;if("filters"===h.type)try{for(var m=(i=void 0,c((null===(l=h.settings)||void 0===l?void 0:l.filters)||[])),v=m.next();!v.done;v=m.next()){var g=v.value;g.query=r.interpolateLuceneQuery(g.query,t)}}catch(e){i={error:e}}finally{try{v&&!v.done&&(s=m.return)&&s.call(m)}finally{if(i)throw i.error}}}}catch(e){n={error:e}}finally{try{f&&!f.done&&(a=p.return)&&a.call(p)}finally{if(n)throw n.error}}return d}))),n},t.prototype.testDatasource=function(){var e=this;return this.getFields("date").then((function(t){return m.a.find(t,{text:e.timeField})?{status:"success",message:"Index OK. Time field name OK."}:{status:"error",message:"No date field named "+e.timeField+" found"}}),(function(e){return e.message?{status:"error",message:e.message}:{status:"error",message:e.status}}))},t.prototype.getQueryHeader=function(e,t,r){var n={search_type:e,ignore_unavailable:!0,index:this.indexPattern.getIndexList(t,r)};return this.flavor===D.Elasticsearch&&Object(le.satisfies)(this.version,">=5.6.0 <7.0.0")&&(n.max_concurrent_shard_requests=this.maxConcurrentShardRequests),JSON.stringify(n)},t.prototype.getQueryDisplayText=function(e){var t=e.metrics,r=e.bucketAggs,n="";return e.query&&(n+="Query: "+e.query+", "),n+="Metrics: ",n+=null==t?void 0:t.reduce((function(e,t){var r,n,a=B[t.type].label+"(";return C(t)&&(a+=t.field),V(t)&&(a+=null===(n=null===(r=t.settings)||void 0===r?void 0:r.script)||void 0===n?void 0:n.replace(new RegExp("params.","g"),"")),e+" "+(a+="), ")}),""),n+=null==r?void 0:r.reduce((function(e,t,r){var n="";return 0===r&&(n+=" Group by: "),n+=de[t.type].label+"(",ve(t)&&(n+=t.field),e+" "+n+"), "}),""),e.alias&&(n+="Alias: "+e.alias),n},t.prototype.query=function(e){var t,r,a=this.interpolateVariablesInQueries(m.a.cloneDeep(e.targets),e.scopedVars),i=[],o=[];try{for(var s=c(a),l=s.next();!l.done;l=s.next()){var u=l.value;if(!u.hide)switch(u.queryType){case j.PPL:o.push(u);break;case j.Lucene:default:i.push(u)}}}catch(e){t={error:e}}finally{try{l&&!l.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}var f=[];if(i.length){var h=this.executeLuceneQueries(i,e);f.push(h)}if(o.length){var g=this.executePPLQueries(o,e);f.push(g)}return 0===f.length?Object(v.of)({data:[],state:n.LoadingState.Done}):v.merge.apply(void 0,p([],d(f)))},t.prototype.executeLuceneQueries=function(e,t){var r,n,a=this,i="";try{for(var o=c(e),s=o.next();!s.done;s=o.next()){var l=s.value;i+=this.createLuceneQuery(l,t)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i=(i=i.replace(/"\$timeFrom"/g,t.range.from.valueOf().toString())).replace(/"\$timeTo"/g,t.range.to.valueOf().toString()),i=Object(ce.getTemplateSrv)().replace(i,t.scopedVars),Object(v.from)(this.post(this.getMultiSearchUrl(),i)).pipe(k((function(t){var r,n,i=new ee(e,t);if(e.some((function(e){return e.isLogsQuery}))){var o=i.getLogs(a.logMessageField,a.logLevelField);try{for(var s=c(o.data),l=s.next();!l.done;l=s.next()){Ee(l.value,a.dataLinks)}}catch(e){r={error:e}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return o}return i.getTimeSeries()})))},t.prototype.executePPLQueries=function(e,t){var r,a,i=this,o=[],s=function(r){var a=l.createPPLQuery(r,t),s=Object(n.dateTime)(t.range.from.valueOf()).format("YYYY-MM-DD HH:mm:ss"),u=Object(n.dateTime)(t.range.to.valueOf()).format("YYYY-MM-DD HH:mm:ss");a=(a=(a=a.replace(/\$timeTo/g,u)).replace(/\$timeFrom/g,s)).replace(/\$timestamp/g,"`"+l.timeField+"`"),o.push(Object(v.from)(l.post(l.getPPLUrl(),a)).pipe(k((function(t){var n,a,o=new ee([r],t,j.PPL);if(e.some((function(e){return e.isLogsQuery}))){var s=o.getLogs(i.logMessageField,i.logLevelField);try{for(var l=(n=void 0,c(s.data)),u=l.next();!u.done;u=l.next()){Ee(u.value,i.dataLinks)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(a=l.return)&&a.call(l)}finally{if(n)throw n.error}}return s}return e.some((function(e){return"table"===e.format}))?o.getTable():o.getTimeSeries()}))))},l=this;try{for(var u=c(e),f=u.next();!f.done;f=u.next()){s(f.value)}}catch(e){r={error:e}}finally{try{f&&!f.done&&(a=u.return)&&a.call(u)}finally{if(r)throw r.error}}return v.merge.apply(void 0,p([],d(o)))},t.prototype.createLuceneQuery=function(e,t){var r,n=Object(ce.getTemplateSrv)().replace(e.query,t.scopedVars,"lucene"),a=Object(ce.getTemplateSrv)().getAdhocFilters(this.name);n&&""!==n||(n="*"),e.isLogsQuery||function(e,t){return e&&e.metrics&&e.metrics.some((function(e){return e.type===t}))}(e,"logs")?(e.bucketAggs=[H()],e.metrics=[],e.isLogsQuery=!0,r=this.queryBuilder.getLogsQuery(e,a,n)):(e.alias&&(e.alias=Object(ce.getTemplateSrv)().replace(e.alias,t.scopedVars,"lucene")),r=this.queryBuilder.build(e,a,n));var i=JSON.stringify(r),o=0===r.size&&Object(le.lt)(this.version,"5.0.0")&&this.flavor===D.Elasticsearch?"count":"query_then_fetch";return this.getQueryHeader(o,t.range.from,t.range.to)+"\n"+i+"\n"},t.prototype.createPPLQuery=function(e,t){var r,n=Object(ce.getTemplateSrv)().replace(e.query,t.scopedVars,"pipe"),a=Object(ce.getTemplateSrv)().getAdhocFilters(this.name);return n||(n="source=`"+this.indexPattern.getPPLIndexPattern()+"`"),r=this.queryBuilder.buildPPLQuery(e,a,n),JSON.stringify(r)},t.prototype.isMetadataField=function(e){return ye.includes(e)},t.prototype.getFields=function(e,t){return l(this,void 0,Promise,(function(){var r=this;return u(this,(function(n){return[2,this.get("/_mapping",t).then((function(t){var n={float:"number",double:"number",integer:"number",long:"number",date:"date",date_nanos:"date",string:"string",text:"string",scaled_float:"number",nested:"nested"},a=function(t,a){return!r.isMetadataField(a)&&(!e||(e===t.type||e===n[t.type]))},i=[],o={};function s(e){for(var t in e){var r=e[t];if(m.a.isObject(r.properties)&&(i.push(t),s(r.properties)),m.a.isObject(r.fields)&&(i.push(t),s(r.fields)),m.a.isString(r.type)){var n=i.concat(t).join(".");a(r,t)&&(o[n]={text:n,type:r.type})}}i.pop()}for(var l in t){var u=t[l];if(u&&u.mappings){var c=u.mappings;if(r.flavor===D.Elasticsearch&&Object(le.lt)(r.version,"7.0.0"))for(var d in c)s(c[d].properties);else s(c.properties)}}return m.a.map(o,(function(e){return e}))}))]}))}))},t.prototype.getTerms=function(e,t){void 0===t&&(t=Object(n.getDefaultTimeRange)());var r=this.flavor===D.Elasticsearch&&Object(le.lt)(this.version,"5.0.0")?"count":"query_then_fetch",a=this.getQueryHeader(r,t.from,t.to),i=JSON.stringify(this.queryBuilder.getTermsQuery(e));i=a+"\n"+(i=(i=i.replace(/\$timeFrom/g,t.from.valueOf().toString())).replace(/\$timeTo/g,t.to.valueOf().toString()))+"\n";var o=this.getMultiSearchUrl();return this.post(o,i).then((function(e){if(!e.responses[0].aggregations)return[];var t=e.responses[0].aggregations[1].buckets;return m.a.map(t,(function(e){return{text:e.key_as_string||e.key,value:e.key}}))}))},t.prototype.getMultiSearchUrl=function(){return this.maxConcurrentShardRequests&&(this.flavor===D.Elasticsearch&&Object(le.gte)(this.version,"7.0.0")||this.flavor===D.OpenSearch)?"_msearch?max_concurrent_shard_requests="+this.maxConcurrentShardRequests:"_msearch"},t.prototype.getPPLUrl=function(){return"_opendistro/_ppl"},t.prototype.metricFindQuery=function(e,t){var r=null==t?void 0:t.range,n=JSON.parse(e);if(e){if("fields"===n.find)return n.type=Object(ce.getTemplateSrv)().replace(n.type,{},"lucene"),this.getFields(n.type,r);if("terms"===n.find)return n.field=Object(ce.getTemplateSrv)().replace(n.field,{},"lucene"),n.query=Object(ce.getTemplateSrv)().replace(n.query||"*",{},"lucene"),this.getTerms(n,r)}return Promise.resolve([])},t.prototype.getTagKeys=function(){return this.getFields()},t.prototype.getTagValues=function(e){return this.getTerms({field:e.key,query:"*"})},t.prototype.targetContainsTemplate=function(e){var t,r,n,a;if(Object(ce.getTemplateSrv)().variableExists(e.query)||Object(ce.getTemplateSrv)().variableExists(e.alias))return!0;try{for(var i=c(e.bucketAggs),o=i.next();!o.done;o=i.next()){var s=o.value;if(Object(ce.getTemplateSrv)().variableExists(s.field)||this.objectContainsTemplate(s.settings))return!0}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}try{for(var l=c(e.metrics),u=l.next();!u.done;u=l.next()){var d=u.value;if(Object(ce.getTemplateSrv)().variableExists(d.field)||this.objectContainsTemplate(d.settings)||this.objectContainsTemplate(d.meta))return!0}}catch(e){n={error:e}}finally{try{u&&!u.done&&(a=l.return)&&a.call(l)}finally{if(n)throw n.error}}return!1},t.prototype.isPrimitive=function(e){return null==e||!!["string","number","boolean"].some((function(e){return e===ge(!0)}))},t.prototype.objectContainsTemplate=function(e){var t,r,n,a;if(!e)return!1;try{for(var i=c(Object.keys(e)),o=i.next();!o.done;o=i.next()){var s=o.value;if(this.isPrimitive(e[s])){if(Object(ce.getTemplateSrv)().variableExists(e[s]))return!0}else if(Array.isArray(e[s]))try{for(var l=(n=void 0,c(e[s])),u=l.next();!u.done;u=l.next()){var d=u.value;if(this.objectContainsTemplate(d))return!0}}catch(e){n={error:e}}finally{try{u&&!u.done&&(a=l.return)&&a.call(l)}finally{if(n)throw n.error}}else if(this.objectContainsTemplate(e[s]))return!0}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return!1},t.prototype.getSupportedQueryTypes=function(){return p([j.Lucene],d(this.pplEnabled?[j.PPL]:[]))},t}(n.DataSourceApi);function Ee(e,t){var r,n,a,i=Object(ce.getDataSourceSrv)();if(t.length){var o=function(e){var r=t.find((function(t){return e.name&&e.name.match(t.field)}));if(!r)return"continue";var n=void 0;if(r.datasourceUid){var o=i.getInstanceSettings(r.datasourceUid);n={title:"",url:"",internal:{query:{query:r.url},datasourceUid:r.datasourceUid,datasourceName:null!==(a=null==o?void 0:o.name)&&void 0!==a?a:"Data source not found"}}}else n={title:"",url:r.url};e.config=e.config||{},e.config.links=p(p([],d(e.config.links||[])),[n])};try{for(var s=c(e.fields),l=s.next();!l.done;l=s.next()){o(l.value)}}catch(e){r={error:e}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}}}var we=r(0),xe=r.n(we),Se=r(1),Oe=function(e){var t,r,n=e.jsonData.flavor||D.OpenSearch,a=Object(le.valid)(e.jsonData.version)||(null===(t=_e.find((function(e){return e.value.flavor===n})))||void 0===t?void 0:t.value.version)||_e[_e.length-1].value.version;return o(o({},e),{jsonData:o(o({},e.jsonData),{timeField:e.jsonData.timeField||"@timestamp",version:a,flavor:n,maxConcurrentShardRequests:e.jsonData.maxConcurrentShardRequests||$e(n,a),logMessageField:e.jsonData.logMessageField||"",logLevelField:e.jsonData.logLevelField||"",pplEnabled:null===(r=e.jsonData.pplEnabled)||void 0===r||r})})},_e=[{label:"OpenSearch 1.0.x",value:{flavor:D.OpenSearch,version:"1.0.0"}},{label:"Elasticsearch 7.0+",value:{flavor:D.Elasticsearch,version:"7.0.0"}},{label:"Elasticsearch 6.0+",value:{flavor:D.Elasticsearch,version:"6.0.0"}},{label:"Elasticsearch 5.6+",value:{flavor:D.Elasticsearch,version:"5.6.0"}},{label:"Elasticsearch 5.0+",value:{flavor:D.Elasticsearch,version:"5.0.0"}},{label:"Elasticsearch 2.0+",value:{flavor:D.Elasticsearch,version:"2.0.0"}}],Ie=[{label:"OpenSearch",value:D.OpenSearch},{label:"ElasticSearch",value:D.Elasticsearch}],Te=Se.LegacyForms.Select,Pe=Se.LegacyForms.Input,Ae=Se.LegacyForms.FormField,Fe=Se.LegacyForms.Switch,ke=[{label:"No pattern",value:"none"},{label:"Hourly",value:"Hourly",example:"[logstash-]YYYY.MM.DD.HH"},{label:"Daily",value:"Daily",example:"[logstash-]YYYY.MM.DD"},{label:"Weekly",value:"Weekly",example:"[logstash-]GGGG.WW"},{label:"Monthly",value:"Monthly",example:"[logstash-]YYYY.MM"},{label:"Yearly",value:"Yearly",example:"[logstash-]YYYY"}],je=function(e){var t,r,n,a=e.value,i=e.onChange;return xe.a.createElement(xe.a.Fragment,null,xe.a.createElement("h3",{className:"page-heading"},"OpenSearch details"),xe.a.createElement("div",{className:"gf-form-group"},xe.a.createElement("div",{className:"gf-form-inline"},xe.a.createElement("div",{className:"gf-form"},xe.a.createElement(Ae,{labelWidth:10,inputWidth:15,label:"Index name",value:a.jsonData.database||"",onChange:De("database",a,i),placeholder:"es-index-name",required:!0})),xe.a.createElement("div",{className:"gf-form"},xe.a.createElement(Ae,{labelWidth:10,label:"Pattern",inputEl:xe.a.createElement(Te,{options:ke,onChange:Le(a,i),value:ke.find((function(e){return e.value===(void 0===a.jsonData.interval?"none":a.jsonData.interval)}))})}))),xe.a.createElement("div",{className:"gf-form max-width-25"},xe.a.createElement(Ae,{labelWidth:10,inputWidth:15,label:"Time field name",value:a.jsonData.timeField||"",onChange:De("timeField",a,i),required:!0})),xe.a.createElement("div",{className:"gf-form"},xe.a.createElement(Ae,{labelWidth:10,inputWidth:15,label:"Version",inputEl:xe.a.createElement(Te,{options:_e,onChange:function(e){i(o(o({},a),{jsonData:o(o({},a.jsonData),{version:e.value.version,flavor:e.value.flavor,maxConcurrentShardRequests:Re(e.value.flavor,e.value.version,a.jsonData.maxConcurrentShardRequests)})}))},value:_e.find((function(e){return e.value.version===a.jsonData.version&&e.value.flavor===a.jsonData.flavor}))||{value:{flavor:a.jsonData.flavor,version:a.jsonData.version},label:((null===(r=Ie.find((function(e){return e.value===a.jsonData.flavor})))||void 0===r?void 0:r.label)||a.jsonData.flavor)+" "+a.jsonData.version}})})),function(e,t){if(e===D.OpenSearch)return!0;return Object(le.gte)(t,"5.6.0")}(a.jsonData.flavor,a.jsonData.version)&&xe.a.createElement("div",{className:"gf-form max-width-30"},xe.a.createElement(Ae,{"aria-label":"Max concurrent Shard Requests input",labelWidth:15,label:"Max concurrent Shard Requests",value:a.jsonData.maxConcurrentShardRequests||"",onChange:De("maxConcurrentShardRequests",a,i)})),xe.a.createElement("div",{className:"gf-form-inline"},xe.a.createElement("div",{className:"gf-form"},xe.a.createElement(Ae,{labelWidth:10,label:"Min time interval",inputEl:xe.a.createElement(Pe,{className:"width-6",value:a.jsonData.timeInterval||"",onChange:De("timeInterval",a,i),placeholder:"10s",validationEvents:(t={},t[Se.EventsWithValidation.onBlur]=[Object(Se.regexValidation)(/^\d+(ms|[Mwdhmsy])$/,"Value is not valid, you can use number with time unit specifier: y, M, w, d, h, m, s")],t)}),tooltip:xe.a.createElement(xe.a.Fragment,null,"A lower limit for the auto group by time interval. Recommended to be set to write frequency, for example ",xe.a.createElement("code",null,"1m")," if your data is written every minute.")}))),xe.a.createElement("div",{className:"gf-form"},xe.a.createElement(Fe,{label:"PPL enabled",labelClass:"width-10",tooltip:"Allow Piped Processing Language as an alternative query syntax in the OpenSearch query editor.",checked:null===(n=a.jsonData.pplEnabled)||void 0===n||n,onChange:Ne("pplEnabled",a,i)}))))},De=function(e,t,r){return function(n){var a;r(o(o({},t),{jsonData:o(o({},t.jsonData),(a={},a[e]=n.currentTarget.value,a))}))}},Ne=function(e,t,r){return function(n){var a;r(o(o({},t),{jsonData:o(o({},t.jsonData),(a={},a[e]=n.currentTarget.checked,a))}))}},Le=function(e,t){return function(r){var n,a=e.database,i="none"===r.value?void 0:r.value;if(!a||0===a.length||a.startsWith("[logstash-]")){var s="";if(void 0!==i){var l=ke.find((function(e){return e.value===i}));l&&(s=null!==(n=l.example)&&void 0!==n?n:"")}t(o(o({},e),{database:s,jsonData:o(o({},e.jsonData),{interval:i})}))}else t(o(o({},e),{jsonData:o(o({},e.jsonData),{interval:i})}))}};function Re(e,t,r){return 5===r&&Object(le.lt)(t,"7.0.0")&&e===D.Elasticsearch?256:256===r&&(Object(le.gte)(t,"7.0.0")&&e===D.Elasticsearch||e===D.OpenSearch)?5:r||$e(e,t)}function $e(e,t){return Object(le.lt)(t,"7.0.0")&&e===D.Elasticsearch?256:5}var Ce=Se.LegacyForms.FormField,Me=function(e){var t=e.value,r=e.onChange,n=function(e){return function(n){var a;r(o(o({},t),((a={})[e]=n.currentTarget.value,a)))}};return xe.a.createElement(xe.a.Fragment,null,xe.a.createElement("h3",{className:"page-heading"},"Logs"),xe.a.createElement("div",{className:"gf-form-group"},xe.a.createElement("div",{className:"gf-form max-width-30"},xe.a.createElement(Ce,{labelWidth:11,label:"Message field name",value:t.logMessageField,onChange:n("logMessageField"),placeholder:"_source"})),xe.a.createElement("div",{className:"gf-form max-width-30"},xe.a.createElement(Ce,{labelWidth:11,label:"Level field name",value:t.logLevelField,onChange:n("logLevelField")}))))},Ve=r(2),qe=function(e){var t=Object(we.useRef)();return Object(we.useEffect)((function(){t.current=e})),t.current},Be=r(28),Qe=function(e){var t=e.status,r=s(e,["status"]),a=function(e){e||(e=n.PluginSignatureStatus.invalid);switch(e){case n.PluginSignatureStatus.internal:return{text:"Core",icon:"cube",color:"blue",tooltip:"Core plugin that is bundled with Grafana"};case n.PluginSignatureStatus.valid:return{text:"Signed",icon:"lock",color:"green",tooltip:"Signed and verified plugin"};case n.PluginSignatureStatus.invalid:return{text:"Invalid signature",icon:"exclamation-triangle",color:"red",tooltip:"Invalid plugin signature"};case n.PluginSignatureStatus.modified:return{text:"Modified signature",icon:"exclamation-triangle",color:"red",tooltip:"Valid signature but content has been modified"};case n.PluginSignatureStatus.missing:return{text:"Missing signature",icon:"exclamation-triangle",color:"red",tooltip:"Missing plugin signature"}}return{text:"Unsigned",icon:"exclamation-triangle",color:"red",tooltip:"Unsigned external plugin"}}(t);return xe.a.createElement(Se.Badge,o({text:a.text,color:a.color,icon:a.icon,tooltip:a.tooltip},r))};Qe.displayName="PluginSignatureBadge";var Ge,Ue,ze,He,We,Ye=function(e){function t(t){var r=e.call(this,t)||this;return r.dataSourceSrv=Object(ce.getDataSourceSrv)(),r.state={},r.onChange=function(e){var t=r.dataSourceSrv.getInstanceSettings(e.value);t&&(r.props.onChange(t),r.setState({error:void 0}))},r}return i(t,e),t.prototype.componentDidMount=function(){var e=this.props.current;this.dataSourceSrv.getInstanceSettings(e)||this.setState({error:"Could not find data source "+e})},t.prototype.getCurrentValue=function(){var e=this.props,t=e.current,r=e.hideTextValue,n=e.noDefault;if(!t&&n)return null;var a=this.dataSourceSrv.getInstanceSettings(t);return a?{label:a.name.substr(0,37),value:a.name,imgUrl:a.meta.info.logos.small,hideText:r,meta:a.meta}:{label:(null!=t?t:"no name")+" - not found",value:t,imgUrl:"",hideText:r}},t.prototype.getDataSourceOptions=function(){var e=this.props,t=e.tracing,r=e.metrics,n=e.mixed,a=e.dashboard,i=e.variables,o=e.annotations,s=e.pluginId;return this.dataSourceSrv.getList({tracing:t,metrics:r,dashboard:a,mixed:n,variables:i,annotations:o,pluginId:s}).map((function(e){return{value:e.name,label:e.name+(e.isDefault?" (default)":""),imgUrl:e.meta.info.logos.small,meta:e.meta}}))},t.prototype.render=function(){var e=this.props,t=e.autoFocus,r=e.onBlur,a=e.openMenuOnFocus,i=e.placeholder,o=this.state.error,s=this.getDataSourceOptions(),l=this.getCurrentValue();return xe.a.createElement("div",{"aria-label":Be.selectors.components.DataSourcePicker.container},xe.a.createElement(Se.Select,{className:"ds-picker select-container",isMulti:!1,isClearable:!1,backspaceRemovesValue:!1,onChange:this.onChange,options:s,autoFocus:t,onBlur:r,openMenuOnFocus:a,maxMenuHeight:500,menuPlacement:"bottom",placeholder:i,noOptionsMessage:"No datasources found",value:l,invalid:!!o,getOptionLabel:function(e){return e.meta&&((t=e.meta.signature)&&t!==n.PluginSignatureStatus.valid&&t!==n.PluginSignatureStatus.internal)&&e!==l?xe.a.createElement(Se.HorizontalGroup,{align:"center",justify:"space-between"},xe.a.createElement("span",null,e.label)," ",xe.a.createElement(Qe,{status:e.meta.signature})):e.label||"";var t}}))},t.defaultProps={autoFocus:!1,openMenuOnFocus:!1,placeholder:"Select datasource"},t}(we.PureComponent),Xe=Se.LegacyForms.FormField,Je=Se.LegacyForms.Switch,Ke=Object(Se.stylesFactory)((function(){return{firstRow:Object(Ve.css)(Ge||(Ge=f(["\n    display: flex;\n  "],["\n    display: flex;\n  "]))),nameField:Object(Ve.css)(Ue||(Ue=f(["\n    flex: 2;\n  "],["\n    flex: 2;\n  "]))),regexField:Object(Ve.css)(ze||(ze=f(["\n    flex: 3;\n  "],["\n    flex: 3;\n  "]))),row:Object(Ve.css)(He||(He=f(["\n    display: flex;\n    align-items: baseline;\n  "],["\n    display: flex;\n    align-items: baseline;\n  "])))}})),Ze=function(e){var t,r=e.value,n=e.onChange,a=e.onDelete,i=e.suggestions,s=e.className,l=Ke(),u=d(function(e){var t=d(Object(we.useState)(!!e),2),r=t[0],n=t[1],a=qe(e);return Object(we.useEffect)((function(){a||!e||r||n(!0),a&&!e&&r&&n(!1)}),[a,e,r]),[r,n]}(r.datasourceUid),2),c=u[0],p=u[1];return xe.a.createElement("div",{className:s},xe.a.createElement("div",{className:l.firstRow+" gf-form"},xe.a.createElement(Xe,{className:l.nameField,labelWidth:6,inputWidth:null,label:"Field",type:"text",value:r.field,tooltip:"Can be exact field name or a regex pattern that will match on the field name.",onChange:(t="field",function(e){var a;n(o(o({},r),((a={})[t]=e.currentTarget.value,a)))})}),xe.a.createElement(Se.Button,{variant:"destructive",title:"Remove field",icon:"times",onClick:function(e){e.preventDefault(),a()}})),xe.a.createElement("div",{className:"gf-form"},xe.a.createElement(Xe,{label:c?"Query":"URL",labelWidth:6,inputEl:xe.a.createElement(Se.DataLinkInput,{placeholder:c?"${__value.raw}":"http://example.com/${__value.raw}",value:r.url||"",onChange:function(e){return n(o(o({},r),{url:e}))},suggestions:i}),className:Object(Ve.css)(We||(We=f(["\n            width: 100%;\n          "],["\n            width: 100%;\n          "])))})),xe.a.createElement("div",{className:l.row},xe.a.createElement(Je,{labelClass:"width-6",label:"Internal link",checked:c,onChange:function(){c&&n(o(o({},r),{datasourceUid:void 0})),p(!c)}}),c&&xe.a.createElement(Ye,{tracing:!0,onChange:function(e){n(o(o({},r),{datasourceUid:e.uid}))},current:r.datasourceUid})))};var et,tt,rt,nt,at,it,ot,st,lt,ut=Object(Se.stylesFactory)((function(e){return{infoText:Object(Ve.css)(et||(et=f(["\n    padding-bottom: ",";\n    color: ",";\n  "],["\n    padding-bottom: ",";\n    color: ",";\n  "])),e.spacing.md,e.colors.textWeak),dataLink:Object(Ve.css)(tt||(tt=f(["\n    margin-bottom: ",";\n  "],["\n    margin-bottom: ",";\n  "])),e.spacing.sm)}})),ct=function(e){var t=e.value,r=e.onChange,a=Object(Se.useTheme)(),i=ut(a);return xe.a.createElement(xe.a.Fragment,null,xe.a.createElement("h3",{className:"page-heading"},"Data links"),xe.a.createElement("div",{className:i.infoText},"Add links to existing fields. Links will be shown in log row details next to the field value."),t&&t.length>0&&xe.a.createElement("div",{className:"gf-form-group"},t.map((function(e,a){return xe.a.createElement(Ze,{className:i.dataLink,key:a,value:e,onChange:function(e){var n=p([],d(t));n.splice(a,1,e),r(n)},onDelete:function(){var e=p([],d(t));e.splice(a,1),r(e)},suggestions:[{value:n.DataLinkBuiltInVars.valueRaw,label:"Raw value",documentation:"Raw value of the field",origin:n.VariableOrigin.Value}]})}))),xe.a.createElement(Se.Button,{variant:"secondary",className:Object(Ve.css)(rt||(rt=f(["\n          margin-right: 10px;\n        "],["\n          margin-right: 10px;\n        "]))),icon:"plus",onClick:function(e){e.preventDefault();var n=p(p([],d(t||[])),[{field:"",url:""}]);r(n)}},"Add"))},dt=function(e,t,r){return Object(we.useCallback)((function(n){e(r(t,n))}),[e,t,r])},pt=Object(we.createContext)(void 0),ft=function(){var e=Object(we.useContext)(pt);if(!e)throw new Error("Use DispatchContext first.");return e},ht="init",mt=function(e){return{type:"change_query",payload:{query:e}}},vt=function(e,t){switch(t.type){case"change_query":return t.payload.query;case ht:return e||"";default:return e}},gt=function(e,t){switch(t.type){case"change_alias_pattern":return t.payload.aliasPattern;case ht:return e||"";default:return e}},yt=function(e,t){switch(t.type){case"@metrics/add":return p(p([],d(e)),[z(t.payload.id)]);case"@metrics/remove":var r=e.find((function(e){return e.id===t.payload.id})),n=p([r],d(function e(t,r){var n=r.filter((function(e){var r;return V(e)?null===(r=e.pipelineVariables)||void 0===r?void 0:r.some((function(e){return e.pipelineAgg===t.id})):C(e)&&t.id===e.field}));return p(p([],d(n)),d(n.flatMap((function(t){return e(t,r)}))))}(r,e))),a=e.filter((function(e){return!n.some((function(t){return t.id===e.id}))}));return 0===a.length?[z("1")]:a;case"@metrics/change_type":return e.filter((function(e){return!B[t.payload.type].isSingleMetric||e.id===t.payload.id})).map((function(e){return e.id!==t.payload.id?e:o({id:e.id,type:t.payload.type},B[t.payload.type].defaults)}));case"@metrics/change_field":return e.map((function(e){return e.id!==t.payload.id?e:o(o({},e),{field:t.payload.field})}));case"@metrics/toggle_visibility":return e.map((function(e){return e.id!==t.payload.id?e:o(o({},e),{hide:!e.hide})}));case"@metrics/change_setting":return e.map((function(e){var r;if(e.id!==t.payload.metric.id)return e;if(q(e)){var n=Z(o(o({},e.settings),((r={})[t.payload.settingName]=t.payload.newValue,r)));return o(o({},e),{settings:o({},n)})}return e}));case"@metrics/change_meta":return e.map((function(e){var r;return e.id!==t.payload.metric.id?e:function(e){return B[e.type].hasMeta}(e)?o(o({},e),{meta:o(o({},e.meta),(r={},r[t.payload.meta]=t.payload.newValue,r))}):e}));case"@metrics/change_attr":return e.map((function(e){var r;return e.id!==t.payload.metric.id?e:o(o({},e),((r={})[t.payload.attribute]=t.payload.newValue,r))}));case ht:return(null==e?void 0:e.length)?e:[z("1")];default:return e}},bt=function(e,t){switch(t.type){case"change_query_type":return t.payload.queryType;case ht:return j.Lucene;default:return e}},Et=function(e,t){switch(t.type){case"change_format":return t.payload.format;case ht:return"table";default:return e}},wt=Object(we.createContext)(void 0),xt=Object(we.createContext)(void 0),St=function(e){var t,r,n=e.children,a=e.onChange,i=e.query,s=e.datasource,l=(t={query:vt,queryType:bt,alias:gt,metrics:yt,bucketAggs:(r=s.timeField,function(e,t){switch(t.type){case"@bucketAggs/add":var n={id:t.payload.id,type:"terms",settings:de.terms.defaultSettings},a=e[e.length-1];return"date_histogram"===(null==a?void 0:a.type)?p(p([],d(e.slice(0,e.length-1))),[n,a]):p(p([],d(e)),[n]);case"@bucketAggs/remove":return e.filter((function(e){return e.id!==t.payload.id}));case"@bucketAggs/change_type":return e.map((function(e){return e.id!==t.payload.id?e:{id:e.id,type:t.payload.newType,settings:de[t.payload.newType].defaultSettings}}));case"@bucketAggs/change_field":return e.map((function(e){return e.id!==t.payload.id?e:o(o({},e),{field:t.payload.newField})}));case"@metrics/change_type":return B[t.payload.type].isSingleMetric?[]:0===e.length?[H()]:e;case"@bucketAggs/change_setting":return e.map((function(e){var r;if(e.id!==t.payload.bucketAgg.id)return e;var n=Z(o(o({},e.settings),((r={})[t.payload.settingName]=t.payload.newValue,r)));return o(o({},e),{settings:o({},n)})}));case ht:return(null==e?void 0:e.length)?e:[o(o({},H("2")),{field:r})];default:return e}}),format:Et},function(e,r){var n={};for(var a in t)n[a]=t[a](e[a],r);return n}),u=dt((function(e){return a(o(o(o({},i),e),{timeField:s.timeField}))}),i,l);return i.metrics&&i.bucketAggs&&void 0!==i.query?xe.a.createElement(wt.Provider,{value:s},xe.a.createElement(xt.Provider,{value:i},xe.a.createElement(pt.Provider,{value:u},n))):(u({type:ht}),null)},Ot=function(){var e=Object(we.useContext)(xt);if(!e)throw new Error("use OpenSearchProvider first.");return e},_t=function(){var e=Object(we.useContext)(wt);if(!e)throw new Error("use OpenSearchProvider first.");return e},It=((nt={})[j.Lucene]={label:"Lucene"},nt[j.PPL]={label:"PPL"},nt),Tt=Object(Ve.css)(at||(at=f(["\n  min-width: 150px;\n"],["\n  min-width: 150px;\n"]))),Pt=function(e){var t,r,n=e.value,a=_t(),i=ft();return xe.a.createElement(Se.Segment,{className:Tt,options:(r=a.getSupportedQueryTypes(),Object.entries(It).filter((function(e){var t=d(e,2),n=t[0];return t[1],r.includes(n)})).map((function(e){var t=d(e,2),r=t[0];return{label:t[1].label,value:r}}))),onChange:function(e){return i({type:"change_query_type",payload:{queryType:e.value}})},value:(t=n,{label:It[t].label,value:t})})},At=Object(Se.stylesFactory)((function(e,t){return{color:t&&Object(Ve.css)(it||(it=f(["\n      &,\n      &:hover,\n      label,\n      a {\n        color: ",";\n      }\n    "],["\n      &,\n      &:hover,\n      label,\n      a {\n        color: ",";\n      }\n    "])),t?e.colors.textFaint:e.colors.text)}})),Ft=function(e,t){return{type:"@metrics/change_field",payload:{id:e,field:t}}},kt=function(e,t,r){return{type:"@metrics/change_setting",payload:{metric:e,settingName:t,newValue:r}}},jt=Object(Ve.css)(ot||(ot=f(["\n  clip: rect(0 0 0 0);\n  clip-path: inset(50%);\n  height: 1px;\n  overflow: hidden;\n  position: absolute;\n  white-space: nowrap;\n  width: 1px;\n"],["\n  clip: rect(0 0 0 0);\n  clip-path: inset(50%);\n  height: 1px;\n  overflow: hidden;\n  position: absolute;\n  white-space: nowrap;\n  width: 1px;\n"]))),Dt=function(e){var t=e.iconName,r=e.onClick,n=e.className,a=e.label,i=s(e,["iconName","onClick","className","label"]);return xe.a.createElement("button",o({className:Object(Ve.cx)("gf-form-label gf-form-label--btn query-part",n),onClick:r},i),xe.a.createElement("span",{className:jt},a),xe.a.createElement(Se.Icon,{name:t,"aria-hidden":"true"}))},Nt=function(e){var t=e.index,r=e.onAdd,n=e.onRemove,a=e.elements;return xe.a.createElement("div",{className:Object(Ve.css)(st||(st=f(["\n        display: flex;\n      "],["\n        display: flex;\n      "])))},0===t&&xe.a.createElement(Dt,{iconName:"plus",onClick:r,label:"add"}),a.length>=2&&xe.a.createElement(Dt,{iconName:"minus",onClick:n,label:"remove"}))},Lt=Object(Ve.css)(lt||(lt=f(["\n  white-space: nowrap;\n"],["\n  white-space: nowrap;\n"]))),Rt=function(e){return{label:K(e),value:e}},$t=function(e){var t,r=e.options,n=e.onChange,a=e.className,i=e.value;return xe.a.createElement(Se.Segment,{className:Object(Ve.cx)(a,Lt),options:(t=r,t.map(Rt)),onChange:n,placeholder:"Select Metric",value:i?Rt(r.find((function(e){return e.id===i}))):null})},Ct=function(e,t){switch(void 0===e&&(e=[]),t.type){case"@pipelineVariables/add":return p(p([],d(e)),[{name:"var1",pipelineAgg:""}]);case"@pipelineVariables/remove":return e.slice(0,t.payload.index).concat(e.slice(t.payload.index+1));case"@pipelineVariables/rename":return e.map((function(e,r){return r!==t.payload.index?e:o(o({},e),{name:t.payload.newName})}));case"@pipelineVariables/change_metric":return e.map((function(e,r){return r!==t.payload.index?e:o(o({},e),{pipelineAgg:t.payload.newMetric})}));default:return e}};function Mt(e){var t=e.label,r=e.settingName,n=e.metric,a=e.placeholder,i=e.tooltip,o=ft(),s=d(Object(we.useState)(Object(h.uniqueId)("es-field-id-")),1)[0],l=n.settings;return xe.a.createElement(Se.InlineField,{label:t,labelWidth:16,tooltip:i},xe.a.createElement(Se.Input,{id:s,placeholder:a,onBlur:function(e){return o(kt(n,r,e.target.value))},defaultValue:null==l?void 0:l[r]}))}var Vt,qt,Bt,Qt,Gt,Ut,zt,Ht,Wt,Yt,Xt,Jt,Kt,Zt,er,tr=function(e){var t=e.value,r=e.previousMetrics,n=ft(),a=dt((function(e){return n({type:"@metrics/change_attr",payload:{metric:t,attribute:"pipelineVariables",newValue:e}})}),t.pipelineVariables,Ct);return Object(we.useEffect)((function(){var e;(null===(e=t.pipelineVariables)||void 0===e?void 0:e.length)||a({type:"@pipelineVariables/add"})}),[]),xe.a.createElement(xe.a.Fragment,null,xe.a.createElement("div",{className:Object(Ve.css)(Vt||(Vt=f(["\n          display: flex;\n        "],["\n          display: flex;\n        "])))},xe.a.createElement(Se.InlineLabel,{width:16},"Variables"),xe.a.createElement("div",{className:Object(Ve.css)(qt||(qt=f(["\n            display: grid;\n            grid-template-columns: 1fr auto;\n            row-gap: 4px;\n            margin-bottom: 4px;\n          "],["\n            display: grid;\n            grid-template-columns: 1fr auto;\n            row-gap: 4px;\n            margin-bottom: 4px;\n          "])))},t.pipelineVariables.map((function(e,n){return xe.a.createElement(we.Fragment,{key:e.name},xe.a.createElement("div",{className:Object(Ve.css)(Bt||(Bt=f(["\n                  display: grid;\n                  column-gap: 4px;\n                  grid-template-columns: auto auto;\n                "],["\n                  display: grid;\n                  column-gap: 4px;\n                  grid-template-columns: auto auto;\n                "])))},xe.a.createElement(Se.Input,{defaultValue:e.name,placeholder:"Variable Name",onBlur:function(e){return a(function(e,t){return{type:"@pipelineVariables/rename",payload:{index:t,newName:e}}}(e.target.value,n))}}),xe.a.createElement($t,{onChange:function(e){return a(function(e,t){return{type:"@pipelineVariables/change_metric",payload:{index:t,newMetric:e}}}(e.value.id,n))},options:r,value:e.pipelineAgg})),xe.a.createElement(Nt,{index:n,elements:t.pipelineVariables||[],onAdd:function(){return a({type:"@pipelineVariables/add"})},onRemove:function(){return a(function(e){return{type:"@pipelineVariables/remove",payload:{index:e}}}(n))}}))})))),xe.a.createElement(Mt,{label:"Script",metric:t,settingName:"script",tooltip:"Scripting language is Painless. Use params.<var> to reference a variable.",placeholder:"params.var1 / params.var2"}))},rr=Object(Se.stylesFactory)((function(e,t){return{wrapper:Object(Ve.css)(Qt||(Qt=f(["\n      display: flex;\n      flex-direction: column;\n    "],["\n      display: flex;\n      flex-direction: column;\n    "]))),settingsWrapper:Object(Ve.css)(Gt||(Gt=f(["\n      padding-top: ",";\n    "],["\n      padding-top: ",";\n    "])),e.spacing.xs),icon:Object(Ve.css)(Ut||(Ut=f(["\n      margin-right: ",";\n    "],["\n      margin-right: ",";\n    "])),e.spacing.xs),button:Object(Ve.css)(Ht||(Ht=f(["\n      justify-content: start;\n      ","\n    "],["\n      justify-content: start;\n      ","\n    "])),t&&Object(Ve.css)(zt||(zt=f(["\n          color: ",";\n        "],["\n          color: ",";\n        "])),e.colors.textFaint))}})),nr=function(e){var t=e.label,r=e.children,n=e.hidden,a=void 0!==n&&n,i=d(Object(we.useState)(!1),2),o=i[0],s=i[1],l=rr(Object(Se.useTheme)(),a);return xe.a.createElement("div",{className:Object(Ve.cx)(l.wrapper)},xe.a.createElement("button",{className:Object(Ve.cx)("gf-form-label query-part",l.button,Tt),onClick:function(){return s(!o)},"aria-expanded":o},xe.a.createElement(Se.Icon,{name:o?"angle-down":"angle-right","aria-hidden":"true",className:l.icon}),t),o&&xe.a.createElement("div",{className:l.settingsWrapper},r))},ar=function(e){var t,r,n,a,i,s,l,u,c,d,p,f,h,m,v,g,y,b,E,w,x,S=e.metric,O=ft();return xe.a.createElement(xe.a.Fragment,null,xe.a.createElement(Se.InlineField,{label:"Model"},xe.a.createElement(Se.Select,{onChange:function(e){return O(kt(S,"model",e.value))},options:U,value:null===(t=S.settings)||void 0===t?void 0:t.model})),xe.a.createElement(Se.InlineField,{label:"Window"},xe.a.createElement(Se.Input,{onBlur:function(e){return O(kt(S,"window",parseInt(e.target.value,10)))},defaultValue:null===(r=S.settings)||void 0===r?void 0:r.window})),xe.a.createElement(Se.InlineField,{label:"Predict"},xe.a.createElement(Se.Input,{onBlur:function(e){return O(kt(S,"predict",parseInt(e.target.value,10)))},defaultValue:null===(n=S.settings)||void 0===n?void 0:n.predict})),function(e){var t;return"ewma"===(null===(t=e.settings)||void 0===t?void 0:t.model)}(S)&&xe.a.createElement(xe.a.Fragment,null,xe.a.createElement(Se.InlineField,{label:"Alpha"},xe.a.createElement(Se.Input,{onBlur:function(e){return O(kt(S,"alpha",parseInt(e.target.value,10)))},defaultValue:null===(a=S.settings)||void 0===a?void 0:a.alpha})),xe.a.createElement(Se.InlineField,{label:"Minimize"},xe.a.createElement(Se.Switch,{onChange:function(e){return O(kt(S,"minimize",e.target.checked))},checked:!!(null===(i=S.settings)||void 0===i?void 0:i.minimize)}))),function(e){var t;return"holt"===(null===(t=e.settings)||void 0===t?void 0:t.model)}(S)&&xe.a.createElement(xe.a.Fragment,null,xe.a.createElement(Se.InlineField,{label:"Alpha"},xe.a.createElement(Se.Input,{onBlur:function(e){var t;return O(kt(S,"settings",o(o({},null===(t=S.settings)||void 0===t?void 0:t.settings),{alpha:parseInt(e.target.value,10)})))},defaultValue:null===(l=null===(s=S.settings)||void 0===s?void 0:s.settings)||void 0===l?void 0:l.alpha})),xe.a.createElement(Se.InlineField,{label:"Beta"},xe.a.createElement(Se.Input,{onBlur:function(e){var t;return O(kt(S,"settings",o(o({},null===(t=S.settings)||void 0===t?void 0:t.settings),{beta:parseInt(e.target.value,10)})))},defaultValue:null===(c=null===(u=S.settings)||void 0===u?void 0:u.settings)||void 0===c?void 0:c.beta})),xe.a.createElement(Se.InlineField,{label:"Minimize"},xe.a.createElement(Se.Switch,{onChange:function(e){return O(kt(S,"minimize",e.target.checked))},checked:!!(null===(d=S.settings)||void 0===d?void 0:d.minimize)}))),function(e){var t;return"holt_winters"===(null===(t=e.settings)||void 0===t?void 0:t.model)}(S)&&xe.a.createElement(xe.a.Fragment,null,xe.a.createElement(Se.InlineField,{label:"Alpha"},xe.a.createElement(Se.Input,{onBlur:function(e){var t;return O(kt(S,"settings",o(o({},null===(t=S.settings)||void 0===t?void 0:t.settings),{alpha:parseInt(e.target.value,10)})))},defaultValue:null===(f=null===(p=S.settings)||void 0===p?void 0:p.settings)||void 0===f?void 0:f.alpha})),xe.a.createElement(Se.InlineField,{label:"Beta"},xe.a.createElement(Se.Input,{onBlur:function(e){var t;return O(kt(S,"settings",o(o({},null===(t=S.settings)||void 0===t?void 0:t.settings),{beta:parseInt(e.target.value,10)})))},defaultValue:null===(m=null===(h=S.settings)||void 0===h?void 0:h.settings)||void 0===m?void 0:m.beta})),xe.a.createElement(Se.InlineField,{label:"Gamma"},xe.a.createElement(Se.Input,{onBlur:function(e){var t;return O(kt(S,"settings",o(o({},null===(t=S.settings)||void 0===t?void 0:t.settings),{gamma:parseInt(e.target.value,10)})))},defaultValue:null===(g=null===(v=S.settings)||void 0===v?void 0:v.settings)||void 0===g?void 0:g.gamma})),xe.a.createElement(Se.InlineField,{label:"Period"},xe.a.createElement(Se.Input,{onBlur:function(e){var t;return O(kt(S,"settings",o(o({},null===(t=S.settings)||void 0===t?void 0:t.settings),{period:parseInt(e.target.value,10)})))},defaultValue:null===(b=null===(y=S.settings)||void 0===y?void 0:y.settings)||void 0===b?void 0:b.period})),xe.a.createElement(Se.InlineField,{label:"Pad"},xe.a.createElement(Se.Switch,{onChange:function(e){var t;return O(kt(S,"settings",o(o({},null===(t=S.settings)||void 0===t?void 0:t.settings),{pad:e.target.checked})))},checked:!!(null===(w=null===(E=S.settings)||void 0===E?void 0:E.settings)||void 0===w?void 0:w.pad)})),xe.a.createElement(Se.InlineField,{label:"Minimize"},xe.a.createElement(Se.Switch,{onChange:function(e){return O(kt(S,"minimize",e.target.checked))},checked:!!(null===(x=S.settings)||void 0===x?void 0:x.minimize)}))))},ir={labelWidth:16},or=function(e){var t,r,n,a,i,s=e.metric,l=e.previousMetrics,u=ft(),c=function(e){var t,r,n,a,i,o;switch(e.type){case"cardinality":return"Precision threshold: "+((null===(t=e.settings)||void 0===t?void 0:t.precision_threshold)||"");case"percentiles":return(null===(r=e.settings)||void 0===r?void 0:r.percents)&&(null===(a=null===(n=e.settings)||void 0===n?void 0:n.percents)||void 0===a?void 0:a.length)>=1?"Values: "+(null===(i=e.settings)||void 0===i?void 0:i.percents):"Percents: Default";case"extended_stats":var s=Object.entries(e.meta||{}).map((function(e){var t,r=d(e,2),n=r[0];return r[1]&&(null===(t=G.find(function(e){return function(t){return t.value===e}}(n)))||void 0===t?void 0:t.label)})).filter(Boolean);return"Stats: "+(s.length>0?s.join(", "):"None selected");case"raw_document":case"raw_data":return"Size: "+((null===(o=e.settings)||void 0===o?void 0:o.size)||500);default:return"Options"}}(s),p=Ot();return xe.a.createElement(nr,{label:c,hidden:s.hide},"derivative"===s.type&&xe.a.createElement(Mt,{label:"Unit",metric:s,settingName:"unit"}),"cumulative_sum"===s.type&&xe.a.createElement(Mt,{label:"Format",metric:s,settingName:"format"}),"moving_avg"===s.type&&xe.a.createElement(ar,{metric:s}),"moving_fn"===s.type&&xe.a.createElement(xe.a.Fragment,null,xe.a.createElement(Mt,{label:"Window",metric:s,settingName:"window"}),xe.a.createElement(Mt,{label:"Script",metric:s,settingName:"script"}),xe.a.createElement(Mt,{label:"Shift",metric:s,settingName:"shift"})),"bucket_script"===s.type&&xe.a.createElement(tr,{value:s,previousMetrics:l}),("raw_data"===s.type||"raw_document"===s.type)&&xe.a.createElement(Se.InlineField,o({label:"Size"},ir),xe.a.createElement(Se.Input,{id:"ES-query-"+p.refId+"_metric-"+s.id+"-size",onBlur:function(e){return u(kt(s,"size",e.target.value))},defaultValue:null!==(r=null===(t=s.settings)||void 0===t?void 0:t.size)&&void 0!==r?r:null===(n=B.raw_data.defaults.settings)||void 0===n?void 0:n.size})),"cardinality"===s.type&&xe.a.createElement(Mt,{label:"Precision Threshold",metric:s,settingName:"precision_threshold"}),"extended_stats"===s.type&&xe.a.createElement(xe.a.Fragment,null,G.map((function(e){var t,r,n;return xe.a.createElement(sr,{key:e.value,stat:e,onChange:function(t){return u(function(e,t,r){return{type:"@metrics/change_meta",payload:{metric:e,meta:t,newValue:r}}}(s,e.value,t))},value:void 0!==(null===(t=s.meta)||void 0===t?void 0:t[e.value])?!!(null===(r=s.meta)||void 0===r?void 0:r[e.value]):!!(null===(n=B.extended_stats.defaults.meta)||void 0===n?void 0:n[e.value])})})),xe.a.createElement(Mt,{label:"Sigma",metric:s,settingName:"sigma",placeholder:"3"})),"percentiles"===s.type&&xe.a.createElement(Se.InlineField,o({label:"Percentiles"},ir),xe.a.createElement(Se.Input,{onBlur:function(e){return u(kt(s,"percents",e.target.value.split(",").filter(Boolean)))},defaultValue:(null===(a=s.settings)||void 0===a?void 0:a.percents)||(null===(i=B.percentiles.defaults.settings)||void 0===i?void 0:i.percents),placeholder:"1,5,25,50,75,95,99"})),function(e){return B[e.type].supportsInlineScript}(s)&&xe.a.createElement(Mt,{label:"Script",metric:s,settingName:"script",placeholder:"_value * 1"}),function(e){return B[e.type].supportsMissing}(s)&&xe.a.createElement(Mt,{label:"Missing",metric:s,settingName:"missing",tooltip:"The missing parameter defines how documents that are missing a value should be treated. By default\n            they will be ignored but it is also possible to treat them as if they had a value"}))},sr=function(e){var t=e.stat,r=e.onChange,n=e.value,a=d(Object(we.useState)(Object(h.uniqueId)("es-field-id-")),1)[0];return xe.a.createElement(Se.InlineField,o({label:t.label},ir,{key:t.value}),xe.a.createElement(Se.Switch,{id:a,onChange:function(e){return r(e.target.checked)},value:n}))},lr=function(e){var t=e.value,r=e.text;return{label:r,value:""+(t||r)}},ur=function(e){return!B[e.type].isPipelineAgg},cr=function(e,t,r){var n=e.some(ur);return Object.entries(B).filter((function(e){var n=d(e,2),a=(n[0],n[1].versionRange);return Object(le.satisfies)(r,(null==a?void 0:a[t])||"*")})).filter((function(e){var t=d(e,2),r=(t[0],t[1]);return n||!r.isPipelineAgg})).map((function(e){var t=d(e,2),r=t[0];return{label:t[1].label,value:r}}))},dr=function(e){var t,r=e.value,n=At(Object(Se.useTheme)(),!!r.hide),a=_t(),i=Ot(),o=ft(),s=i.metrics.slice(0,i.metrics.findIndex((function(e){return e.id===r.id})));return xe.a.createElement(xe.a.Fragment,null,xe.a.createElement(Se.Segment,{className:Object(Ve.cx)(n.color,Tt),options:cr(s,a.flavor,a.version),onChange:function(e){return o((t=r.id,n=e.value,{type:"@metrics/change_type",payload:{id:t,type:n}}));var t,n},value:(t=r,{label:B[t.type].label,value:t.type})}),C(r)&&!M(r)&&xe.a.createElement(Se.SegmentAsync,{className:Object(Ve.cx)(n.color,Tt),loadOptions:function(){return l(void 0,void 0,void 0,(function(){return u(this,(function(e){switch(e.label){case 0:return[4,function(){return"cardinality"===r.type?a.getFields():a.getFields("number")}()];case 1:return[2,e.sent().map(lr)]}}))}))},onChange:function(e){return o(Ft(r.id,e.value))},placeholder:"Select Field",value:r.field}),M(r)&&!V(r)&&xe.a.createElement($t,{className:Object(Ve.cx)(n.color,Tt),onChange:function(e){var t;return o(Ft(r.id,null===(t=e.value)||void 0===t?void 0:t.id))},options:s,value:r.field}),q(r)&&xe.a.createElement(or,{metric:r,previousMetrics:s}))},pr=function(e){var t=e.children,r=e.label,n=e.onRemoveClick,a=e.onHideClick,i=e.hidden,o=void 0!==i&&i,s=e.disableRemove,l=void 0!==s&&s,u=Object(Se.useTheme)(),c=fr(u);return xe.a.createElement(Se.InlineFieldRow,null,xe.a.createElement(Se.InlineSegmentGroup,null,xe.a.createElement(Se.InlineLabel,{width:17,as:"div"},xe.a.createElement("span",null,r),xe.a.createElement("span",{className:c.iconWrapper},a&&xe.a.createElement(Se.IconButton,{name:o?"eye-slash":"eye",onClick:a,surface:"header",size:"sm","aria-pressed":o,"aria-label":"hide metric",className:c.icon}),n&&xe.a.createElement(Se.IconButton,{name:"trash-alt",surface:"header",size:"sm",className:c.icon,onClick:n||h.noop,disabled:l,"aria-label":"remove metric"})))),t)},fr=Object(Se.stylesFactory)((function(e){return{iconWrapper:Object(Ve.css)(Wt||(Wt=f(["\n      display: flex;\n    "],["\n      display: flex;\n    "]))),icon:Object(Ve.css)(Yt||(Yt=f(["\n      color: ",";\n      margin-left: ",";\n    "],["\n      color: ",";\n      margin-left: ",";\n    "])),e.colors.textWeak,e.spacing.xxs)}})),hr=function(e){var t=e.nextId,r=ft(),n=Ot().metrics,a=(null==n?void 0:n.length)||0;return xe.a.createElement(xe.a.Fragment,null,null==n?void 0:n.map((function(e,n){return xe.a.createElement(pr,{key:e.id,label:"Metric ("+e.id+")",hidden:e.hide,onHideClick:function(){return r({type:"@metrics/toggle_visibility",payload:{id:e.id}})},onRemoveClick:function(){return r({type:"@metrics/remove",payload:{id:e.id}})},disableRemove:!(a>1)},xe.a.createElement(dr,{value:e}),!B[e.type].isSingleMetric&&0===n&&xe.a.createElement(Dt,{iconName:"plus",onClick:function(){return r({type:"@metrics/add",payload:{id:t}})},label:"add"}))})))},mr=function(e,t,r){return{type:"@bucketAggs/change_setting",payload:{bucketAgg:e,settingName:t,newValue:r}}},vr=function(e,t){return{type:"@bucketAggregations/filter/change",payload:{index:e,filter:t}}},gr=function(e,t){switch(void 0===e&&(e=[]),t.type){case"@bucketAggregations/filter/add":return p(p([],d(e)),[{label:"",query:"*"}]);case"@bucketAggregations/filter/remove":return e.slice(0,t.payload.index).concat(e.slice(t.payload.index+1));case"@bucketAggregations/filter/change":return e.map((function(e,r){return r!==t.payload.index?e:t.payload.filter}))}},yr=function(e){var t,r,n=e.value,a=ft(),i=dt((function(e){return a(mr(n,"filters",e))}),null===(t=n.settings)||void 0===t?void 0:t.filters,gr);return Object(we.useEffect)((function(){var e,t;(null===(t=null===(e=n.settings)||void 0===e?void 0:e.filters)||void 0===t?void 0:t.length)||i({type:"@bucketAggregations/filter/add"})}),[]),xe.a.createElement(xe.a.Fragment,null,xe.a.createElement("div",{className:Object(Ve.css)(Xt||(Xt=f(["\n          display: flex;\n          flex-direction: column;\n        "],["\n          display: flex;\n          flex-direction: column;\n        "])))},null===(r=n.settings)||void 0===r?void 0:r.filters.map((function(e,t){var r;return xe.a.createElement("div",{key:t,className:Object(Ve.css)(Jt||(Jt=f(["\n              display: flex;\n            "],["\n              display: flex;\n            "])))},xe.a.createElement("div",{className:Object(Ve.css)(Kt||(Kt=f(["\n                width: 250px;\n              "],["\n                width: 250px;\n              "])))},xe.a.createElement(Se.InlineField,{label:"Query",labelWidth:10},xe.a.createElement(Se.QueryField,{placeholder:"Lucene Query",portalOrigin:"opensearch",onBlur:function(){},onChange:function(r){return i(vr(t,o(o({},e),{query:r})))},query:e.query}))),xe.a.createElement(Se.InlineField,{label:"Label",labelWidth:10},xe.a.createElement(Se.Input,{placeholder:"Label",onBlur:function(r){return i(vr(t,o(o({},e),{label:r.target.value})))},defaultValue:e.label})),xe.a.createElement(Nt,{index:t,elements:(null===(r=n.settings)||void 0===r?void 0:r.filters)||[],onAdd:function(){return i({type:"@bucketAggregations/filter/add"})},onRemove:function(){return i(function(e){return{type:"@bucketAggregations/filter/remove",payload:{index:e}}}(t))}}))}))))},br=function(e){return function(t){return t.value===e}},Er={labelWidth:16},wr=function(e){var t,r,n,a,i,s,l,u,c,f,h,m,v,g,y,b,E,w,x,S,O,_,I,T,P=e.bucketAgg,A=ft(),F=Ot().metrics,k=function(e){var t,r,n,a,i,o,s,l,u,c,d,p,f,h=Ot().metrics;switch(e.type){case"terms":var m=(null===(t=e.settings)||void 0===t?void 0:t.order)||"desc",v=(null===(r=e.settings)||void 0===r?void 0:r.size)||"10",g=parseInt((null===(n=e.settings)||void 0===n?void 0:n.min_doc_count)||"0",10),y=(null===(a=e.settings)||void 0===a?void 0:a.orderBy)||"_term",b="";if("0"!==v)b=(null===(i=pe.find(br(m)))||void 0===i?void 0:i.label)+" "+v+", ";g>0&&(b+="Min Doc Count: "+g+", "),b+="Order by: ";var E=he.find(br(y));if(E)b+=E.label;else{var w=null==h?void 0:h.find((function(e){return e.id===y}));b+=w?K(w):"metric not found"}return"0"===v&&(b+=" ("+m+")"),b;case"histogram":return"Interval: "+(x=(null===(o=e.settings)||void 0===o?void 0:o.interval)||1e3)+((g=(null===(s=e.settings)||void 0===s?void 0:s.min_doc_count)||1)>0?", Min Doc Count: "+g:"");case"filters":return"Filter Queries ("+((null===(l=e.settings)||void 0===l?void 0:l.filters)||(null===(u=de.filters.defaultSettings)||void 0===u?void 0:u.filters)).length+")";case"geohash_grid":return"Precision: "+Math.max(Math.min(parseInt((null===(c=e.settings)||void 0===c?void 0:c.precision)||"5",10),12),1);case"date_histogram":var x=(null===(d=e.settings)||void 0===d?void 0:d.interval)||"auto",S=(g=(null===(p=e.settings)||void 0===p?void 0:p.min_doc_count)||0,(null===(f=e.settings)||void 0===f?void 0:f.trimEdges)||0);b="Interval: "+x;return g>0&&(b+=", Min Doc Count: "+g),S>0&&(b+=", Trim edges: "+S),b;default:return"Settings"}}(P),j=p(p([],d(he)),d((F||[]).map((function(e){return{label:K(e),value:e.id}}))));return xe.a.createElement(nr,{label:k},"terms"===P.type&&xe.a.createElement(xe.a.Fragment,null,xe.a.createElement(Se.InlineField,o({label:"Order"},Er),xe.a.createElement(Se.Select,{onChange:function(e){return A(mr(P,"order",e.value))},options:pe,value:(null===(t=P.settings)||void 0===t?void 0:t.order)||(null===(r=de[P.type].defaultSettings)||void 0===r?void 0:r.order)})),xe.a.createElement(Se.InlineField,o({label:"Size"},Er),xe.a.createElement(Se.Select,{onChange:function(e){return A(mr(P,"size",e.value))},options:fe,value:(null===(n=P.settings)||void 0===n?void 0:n.size)||(null===(a=de[P.type].defaultSettings)||void 0===a?void 0:a.size),allowCustomValue:!0})),xe.a.createElement(Se.InlineField,o({label:"Min Doc Count"},Er),xe.a.createElement(Se.Input,{onBlur:function(e){return A(mr(P,"min_doc_count",e.target.value))},defaultValue:(null===(i=P.settings)||void 0===i?void 0:i.min_doc_count)||(null===(s=de[P.type].defaultSettings)||void 0===s?void 0:s.min_doc_count)})),xe.a.createElement(Se.InlineField,o({label:"Order By"},Er),xe.a.createElement(Se.Select,{onChange:function(e){return A(mr(P,"orderBy",e.value))},options:j,value:(null===(l=P.settings)||void 0===l?void 0:l.orderBy)||(null===(u=de[P.type].defaultSettings)||void 0===u?void 0:u.orderBy)})),xe.a.createElement(Se.InlineField,o({label:"Missing"},Er),xe.a.createElement(Se.Input,{onBlur:function(e){return A(mr(P,"missing",e.target.value))},defaultValue:(null===(c=P.settings)||void 0===c?void 0:c.missing)||(null===(f=de[P.type].defaultSettings)||void 0===f?void 0:f.missing)}))),"geohash_grid"===P.type&&xe.a.createElement(Se.InlineField,o({label:"Precision"},Er),xe.a.createElement(Se.Input,{onBlur:function(e){return A(mr(P,"precision",e.target.value))},defaultValue:(null===(h=P.settings)||void 0===h?void 0:h.precision)||(null===(m=de[P.type].defaultSettings)||void 0===m?void 0:m.precision)})),"date_histogram"===P.type&&xe.a.createElement(xe.a.Fragment,null,xe.a.createElement(Se.InlineField,o({label:"Interval"},Er),xe.a.createElement(Se.Select,{onChange:function(e){return A(mr(P,"interval",e.value))},options:me,value:(null===(v=P.settings)||void 0===v?void 0:v.interval)||(null===(g=de[P.type].defaultSettings)||void 0===g?void 0:g.interval),allowCustomValue:!0})),xe.a.createElement(Se.InlineField,o({label:"Min Doc Count"},Er),xe.a.createElement(Se.Input,{onBlur:function(e){return A(mr(P,"min_doc_count",e.target.value))},defaultValue:(null===(y=P.settings)||void 0===y?void 0:y.min_doc_count)||(null===(b=de[P.type].defaultSettings)||void 0===b?void 0:b.min_doc_count)})),xe.a.createElement(Se.InlineField,o({label:"Trim Edges"},Er,{tooltip:"Trim the edges on the timeseries datapoints"}),xe.a.createElement(Se.Input,{onBlur:function(e){return A(mr(P,"trimEdges",e.target.value))},defaultValue:(null===(E=P.settings)||void 0===E?void 0:E.trimEdges)||(null===(w=de[P.type].defaultSettings)||void 0===w?void 0:w.trimEdges)})),xe.a.createElement(Se.InlineField,o({label:"Offset"},Er,{tooltip:"Change the start value of each bucket by the specified positive (+) or negative offset (-) duration, such as 1h for an hour, or 1d for a day"}),xe.a.createElement(Se.Input,{onBlur:function(e){return A(mr(P,"offset",e.target.value))},defaultValue:(null===(x=P.settings)||void 0===x?void 0:x.offset)||(null===(S=de[P.type].defaultSettings)||void 0===S?void 0:S.offset)}))),"histogram"===P.type&&xe.a.createElement(xe.a.Fragment,null,xe.a.createElement(Se.InlineField,o({label:"Interval"},Er),xe.a.createElement(Se.Input,{onBlur:function(e){return A(mr(P,"interval",e.target.value))},defaultValue:(null===(O=P.settings)||void 0===O?void 0:O.interval)||(null===(_=de[P.type].defaultSettings)||void 0===_?void 0:_.interval)})),xe.a.createElement(Se.InlineField,o({label:"Min Doc Count"},Er),xe.a.createElement(Se.Input,{onBlur:function(e){return A(mr(P,"min_doc_count",e.target.value))},defaultValue:(null===(I=P.settings)||void 0===I?void 0:I.min_doc_count)||(null===(T=de[P.type].defaultSettings)||void 0===T?void 0:T.min_doc_count)}))),"filters"===P.type&&xe.a.createElement(yr,{value:P}))},xr=Object.entries(de).map((function(e){var t=d(e,2),r=t[0];return{label:t[1].label,value:r}})),Sr=function(e){var t=e.value,r=e.text;return{label:r,value:""+(t||r)}},Or=function(e){var t,r=e.value,n=_t(),a=ft();return xe.a.createElement(xe.a.Fragment,null,xe.a.createElement(Se.Segment,{className:Tt,options:xr,onChange:function(e){return a((t=r.id,n=e.value,{type:"@bucketAggs/change_type",payload:{id:t,newType:n}}));var t,n},value:(t=r,{label:de[t.type].label,value:t.type})}),ve(r)&&xe.a.createElement(Se.SegmentAsync,{className:Tt,loadOptions:function(){return l(void 0,void 0,void 0,(function(){return u(this,(function(e){switch(e.label){case 0:return[4,function(){switch(r.type){case"date_histogram":return n.getFields("date");case"geohash_grid":return n.getFields("geo_point");default:return n.getFields()}}()];case 1:return[2,e.sent().map(Sr)]}}))}))},onChange:function(e){return a((t=r.id,n=e.value,{type:"@bucketAggs/change_field",payload:{id:t,newField:n}}));var t,n},placeholder:"Select Field",value:r.field}),xe.a.createElement(wr,{bucketAgg:r}))},_r=function(e){var t=e.nextId,r=ft(),n=Ot().bucketAggs,a=(null==n?void 0:n.length)||0;return xe.a.createElement(xe.a.Fragment,null,n.map((function(e,n){return xe.a.createElement(pr,{key:e.id,label:0===n?"Group By":"Then By",onRemoveClick:function(){return r({type:"@bucketAggs/remove",payload:{id:e.id}})},disableRemove:!(a>1)},xe.a.createElement(Or,{value:e}),0===n&&xe.a.createElement(Dt,{iconName:"plus",onClick:function(){return r({type:"@bucketAggs/add",payload:{id:t}})},label:"add"}))})))},Ir=function(e){return e.id},Tr=function(e){return parseInt(e,10)},Pr=function(e){var t=e.query,r=ft(),n=function(){var e=Ot(),t=e.metrics,r=e.bucketAggs;return Object(we.useMemo)((function(){return(Math.max.apply(Math,p([],d(p(p([],d((null==t?void 0:t.map(Ir))||["0"])),d((null==r?void 0:r.map(Ir))||["0"])).map(Tr))))+1).toString()}),[t,r])}();return xe.a.createElement(xe.a.Fragment,null,xe.a.createElement(Se.InlineFieldRow,null,xe.a.createElement(Se.InlineField,{label:"Query",labelWidth:17,grow:!0},xe.a.createElement(xe.a.Fragment,null,xe.a.createElement(Pt,{value:j.Lucene}),xe.a.createElement(Se.QueryField,{query:t,onBlur:function(){},onChange:function(e){return r(mt(e))},placeholder:"Lucene Query",portalOrigin:"opensearch"}))),xe.a.createElement(Se.InlineField,{label:"Alias",labelWidth:15},xe.a.createElement(Se.Input,{placeholder:"Alias Pattern",onBlur:function(e){return r({type:"change_alias_pattern",payload:{aliasPattern:e.currentTarget.value}})}}))),xe.a.createElement(hr,{nextId:n}),xe.a.createElement(_r,{nextId:n}))},Ar={table:{label:"Table"},logs:{label:"Logs"},time_series:{label:"Time series"}},Fr=Object.entries(Ar).map((function(e){var t=d(e,2),r=t[0];return{label:t[1].label,value:r}})),kr=function(e){var t,r=e.value,n=ft();return xe.a.createElement(Se.Segment,{className:Tt,options:Fr,onChange:function(e){return n({type:"change_format",payload:{format:e.value}})},value:(t=r,{label:Ar[t].label,value:t})})},jr=Object(Se.stylesFactory)((function(e){return{icon:Object(Ve.css)(Zt||(Zt=f(["\n      margin-right: ",";\n    "],["\n      margin-right: ",";\n    "])),e.spacing.xs),button:Object(Ve.css)(er||(er=f(["\n      justify-content: start;\n    "],["\n      justify-content: start;\n    "])))}})),Dr=function(e){var t=e.label,r=e.open,n=e.onClick,a=jr(Object(Se.useTheme)());return xe.a.createElement("button",{className:Object(Ve.cx)("gf-form-label",a.button,Tt),onClick:n,"aria-expanded":r},xe.a.createElement(Se.Icon,{name:r?"angle-down":"angle-right","aria-hidden":"true",className:a.icon}),t)},Nr=function(){return xe.a.createElement("div",{className:"gf-form grafana-info-box"},xe.a.createElement("div",null,xe.a.createElement("h5",null,"Table"),xe.a.createElement("ul",null,xe.a.createElement("li",null,"return any set of columns")),xe.a.createElement("br",null),xe.a.createElement("h5",null,"Logs"),xe.a.createElement("ul",null,xe.a.createElement("li",null,"return any set of columns")),xe.a.createElement("br",null),xe.a.createElement("h5",null,"Time series"),xe.a.createElement("ul",null,xe.a.createElement("li",null,"return column as date, datetime, or timestamp"),xe.a.createElement("li",null,"return column with numeric datatype as values")),xe.a.createElement("br",null),"Example PPL query for time series:",xe.a.createElement("br",null),xe.a.createElement("code",null,"source=<index> | eval dateValue=timestamp(timestamp) | stats count(response) by dateValue")))},Lr=function(){var e=Ot().format,t=d(Object(we.useState)(!1),2),r=t[0],n=t[1];return xe.a.createElement(xe.a.Fragment,null,xe.a.createElement(pr,{label:"Format"},xe.a.createElement(kr,{value:null!=e?e:"table"}),xe.a.createElement(Dr,{label:"Show help",open:r,onClick:function(){return n(!r)}})),r&&xe.a.createElement(Nr,null))},Rr=function(e){var t=e.query,r=ft();return xe.a.createElement(xe.a.Fragment,null,xe.a.createElement(Se.InlineFieldRow,null,xe.a.createElement(Se.InlineField,{label:"Query",labelWidth:17,grow:!0},xe.a.createElement(xe.a.Fragment,null,xe.a.createElement(Pt,{value:j.PPL}),xe.a.createElement(Se.QueryField,{query:t,onBlur:function(){},onChange:function(e){return r(mt(e))},placeholder:"PPL Query",portalOrigin:"opensearch"})))),xe.a.createElement(Lr,null))},$r=function(e){var t=e.value;switch(t.queryType){case j.PPL:return xe.a.createElement(Rr,{query:t.query});default:return xe.a.createElement(Pr,{query:t.query})}};r.d(t,"plugin",(function(){return Mr}));var Cr=function(){function e(){}return e.templateUrl="partials/annotations.editor.html",e}(),Mr=new n.DataSourcePlugin(be).setQueryEditor((function(e){var t=e.query,r=e.onChange,n=e.datasource;return xe.a.createElement(St,{datasource:n,onChange:r,query:t},xe.a.createElement($r,{value:t}))})).setConfigEditor((function(e){var t=e.options,r=e.onOptionsChange,n=Oe(t);return Object(we.useEffect)((function(){(function(e){return!(!Object(le.valid)(e.jsonData.version)||e.jsonData.flavor!==D.OpenSearch&&e.jsonData.flavor!==D.Elasticsearch||!e.jsonData.timeField||!e.jsonData.maxConcurrentShardRequests||void 0===e.jsonData.logMessageField||void 0===e.jsonData.logLevelField||void 0===e.jsonData.pplEnabled)})(t)||r(Oe(t))}),[]),xe.a.createElement(xe.a.Fragment,null,xe.a.createElement(Se.DataSourceHttpSettings,{defaultUrl:"http://localhost:9200",dataSourceConfig:n,showAccessOptions:!0,onChange:r,sigV4AuthToggleEnabled:ce.config.sigV4AuthEnabled}),xe.a.createElement(je,{value:n,onChange:r}),xe.a.createElement(Me,{value:n.jsonData,onChange:function(e){return r(o(o({},n),{jsonData:e}))}}),xe.a.createElement(ct,{value:n.jsonData.dataLinks,onChange:function(e){r(o(o({},n),{jsonData:o(o({},n.jsonData),{dataLinks:e})}))}}))})).setAnnotationQueryCtrl(Cr)}])}));
//# sourceMappingURL=module.js.map
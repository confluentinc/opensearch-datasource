/*! For license information please see module.js.LICENSE.txt */
define(["react","@grafana/ui","@grafana/data","lodash","@grafana/runtime","rxjs"],(function(e,t,r,n,a,i){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/",r(r.s=56)}([function(t,r){t.exports=e},function(e,r){e.exports=t},function(e,t){e.exports=r},function(e,t){e.exports=n},function(e,t){e.exports=a},function(e,t,r){const n=r(13),{MAX_LENGTH:a,MAX_SAFE_INTEGER:i}=r(12),{re:o,t:s}=r(8),l=r(14),{compareIdentifiers:u}=r(18);class c{constructor(e,t){if(t=l(t),e instanceof c){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError("Invalid Version: "+e);if(e.length>a)throw new TypeError(`version is longer than ${a} characters`);n("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const r=e.trim().match(t.loose?o[s.LOOSE]:o[s.FULL]);if(!r)throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>i||this.major<0)throw new TypeError("Invalid major version");if(this.minor>i||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>i||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<i)return t}return e}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version}toString(){return this.version}compare(e){if(n("SemVer.compare",this.version,this.options,e),!(e instanceof c)){if("string"==typeof e&&e===this.version)return 0;e=new c(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof c||(e=new c(e,this.options)),u(this.major,e.major)||u(this.minor,e.minor)||u(this.patch,e.patch)}comparePre(e){if(e instanceof c||(e=new c(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const r=this.prerelease[t],a=e.prerelease[t];if(n("prerelease compare",t,r,a),void 0===r&&void 0===a)return 0;if(void 0===a)return 1;if(void 0===r)return-1;if(r!==a)return u(r,a)}while(++t)}compareBuild(e){e instanceof c||(e=new c(e,this.options));let t=0;do{const r=this.build[t],a=e.build[t];if(n("prerelease compare",t,r,a),void 0===r&&void 0===a)return 0;if(void 0===a)return 1;if(void 0===r)return-1;if(r!==a)return u(r,a)}while(++t)}inc(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{let e=this.prerelease.length;for(;--e>=0;)"number"==typeof this.prerelease[e]&&(this.prerelease[e]++,e=-2);-1===e&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this.raw=this.version,this}}e.exports=c},function(e,t,r){const n=r(5);e.exports=(e,t,r)=>new n(e,r).compare(new n(t,r))},function(e,t,r){class n{constructor(e,t){if(t=i(t),e instanceof n)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new n(e.raw,t);if(e instanceof o)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map(e=>this.parseRange(e.trim())).filter(e=>e.length),!this.set.length)throw new TypeError("Invalid SemVer Range: "+e);if(this.set.length>1){const e=this.set[0];if(this.set=this.set.filter(e=>!h(e[0])),0===this.set.length)this.set=[e];else if(this.set.length>1)for(const e of this.set)if(1===e.length&&m(e[0])){this.set=[e];break}}this.format()}format(){return this.range=this.set.map(e=>e.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(e){e=e.trim();const t=`parseRange:${Object.keys(this.options).join(",")}:${e}`,r=a.get(t);if(r)return r;const n=this.options.loose,i=n?u[c.HYPHENRANGELOOSE]:u[c.HYPHENRANGE];e=e.replace(i,T(this.options.includePrerelease)),s("hyphen replace",e),e=e.replace(u[c.COMPARATORTRIM],d),s("comparator trim",e,u[c.COMPARATORTRIM]),e=(e=(e=e.replace(u[c.TILDETRIM],p)).replace(u[c.CARETTRIM],f)).split(/\s+/).join(" ");const l=n?u[c.COMPARATORLOOSE]:u[c.COMPARATOR],m=e.split(" ").map(e=>v(e,this.options)).join(" ").split(/\s+/).map(e=>O(e,this.options)).filter(this.options.loose?e=>!!e.match(l):()=>!0).map(e=>new o(e,this.options)),g=(m.length,new Map);for(const e of m){if(h(e))return[e];g.set(e.value,e)}g.size>1&&g.has("")&&g.delete("");const y=[...g.values()];return a.set(t,y),y}intersects(e,t){if(!(e instanceof n))throw new TypeError("a Range is required");return this.set.some(r=>g(r,t)&&e.set.some(e=>g(e,t)&&r.every(r=>e.every(e=>r.intersects(e,t)))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new l(e,this.options)}catch(e){return!1}for(let t=0;t<this.set.length;t++)if(A(this.set[t],e,this.options))return!0;return!1}}e.exports=n;const a=new(r(43))({max:1e3}),i=r(14),o=r(16),s=r(13),l=r(5),{re:u,t:c,comparatorTrimReplace:d,tildeTrimReplace:p,caretTrimReplace:f}=r(8),h=e=>"<0.0.0-0"===e.value,m=e=>""===e.value,g=(e,t)=>{let r=!0;const n=e.slice();let a=n.pop();for(;r&&n.length;)r=n.every(e=>a.intersects(e,t)),a=n.pop();return r},v=(e,t)=>(s("comp",e,t),e=w(e,t),s("caret",e),e=b(e,t),s("tildes",e),e=S(e,t),s("xrange",e),e=I(e,t),s("stars",e),e),y=e=>!e||"x"===e.toLowerCase()||"*"===e,b=(e,t)=>e.trim().split(/\s+/).map(e=>E(e,t)).join(" "),E=(e,t)=>{const r=t.loose?u[c.TILDELOOSE]:u[c.TILDE];return e.replace(r,(t,r,n,a,i)=>{let o;return s("tilde",e,t,r,n,a,i),y(r)?o="":y(n)?o=`>=${r}.0.0 <${+r+1}.0.0-0`:y(a)?o=`>=${r}.${n}.0 <${r}.${+n+1}.0-0`:i?(s("replaceTilde pr",i),o=`>=${r}.${n}.${a}-${i} <${r}.${+n+1}.0-0`):o=`>=${r}.${n}.${a} <${r}.${+n+1}.0-0`,s("tilde return",o),o})},w=(e,t)=>e.trim().split(/\s+/).map(e=>x(e,t)).join(" "),x=(e,t)=>{s("caret",e,t);const r=t.loose?u[c.CARETLOOSE]:u[c.CARET],n=t.includePrerelease?"-0":"";return e.replace(r,(t,r,a,i,o)=>{let l;return s("caret",e,t,r,a,i,o),y(r)?l="":y(a)?l=`>=${r}.0.0${n} <${+r+1}.0.0-0`:y(i)?l="0"===r?`>=${r}.${a}.0${n} <${r}.${+a+1}.0-0`:`>=${r}.${a}.0${n} <${+r+1}.0.0-0`:o?(s("replaceCaret pr",o),l="0"===r?"0"===a?`>=${r}.${a}.${i}-${o} <${r}.${a}.${+i+1}-0`:`>=${r}.${a}.${i}-${o} <${r}.${+a+1}.0-0`:`>=${r}.${a}.${i}-${o} <${+r+1}.0.0-0`):(s("no pr"),l="0"===r?"0"===a?`>=${r}.${a}.${i}${n} <${r}.${a}.${+i+1}-0`:`>=${r}.${a}.${i}${n} <${r}.${+a+1}.0-0`:`>=${r}.${a}.${i} <${+r+1}.0.0-0`),s("caret return",l),l})},S=(e,t)=>(s("replaceXRanges",e,t),e.split(/\s+/).map(e=>_(e,t)).join(" ")),_=(e,t)=>{e=e.trim();const r=t.loose?u[c.XRANGELOOSE]:u[c.XRANGE];return e.replace(r,(r,n,a,i,o,l)=>{s("xRange",e,r,n,a,i,o,l);const u=y(a),c=u||y(i),d=c||y(o),p=d;return"="===n&&p&&(n=""),l=t.includePrerelease?"-0":"",u?r=">"===n||"<"===n?"<0.0.0-0":"*":n&&p?(c&&(i=0),o=0,">"===n?(n=">=",c?(a=+a+1,i=0,o=0):(i=+i+1,o=0)):"<="===n&&(n="<",c?a=+a+1:i=+i+1),"<"===n&&(l="-0"),r=`${n+a}.${i}.${o}${l}`):c?r=`>=${a}.0.0${l} <${+a+1}.0.0-0`:d&&(r=`>=${a}.${i}.0${l} <${a}.${+i+1}.0-0`),s("xRange return",r),r})},I=(e,t)=>(s("replaceStars",e,t),e.trim().replace(u[c.STAR],"")),O=(e,t)=>(s("replaceGTE0",e,t),e.trim().replace(u[t.includePrerelease?c.GTE0PRE:c.GTE0],"")),T=e=>(t,r,n,a,i,o,s,l,u,c,d,p,f)=>`${r=y(n)?"":y(a)?`>=${n}.0.0${e?"-0":""}`:y(i)?`>=${n}.${a}.0${e?"-0":""}`:o?">="+r:`>=${r}${e?"-0":""}`} ${l=y(u)?"":y(c)?`<${+u+1}.0.0-0`:y(d)?`<${u}.${+c+1}.0-0`:p?`<=${u}.${c}.${d}-${p}`:e?`<${u}.${c}.${+d+1}-0`:"<="+l}`.trim(),A=(e,t,r)=>{for(let r=0;r<e.length;r++)if(!e[r].test(t))return!1;if(t.prerelease.length&&!r.includePrerelease){for(let r=0;r<e.length;r++)if(s(e[r].semver),e[r].semver!==o.ANY&&e[r].semver.prerelease.length>0){const n=e[r].semver;if(n.major===t.major&&n.minor===t.minor&&n.patch===t.patch)return!0}return!1}return!0}},function(e,t,r){const{MAX_SAFE_COMPONENT_LENGTH:n}=r(12),a=r(13),i=(t=e.exports={}).re=[],o=t.src=[],s=t.t={};let l=0;const u=(e,t,r)=>{const n=l++;a(n,t),s[e]=n,o[n]=t,i[n]=new RegExp(t,r?"g":void 0)};u("NUMERICIDENTIFIER","0|[1-9]\\d*"),u("NUMERICIDENTIFIERLOOSE","[0-9]+"),u("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),u("MAINVERSION",`(${o[s.NUMERICIDENTIFIER]})\\.(${o[s.NUMERICIDENTIFIER]})\\.(${o[s.NUMERICIDENTIFIER]})`),u("MAINVERSIONLOOSE",`(${o[s.NUMERICIDENTIFIERLOOSE]})\\.(${o[s.NUMERICIDENTIFIERLOOSE]})\\.(${o[s.NUMERICIDENTIFIERLOOSE]})`),u("PRERELEASEIDENTIFIER",`(?:${o[s.NUMERICIDENTIFIER]}|${o[s.NONNUMERICIDENTIFIER]})`),u("PRERELEASEIDENTIFIERLOOSE",`(?:${o[s.NUMERICIDENTIFIERLOOSE]}|${o[s.NONNUMERICIDENTIFIER]})`),u("PRERELEASE",`(?:-(${o[s.PRERELEASEIDENTIFIER]}(?:\\.${o[s.PRERELEASEIDENTIFIER]})*))`),u("PRERELEASELOOSE",`(?:-?(${o[s.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${o[s.PRERELEASEIDENTIFIERLOOSE]})*))`),u("BUILDIDENTIFIER","[0-9A-Za-z-]+"),u("BUILD",`(?:\\+(${o[s.BUILDIDENTIFIER]}(?:\\.${o[s.BUILDIDENTIFIER]})*))`),u("FULLPLAIN",`v?${o[s.MAINVERSION]}${o[s.PRERELEASE]}?${o[s.BUILD]}?`),u("FULL",`^${o[s.FULLPLAIN]}$`),u("LOOSEPLAIN",`[v=\\s]*${o[s.MAINVERSIONLOOSE]}${o[s.PRERELEASELOOSE]}?${o[s.BUILD]}?`),u("LOOSE",`^${o[s.LOOSEPLAIN]}$`),u("GTLT","((?:<|>)?=?)"),u("XRANGEIDENTIFIERLOOSE",o[s.NUMERICIDENTIFIERLOOSE]+"|x|X|\\*"),u("XRANGEIDENTIFIER",o[s.NUMERICIDENTIFIER]+"|x|X|\\*"),u("XRANGEPLAIN",`[v=\\s]*(${o[s.XRANGEIDENTIFIER]})(?:\\.(${o[s.XRANGEIDENTIFIER]})(?:\\.(${o[s.XRANGEIDENTIFIER]})(?:${o[s.PRERELEASE]})?${o[s.BUILD]}?)?)?`),u("XRANGEPLAINLOOSE",`[v=\\s]*(${o[s.XRANGEIDENTIFIERLOOSE]})(?:\\.(${o[s.XRANGEIDENTIFIERLOOSE]})(?:\\.(${o[s.XRANGEIDENTIFIERLOOSE]})(?:${o[s.PRERELEASELOOSE]})?${o[s.BUILD]}?)?)?`),u("XRANGE",`^${o[s.GTLT]}\\s*${o[s.XRANGEPLAIN]}$`),u("XRANGELOOSE",`^${o[s.GTLT]}\\s*${o[s.XRANGEPLAINLOOSE]}$`),u("COERCE",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?(?:$|[^\\d])`),u("COERCERTL",o[s.COERCE],!0),u("LONETILDE","(?:~>?)"),u("TILDETRIM",`(\\s*)${o[s.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",u("TILDE",`^${o[s.LONETILDE]}${o[s.XRANGEPLAIN]}$`),u("TILDELOOSE",`^${o[s.LONETILDE]}${o[s.XRANGEPLAINLOOSE]}$`),u("LONECARET","(?:\\^)"),u("CARETTRIM",`(\\s*)${o[s.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",u("CARET",`^${o[s.LONECARET]}${o[s.XRANGEPLAIN]}$`),u("CARETLOOSE",`^${o[s.LONECARET]}${o[s.XRANGEPLAINLOOSE]}$`),u("COMPARATORLOOSE",`^${o[s.GTLT]}\\s*(${o[s.LOOSEPLAIN]})$|^$`),u("COMPARATOR",`^${o[s.GTLT]}\\s*(${o[s.FULLPLAIN]})$|^$`),u("COMPARATORTRIM",`(\\s*)${o[s.GTLT]}\\s*(${o[s.LOOSEPLAIN]}|${o[s.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",u("HYPHENRANGE",`^\\s*(${o[s.XRANGEPLAIN]})\\s+-\\s+(${o[s.XRANGEPLAIN]})\\s*$`),u("HYPHENRANGELOOSE",`^\\s*(${o[s.XRANGEPLAINLOOSE]})\\s+-\\s+(${o[s.XRANGEPLAINLOOSE]})\\s*$`),u("STAR","(<|>)?=?\\s*\\*"),u("GTE0","^\\s*>=\\s*0.0.0\\s*$"),u("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")},function(e,t,r){const{MAX_LENGTH:n}=r(12),{re:a,t:i}=r(8),o=r(5),s=r(14);e.exports=(e,t)=>{if(t=s(t),e instanceof o)return e;if("string"!=typeof e)return null;if(e.length>n)return null;if(!(t.loose?a[i.LOOSE]:a[i.FULL]).test(e))return null;try{return new o(e,t)}catch(e){return null}}},function(e,t){e.exports=i},function(e,t,r){const n=r(8);e.exports={re:n.re,src:n.src,tokens:n.t,SEMVER_SPEC_VERSION:r(12).SEMVER_SPEC_VERSION,SemVer:r(5),compareIdentifiers:r(18).compareIdentifiers,rcompareIdentifiers:r(18).rcompareIdentifiers,parse:r(9),valid:r(30),clean:r(31),inc:r(32),diff:r(33),major:r(34),minor:r(35),patch:r(36),prerelease:r(37),compare:r(6),rcompare:r(38),compareLoose:r(39),compareBuild:r(20),sort:r(40),rsort:r(41),gt:r(15),lt:r(21),eq:r(19),neq:r(25),gte:r(22),lte:r(23),cmp:r(26),coerce:r(42),Comparator:r(16),Range:r(7),satisfies:r(17),toComparators:r(46),maxSatisfying:r(47),minSatisfying:r(48),minVersion:r(49),validRange:r(50),outside:r(24),gtr:r(51),ltr:r(52),intersects:r(53),simplifyRange:r(54),subset:r(55)}},function(e,t){const r=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:r,MAX_SAFE_COMPONENT_LENGTH:16}},function(e,t,r){(function(t){const r="object"==typeof t&&t.env&&t.env.NODE_DEBUG&&/\bsemver\b/i.test(t.env.NODE_DEBUG)?(...e)=>{}:()=>{};e.exports=r}).call(this,r(29))},function(e,t){const r=["includePrerelease","loose","rtl"];e.exports=e=>e?"object"!=typeof e?{loose:!0}:r.filter(t=>e[t]).reduce((e,t)=>(e[t]=!0,e),{}):{}},function(e,t,r){const n=r(6);e.exports=(e,t,r)=>n(e,t,r)>0},function(e,t,r){const n=Symbol("SemVer ANY");class a{static get ANY(){return n}constructor(e,t){if(t=i(t),e instanceof a){if(e.loose===!!t.loose)return e;e=e.value}u("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===n?this.value="":this.value=this.operator+this.semver.version,u("comp",this)}parse(e){const t=this.options.loose?o[s.COMPARATORLOOSE]:o[s.COMPARATOR],r=e.match(t);if(!r)throw new TypeError("Invalid comparator: "+e);this.operator=void 0!==r[1]?r[1]:"","="===this.operator&&(this.operator=""),r[2]?this.semver=new c(r[2],this.options.loose):this.semver=n}toString(){return this.value}test(e){if(u("Comparator.test",e,this.options.loose),this.semver===n||e===n)return!0;if("string"==typeof e)try{e=new c(e,this.options)}catch(e){return!1}return l(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof a))throw new TypeError("a Comparator is required");if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),""===this.operator)return""===this.value||new d(e.value,t).test(this.value);if(""===e.operator)return""===e.value||new d(this.value,t).test(e.semver);const r=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),n=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),i=this.semver.version===e.semver.version,o=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),s=l(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),u=l(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return r||n||i&&o||s||u}}e.exports=a;const i=r(14),{re:o,t:s}=r(8),l=r(26),u=r(13),c=r(5),d=r(7)},function(e,t,r){const n=r(7);e.exports=(e,t,r)=>{try{t=new n(t,r)}catch(e){return!1}return t.test(e)}},function(e,t){const r=/^[0-9]+$/,n=(e,t)=>{const n=r.test(e),a=r.test(t);return n&&a&&(e=+e,t=+t),e===t?0:n&&!a?-1:a&&!n?1:e<t?-1:1};e.exports={compareIdentifiers:n,rcompareIdentifiers:(e,t)=>n(t,e)}},function(e,t,r){const n=r(6);e.exports=(e,t,r)=>0===n(e,t,r)},function(e,t,r){const n=r(5);e.exports=(e,t,r)=>{const a=new n(e,r),i=new n(t,r);return a.compare(i)||a.compareBuild(i)}},function(e,t,r){const n=r(6);e.exports=(e,t,r)=>n(e,t,r)<0},function(e,t,r){const n=r(6);e.exports=(e,t,r)=>n(e,t,r)>=0},function(e,t,r){const n=r(6);e.exports=(e,t,r)=>n(e,t,r)<=0},function(e,t,r){const n=r(5),a=r(16),{ANY:i}=a,o=r(7),s=r(17),l=r(15),u=r(21),c=r(23),d=r(22);e.exports=(e,t,r,p)=>{let f,h,m,g,v;switch(e=new n(e,p),t=new o(t,p),r){case">":f=l,h=c,m=u,g=">",v=">=";break;case"<":f=u,h=d,m=l,g="<",v="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(s(e,t,p))return!1;for(let r=0;r<t.set.length;++r){const n=t.set[r];let o=null,s=null;if(n.forEach(e=>{e.semver===i&&(e=new a(">=0.0.0")),o=o||e,s=s||e,f(e.semver,o.semver,p)?o=e:m(e.semver,s.semver,p)&&(s=e)}),o.operator===g||o.operator===v)return!1;if((!s.operator||s.operator===g)&&h(e,s.semver))return!1;if(s.operator===v&&m(e,s.semver))return!1}return!0}},function(e,t,r){const n=r(6);e.exports=(e,t,r)=>0!==n(e,t,r)},function(e,t,r){const n=r(19),a=r(25),i=r(15),o=r(22),s=r(21),l=r(23);e.exports=(e,t,r,u)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e===r;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof r&&(r=r.version),e!==r;case"":case"=":case"==":return n(e,r,u);case"!=":return a(e,r,u);case">":return i(e,r,u);case">=":return o(e,r,u);case"<":return s(e,r,u);case"<=":return l(e,r,u);default:throw new TypeError("Invalid operator: "+t)}}},function(e,t,r){"use strict";e.exports=r(28)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={DataSource:{TestData:{QueryTab:{scenarioSelectContainer:"Test Data Query scenario select container",scenarioSelect:"Test Data Query scenario select",max:"TestData max",min:"TestData min",noise:"TestData noise",seriesCount:"TestData series count",spread:"TestData spread",startValue:"TestData start value"}}},Panels:{Panel:{title:function(e){return"Panel header title item "+e},headerItems:function(e){return"Panel header item "+e},containerByTitle:function(e){return"Panel container title "+e},headerCornerInfo:function(e){return"Panel header "+e}},Visualization:{Graph:{VisualizationTab:{legendSection:"Legend section"},Legend:{legendItemAlias:function(e){return"gpl alias "+e},showLegendSwitch:"gpl show legend"},xAxis:{labels:function(){return"div.flot-x-axis > div.flot-tick-label"}}},BarGauge:{value:"Bar gauge value"},Text:{container:function(){return".markdown-html"}}}},Drawer:{General:{title:function(e){return"Drawer title "+e},expand:"Drawer expand",contract:"Drawer contract",close:"Drawer close",rcContentWrapper:function(){return".drawer-content-wrapper"}}},PanelEditor:{General:{content:"Panel editor content"},OptionsPane:{content:"Panel editor option pane content",close:"Page toolbar button Close options pane",open:"Page toolbar button Open options pane",select:"Panel editor option pane select",tab:function(e){return"Panel editor option pane tab "+e}},DataPane:{content:"Panel editor data pane content"},FieldOptions:{propertyEditor:function(e){return e+" field property editor"}}},PanelInspector:{Data:{content:"Panel inspector Data content"},Stats:{content:"Panel inspector Stats content"},Json:{content:"Panel inspector Json content"},Query:{content:"Panel inspector Query content",refreshButton:"Panel inspector Query refresh button",jsonObjectKeys:function(){return".json-formatter-key"}}},Tab:{title:function(e){return"Tab "+e},active:function(){return'[class*="-activeTabStyle"]'}},RefreshPicker:{runButton:"RefreshPicker run button"},QueryTab:{content:"Query editor tab content",queryInspectorButton:"Query inspector button",addQuery:"Query editor add query button"},QueryEditorRows:{rows:"Query editor row"},QueryEditorRow:{actionButton:function(e){return e+" query operation action"},title:function(e){return"Query editor row title "+e}},AlertTab:{content:"Alert editor tab content"},Alert:{alert:function(e){return"Alert "+e}},TransformTab:{content:"Transform editor tab content",newTransform:function(e){return"New transform "+e},transformationEditor:function(e){return"Transformation editor "+e},transformationEditorDebugger:function(e){return"Transformation editor debugger "+e}},Transforms:{card:function(e){return"New transform "+e},Reduce:{modeLabel:"Transform mode label",calculationsLabel:"Transform calculations label"},searchInput:"search transformations"},PageToolbar:{container:function(){return".page-toolbar"},item:function(e){return"Page toolbar button "+e}},QueryEditorToolbarItem:{button:function(e){return"QueryEditor toolbar item button "+e}},BackButton:{backArrow:"Go Back button"},OptionsGroup:{toggle:function(e){return e?"Options group "+e:"Options group"}},PluginVisualization:{item:function(e){return"Plugin visualization item "+e},current:function(){return'[class*="-currentVisualizationItem"]'}},Select:{option:"Select option",input:function(){return'input[id*="react-select-"]'},singleValue:function(){return'div[class*="-singleValue"]'}},FieldConfigEditor:{content:"Field config editor content"},OverridesConfigEditor:{content:"Field overrides editor content"},FolderPicker:{container:"Folder picker select container"},DataSourcePicker:{container:"Data source picker select container"},TimeZonePicker:{container:"Time zone picker select container"},TraceViewer:{spanBar:function(){return'[data-test-id="SpanBar--wrapper"]'}},QueryField:{container:"Query field"},ValuePicker:{button:"Value picker add button",select:function(e){return"Value picker select "+e}},Search:{section:"Search section",items:"Search items"},DashboardLinks:{container:"Dashboard link container",dropDown:"Dashboard link dropdown",link:"Dashboard link"},CallToActionCard:{button:function(e){return"Call to action button "+e}},DataLinksContextMenu:{singleLink:"Data link"}},a={pages:{Login:{url:"/login",username:"Username input field",password:"Password input field",submit:"Login button",skip:"Skip change password button"},Home:{url:"/"},DataSource:{name:"Data source settings page name input field",delete:"Data source settings page Delete button",saveAndTest:"Data source settings page Save and Test button",alert:"Data source settings page Alert"},DataSources:{url:"/datasources",dataSources:function(e){return"Data source list item "+e}},AddDataSource:{url:"/datasources/new",dataSourcePlugins:function(e){return"Data source plugin item "+e}},ConfirmModal:{delete:"Confirm Modal Danger Button"},AddDashboard:{url:"/dashboard/new",addNewPanel:"Add new panel"},Dashboard:{url:function(e){return"/d/"+e},SubMenu:{submenuItem:"Dashboard template variables submenu item",submenuItemLabels:function(e){return"Dashboard template variables submenu Label "+e},submenuItemValueDropDownValueLinkTexts:function(e){return"Dashboard template variables Variable Value DropDown value link text "+e},submenuItemValueDropDownDropDown:"Dashboard template variables Variable Value DropDown DropDown",submenuItemValueDropDownOptionTexts:function(e){return"Dashboard template variables Variable Value DropDown option text "+e}},Settings:{General:{deleteDashBoard:"Dashboard settings page delete dashboard button",sectionItems:function(e){return"Dashboard settings section item "+e},saveDashBoard:"Dashboard settings aside actions Save button",saveAsDashBoard:"Dashboard settings aside actions Save As button",timezone:"Time zone picker select container",title:"Dashboard settings page title"},Annotations:{List:{addAnnotationCTA:n.CallToActionCard.button("Add Annotation Query")}},Variables:{List:{addVariableCTA:n.CallToActionCard.button("Add variable"),newButton:"Variable editor New variable button",table:"Variable editor Table",tableRowNameFields:function(e){return"Variable editor Table Name field "+e},tableRowDefinitionFields:function(e){return"Variable editor Table Definition field "+e},tableRowArrowUpButtons:function(e){return"Variable editor Table ArrowUp button "+e},tableRowArrowDownButtons:function(e){return"Variable editor Table ArrowDown button "+e},tableRowDuplicateButtons:function(e){return"Variable editor Table Duplicate button "+e},tableRowRemoveButtons:function(e){return"Variable editor Table Remove button "+e}},Edit:{General:{headerLink:"Variable editor Header link",modeLabelNew:"Variable editor Header mode New",modeLabelEdit:"Variable editor Header mode Edit",generalNameInput:"Variable editor Form Name field",generalTypeSelect:"Variable editor Form Type select",generalLabelInput:"Variable editor Form Label field",generalHideSelect:"Variable editor Form Hide select",selectionOptionsMultiSwitch:"Variable editor Form Multi switch",selectionOptionsIncludeAllSwitch:"Variable editor Form IncludeAll switch",selectionOptionsCustomAllInput:"Variable editor Form IncludeAll field",previewOfValuesOption:"Variable editor Preview of Values option",submitButton:"Variable editor Submit button"},QueryVariable:{queryOptionsDataSourceSelect:n.DataSourcePicker.container,queryOptionsRefreshSelect:"Variable editor Form Query Refresh select",queryOptionsRegExInput:"Variable editor Form Query RegEx field",queryOptionsSortSelect:"Variable editor Form Query Sort select",queryOptionsQueryInput:"Variable editor Form Default Variable Query Editor textarea",valueGroupsTagsEnabledSwitch:"Variable editor Form Query UseTags switch",valueGroupsTagsTagsQueryInput:"Variable editor Form Query TagsQuery field",valueGroupsTagsTagsValuesQueryInput:"Variable editor Form Query TagsValuesQuery field"},ConstantVariable:{constantOptionsQueryInput:"Variable editor Form Constant Query field"},TextBoxVariable:{textBoxOptionsQueryInput:"Variable editor Form TextBox Query field"}}}}},Dashboards:{url:"/dashboards",dashboards:function(e){return"Dashboard search item "+e}},SaveDashboardAsModal:{newName:"Save dashboard title field",save:"Save dashboard button"},SaveDashboardModal:{save:"Dashboard settings Save Dashboard Modal Save button",saveVariables:"Dashboard settings Save Dashboard Modal Save variables checkbox",saveTimerange:"Dashboard settings Save Dashboard Modal Save timerange checkbox"},SharePanelModal:{linkToRenderedImage:"Link to rendered image"},Explore:{url:"/explore",General:{container:"Explore",graph:"Explore Graph",table:"Explore Table",scrollBar:function(){return".scrollbar-view"}},Toolbar:{navBar:function(){return".explore-toolbar"}}},SoloPanel:{url:function(e){return"/d-solo/"+e}},PluginsList:{page:"Plugins list page",list:"Plugins list",listItem:"Plugins list item",signatureErrorNotice:"Unsigned plugins notice"},PluginPage:{page:"Plugin page",signatureInfo:"Plugin signature info"}},components:n};t.selectors=a},function(e,t){var r,n,a=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(r===setTimeout)return setTimeout(e,0);if((r===i||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:i}catch(e){r=i}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var l,u=[],c=!1,d=-1;function p(){c&&l&&(c=!1,l.length?u=l.concat(u):d=-1,u.length&&f())}function f(){if(!c){var e=s(p);c=!0;for(var t=u.length;t;){for(l=u,u=[];++d<t;)l&&l[d].run();d=-1,t=u.length}l=null,c=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function m(){}a.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new h(e,t)),1!==u.length||c||s(f)},h.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=m,a.addListener=m,a.once=m,a.off=m,a.removeListener=m,a.removeAllListeners=m,a.emit=m,a.prependListener=m,a.prependOnceListener=m,a.listeners=function(e){return[]},a.binding=function(e){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},function(e,t,r){const n=r(9);e.exports=(e,t)=>{const r=n(e,t);return r?r.version:null}},function(e,t,r){const n=r(9);e.exports=(e,t)=>{const r=n(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null}},function(e,t,r){const n=r(5);e.exports=(e,t,r,a)=>{"string"==typeof r&&(a=r,r=void 0);try{return new n(e,r).inc(t,a).version}catch(e){return null}}},function(e,t,r){const n=r(9),a=r(19);e.exports=(e,t)=>{if(a(e,t))return null;{const r=n(e),a=n(t),i=r.prerelease.length||a.prerelease.length,o=i?"pre":"",s=i?"prerelease":"";for(const e in r)if(("major"===e||"minor"===e||"patch"===e)&&r[e]!==a[e])return o+e;return s}}},function(e,t,r){const n=r(5);e.exports=(e,t)=>new n(e,t).major},function(e,t,r){const n=r(5);e.exports=(e,t)=>new n(e,t).minor},function(e,t,r){const n=r(5);e.exports=(e,t)=>new n(e,t).patch},function(e,t,r){const n=r(9);e.exports=(e,t)=>{const r=n(e,t);return r&&r.prerelease.length?r.prerelease:null}},function(e,t,r){const n=r(6);e.exports=(e,t,r)=>n(t,e,r)},function(e,t,r){const n=r(6);e.exports=(e,t)=>n(e,t,!0)},function(e,t,r){const n=r(20);e.exports=(e,t)=>e.sort((e,r)=>n(e,r,t))},function(e,t,r){const n=r(20);e.exports=(e,t)=>e.sort((e,r)=>n(r,e,t))},function(e,t,r){const n=r(5),a=r(9),{re:i,t:o}=r(8);e.exports=(e,t)=>{if(e instanceof n)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;let r=null;if((t=t||{}).rtl){let t;for(;(t=i[o.COERCERTL].exec(e))&&(!r||r.index+r[0].length!==e.length);)r&&t.index+t[0].length===r.index+r[0].length||(r=t),i[o.COERCERTL].lastIndex=t.index+t[1].length+t[2].length;i[o.COERCERTL].lastIndex=-1}else r=e.match(i[o.COERCE]);return null===r?null:a(`${r[2]}.${r[3]||"0"}.${r[4]||"0"}`,t)}},function(e,t,r){"use strict";const n=r(44),a=Symbol("max"),i=Symbol("length"),o=Symbol("lengthCalculator"),s=Symbol("allowStale"),l=Symbol("maxAge"),u=Symbol("dispose"),c=Symbol("noDisposeOnSet"),d=Symbol("lruList"),p=Symbol("cache"),f=Symbol("updateAgeOnGet"),h=()=>1;const m=(e,t,r)=>{const n=e[p].get(t);if(n){const t=n.value;if(g(e,t)){if(y(e,n),!e[s])return}else r&&(e[f]&&(n.value.now=Date.now()),e[d].unshiftNode(n));return t.value}},g=(e,t)=>{if(!t||!t.maxAge&&!e[l])return!1;const r=Date.now()-t.now;return t.maxAge?r>t.maxAge:e[l]&&r>e[l]},v=e=>{if(e[i]>e[a])for(let t=e[d].tail;e[i]>e[a]&&null!==t;){const r=t.prev;y(e,t),t=r}},y=(e,t)=>{if(t){const r=t.value;e[u]&&e[u](r.key,r.value),e[i]-=r.length,e[p].delete(r.key),e[d].removeNode(t)}};class b{constructor(e,t,r,n,a){this.key=e,this.value=t,this.length=r,this.now=n,this.maxAge=a||0}}const E=(e,t,r,n)=>{let a=r.value;g(e,a)&&(y(e,r),e[s]||(a=void 0)),a&&t.call(n,a.value,a.key,e)};e.exports=class{constructor(e){if("number"==typeof e&&(e={max:e}),e||(e={}),e.max&&("number"!=typeof e.max||e.max<0))throw new TypeError("max must be a non-negative number");this[a]=e.max||1/0;const t=e.length||h;if(this[o]="function"!=typeof t?h:t,this[s]=e.stale||!1,e.maxAge&&"number"!=typeof e.maxAge)throw new TypeError("maxAge must be a number");this[l]=e.maxAge||0,this[u]=e.dispose,this[c]=e.noDisposeOnSet||!1,this[f]=e.updateAgeOnGet||!1,this.reset()}set max(e){if("number"!=typeof e||e<0)throw new TypeError("max must be a non-negative number");this[a]=e||1/0,v(this)}get max(){return this[a]}set allowStale(e){this[s]=!!e}get allowStale(){return this[s]}set maxAge(e){if("number"!=typeof e)throw new TypeError("maxAge must be a non-negative number");this[l]=e,v(this)}get maxAge(){return this[l]}set lengthCalculator(e){"function"!=typeof e&&(e=h),e!==this[o]&&(this[o]=e,this[i]=0,this[d].forEach(e=>{e.length=this[o](e.value,e.key),this[i]+=e.length})),v(this)}get lengthCalculator(){return this[o]}get length(){return this[i]}get itemCount(){return this[d].length}rforEach(e,t){t=t||this;for(let r=this[d].tail;null!==r;){const n=r.prev;E(this,e,r,t),r=n}}forEach(e,t){t=t||this;for(let r=this[d].head;null!==r;){const n=r.next;E(this,e,r,t),r=n}}keys(){return this[d].toArray().map(e=>e.key)}values(){return this[d].toArray().map(e=>e.value)}reset(){this[u]&&this[d]&&this[d].length&&this[d].forEach(e=>this[u](e.key,e.value)),this[p]=new Map,this[d]=new n,this[i]=0}dump(){return this[d].map(e=>!g(this,e)&&{k:e.key,v:e.value,e:e.now+(e.maxAge||0)}).toArray().filter(e=>e)}dumpLru(){return this[d]}set(e,t,r){if((r=r||this[l])&&"number"!=typeof r)throw new TypeError("maxAge must be a number");const n=r?Date.now():0,s=this[o](t,e);if(this[p].has(e)){if(s>this[a])return y(this,this[p].get(e)),!1;const o=this[p].get(e).value;return this[u]&&(this[c]||this[u](e,o.value)),o.now=n,o.maxAge=r,o.value=t,this[i]+=s-o.length,o.length=s,this.get(e),v(this),!0}const f=new b(e,t,s,n,r);return f.length>this[a]?(this[u]&&this[u](e,t),!1):(this[i]+=f.length,this[d].unshift(f),this[p].set(e,this[d].head),v(this),!0)}has(e){if(!this[p].has(e))return!1;const t=this[p].get(e).value;return!g(this,t)}get(e){return m(this,e,!0)}peek(e){return m(this,e,!1)}pop(){const e=this[d].tail;return e?(y(this,e),e.value):null}del(e){y(this,this[p].get(e))}load(e){this.reset();const t=Date.now();for(let r=e.length-1;r>=0;r--){const n=e[r],a=n.e||0;if(0===a)this.set(n.k,n.v);else{const e=a-t;e>0&&this.set(n.k,n.v,e)}}}prune(){this[p].forEach((e,t)=>m(this,t,!1))}}},function(e,t,r){"use strict";function n(e){var t=this;if(t instanceof n||(t=new n),t.tail=null,t.head=null,t.length=0,e&&"function"==typeof e.forEach)e.forEach((function(e){t.push(e)}));else if(arguments.length>0)for(var r=0,a=arguments.length;r<a;r++)t.push(arguments[r]);return t}function a(e,t,r){var n=t===e.head?new s(r,null,t,e):new s(r,t,t.next,e);return null===n.next&&(e.tail=n),null===n.prev&&(e.head=n),e.length++,n}function i(e,t){e.tail=new s(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function o(e,t){e.head=new s(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function s(e,t,r,n){if(!(this instanceof s))return new s(e,t,r,n);this.list=n,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,r?(r.prev=this,this.next=r):this.next=null}e.exports=n,n.Node=s,n.create=n,n.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,r=e.prev;return t&&(t.prev=r),r&&(r.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=r),e.list.length--,e.next=null,e.prev=null,e.list=null,t},n.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},n.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},n.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)i(this,arguments[e]);return this.length},n.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)o(this,arguments[e]);return this.length},n.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},n.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},n.prototype.forEach=function(e,t){t=t||this;for(var r=this.head,n=0;null!==r;n++)e.call(t,r.value,n,this),r=r.next},n.prototype.forEachReverse=function(e,t){t=t||this;for(var r=this.tail,n=this.length-1;null!==r;n--)e.call(t,r.value,n,this),r=r.prev},n.prototype.get=function(e){for(var t=0,r=this.head;null!==r&&t<e;t++)r=r.next;if(t===e&&null!==r)return r.value},n.prototype.getReverse=function(e){for(var t=0,r=this.tail;null!==r&&t<e;t++)r=r.prev;if(t===e&&null!==r)return r.value},n.prototype.map=function(e,t){t=t||this;for(var r=new n,a=this.head;null!==a;)r.push(e.call(t,a.value,this)),a=a.next;return r},n.prototype.mapReverse=function(e,t){t=t||this;for(var r=new n,a=this.tail;null!==a;)r.push(e.call(t,a.value,this)),a=a.prev;return r},n.prototype.reduce=function(e,t){var r,n=this.head;if(arguments.length>1)r=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");n=this.head.next,r=this.head.value}for(var a=0;null!==n;a++)r=e(r,n.value,a),n=n.next;return r},n.prototype.reduceReverse=function(e,t){var r,n=this.tail;if(arguments.length>1)r=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");n=this.tail.prev,r=this.tail.value}for(var a=this.length-1;null!==n;a--)r=e(r,n.value,a),n=n.prev;return r},n.prototype.toArray=function(){for(var e=new Array(this.length),t=0,r=this.head;null!==r;t++)e[t]=r.value,r=r.next;return e},n.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,r=this.tail;null!==r;t++)e[t]=r.value,r=r.prev;return e},n.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var r=new n;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var a=0,i=this.head;null!==i&&a<e;a++)i=i.next;for(;null!==i&&a<t;a++,i=i.next)r.push(i.value);return r},n.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var r=new n;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var a=this.length,i=this.tail;null!==i&&a>t;a--)i=i.prev;for(;null!==i&&a>e;a--,i=i.prev)r.push(i.value);return r},n.prototype.splice=function(e,t,...r){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var n=0,i=this.head;null!==i&&n<e;n++)i=i.next;var o=[];for(n=0;i&&n<t;n++)o.push(i.value),i=this.removeNode(i);null===i&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev);for(n=0;n<r.length;n++)i=a(this,i,r[n]);return o},n.prototype.reverse=function(){for(var e=this.head,t=this.tail,r=e;null!==r;r=r.prev){var n=r.prev;r.prev=r.next,r.next=n}return this.head=t,this.tail=e,this};try{r(45)(n)}catch(e){}},function(e,t,r){"use strict";e.exports=function(e){e.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}},function(e,t,r){const n=r(7);e.exports=(e,t)=>new n(e,t).set.map(e=>e.map(e=>e.value).join(" ").trim().split(" "))},function(e,t,r){const n=r(5),a=r(7);e.exports=(e,t,r)=>{let i=null,o=null,s=null;try{s=new a(t,r)}catch(e){return null}return e.forEach(e=>{s.test(e)&&(i&&-1!==o.compare(e)||(i=e,o=new n(i,r)))}),i}},function(e,t,r){const n=r(5),a=r(7);e.exports=(e,t,r)=>{let i=null,o=null,s=null;try{s=new a(t,r)}catch(e){return null}return e.forEach(e=>{s.test(e)&&(i&&1!==o.compare(e)||(i=e,o=new n(i,r)))}),i}},function(e,t,r){const n=r(5),a=r(7),i=r(15);e.exports=(e,t)=>{e=new a(e,t);let r=new n("0.0.0");if(e.test(r))return r;if(r=new n("0.0.0-0"),e.test(r))return r;r=null;for(let t=0;t<e.set.length;++t){const a=e.set[t];let o=null;a.forEach(e=>{const t=new n(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":o&&!i(t,o)||(o=t);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+e.operator)}}),!o||r&&!i(r,o)||(r=o)}return r&&e.test(r)?r:null}},function(e,t,r){const n=r(7);e.exports=(e,t)=>{try{return new n(e,t).range||"*"}catch(e){return null}}},function(e,t,r){const n=r(24);e.exports=(e,t,r)=>n(e,t,">",r)},function(e,t,r){const n=r(24);e.exports=(e,t,r)=>n(e,t,"<",r)},function(e,t,r){const n=r(7);e.exports=(e,t,r)=>(e=new n(e,r),t=new n(t,r),e.intersects(t))},function(e,t,r){const n=r(17),a=r(6);e.exports=(e,t,r)=>{const i=[];let o=null,s=null;const l=e.sort((e,t)=>a(e,t,r));for(const e of l){n(e,t,r)?(s=e,o||(o=e)):(s&&i.push([o,s]),s=null,o=null)}o&&i.push([o,null]);const u=[];for(const[e,t]of i)e===t?u.push(e):t||e!==l[0]?t?e===l[0]?u.push("<="+t):u.push(`${e} - ${t}`):u.push(">="+e):u.push("*");const c=u.join(" || "),d="string"==typeof t.raw?t.raw:String(t);return c.length<d.length?c:t}},function(e,t,r){const n=r(7),a=r(16),{ANY:i}=a,o=r(17),s=r(6),l=(e,t,r)=>{if(e===t)return!0;if(1===e.length&&e[0].semver===i){if(1===t.length&&t[0].semver===i)return!0;e=r.includePrerelease?[new a(">=0.0.0-0")]:[new a(">=0.0.0")]}if(1===t.length&&t[0].semver===i){if(r.includePrerelease)return!0;t=[new a(">=0.0.0")]}const n=new Set;let l,d,p,f,h,m,g;for(const t of e)">"===t.operator||">="===t.operator?l=u(l,t,r):"<"===t.operator||"<="===t.operator?d=c(d,t,r):n.add(t.semver);if(n.size>1)return null;if(l&&d){if(p=s(l.semver,d.semver,r),p>0)return null;if(0===p&&(">="!==l.operator||"<="!==d.operator))return null}for(const e of n){if(l&&!o(e,String(l),r))return null;if(d&&!o(e,String(d),r))return null;for(const n of t)if(!o(e,String(n),r))return!1;return!0}let v=!(!d||r.includePrerelease||!d.semver.prerelease.length)&&d.semver,y=!(!l||r.includePrerelease||!l.semver.prerelease.length)&&l.semver;v&&1===v.prerelease.length&&"<"===d.operator&&0===v.prerelease[0]&&(v=!1);for(const e of t){if(g=g||">"===e.operator||">="===e.operator,m=m||"<"===e.operator||"<="===e.operator,l)if(y&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===y.major&&e.semver.minor===y.minor&&e.semver.patch===y.patch&&(y=!1),">"===e.operator||">="===e.operator){if(f=u(l,e,r),f===e&&f!==l)return!1}else if(">="===l.operator&&!o(l.semver,String(e),r))return!1;if(d)if(v&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===v.major&&e.semver.minor===v.minor&&e.semver.patch===v.patch&&(v=!1),"<"===e.operator||"<="===e.operator){if(h=c(d,e,r),h===e&&h!==d)return!1}else if("<="===d.operator&&!o(d.semver,String(e),r))return!1;if(!e.operator&&(d||l)&&0!==p)return!1}return!(l&&m&&!d&&0!==p)&&(!(d&&g&&!l&&0!==p)&&(!y&&!v))},u=(e,t,r)=>{if(!e)return t;const n=s(e.semver,t.semver,r);return n>0?e:n<0||">"===t.operator&&">="===e.operator?t:e},c=(e,t,r)=>{if(!e)return t;const n=s(e.semver,t.semver,r);return n<0?e:n>0||"<"===t.operator&&"<="===e.operator?t:e};e.exports=(e,t,r={})=>{if(e===t)return!0;e=new n(e,r),t=new n(t,r);let a=!1;e:for(const n of e.set){for(const e of t.set){const t=l(n,e,r);if(a=a||null!==t,t)continue e}if(a)return!1}return!0}},function(e,t,r){"use strict";r.r(t);var n=r(2),a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var o=function(){return(o=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function s(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r}function l(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{l(n.next(e))}catch(e){i(e)}}function s(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}l((n=n.apply(e,t||[])).next())}))}function u(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}Object.create;function c(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function d(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,a,i=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)o.push(n.value)}catch(e){a={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return o}function p(e,t){for(var r=0,n=t.length,a=e.length;r<n;r++,a++)e[a]=t[r];return e}function f(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}Object.create;var h=r(3),m=r.n(h),g=r(10),v=function(e,t){return(v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function y(e,t){function r(){this.constructor=e}v(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function b(e){return"function"==typeof e}var E=!1,w={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){if(e);E=e},get useDeprecatedSynchronousErrorHandling(){return E}};function x(e){setTimeout((function(){throw e}),0)}var S={closed:!0,next:function(e){},error:function(e){if(w.useDeprecatedSynchronousErrorHandling)throw e;x(e)},complete:function(){}},_=function(){return Array.isArray||function(e){return e&&"number"==typeof e.length}}();function I(e){return null!==e&&"object"==typeof e}var O=function(){function e(e){return Error.call(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e}(),T=function(){function e(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}return e.prototype.unsubscribe=function(){var t;if(!this.closed){var r=this._parentOrParents,n=this._ctorUnsubscribe,a=this._unsubscribe,i=this._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,r instanceof e)r.remove(this);else if(null!==r)for(var o=0;o<r.length;++o){r[o].remove(this)}if(b(a)){n&&(this._unsubscribe=void 0);try{a.call(this)}catch(e){t=e instanceof O?A(e.errors):[e]}}if(_(i)){o=-1;for(var s=i.length;++o<s;){var l=i[o];if(I(l))try{l.unsubscribe()}catch(e){t=t||[],e instanceof O?t=t.concat(A(e.errors)):t.push(e)}}}if(t)throw new O(t)}},e.prototype.add=function(t){var r=t;if(!t)return e.EMPTY;switch(typeof t){case"function":r=new e(t);case"object":if(r===this||r.closed||"function"!=typeof r.unsubscribe)return r;if(this.closed)return r.unsubscribe(),r;if(!(r instanceof e)){var n=r;(r=new e)._subscriptions=[n]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var a=r._parentOrParents;if(null===a)r._parentOrParents=this;else if(a instanceof e){if(a===this)return r;r._parentOrParents=[a,this]}else{if(-1!==a.indexOf(this))return r;a.push(this)}var i=this._subscriptions;return null===i?this._subscriptions=[r]:i.push(r),r},e.prototype.remove=function(e){var t=this._subscriptions;if(t){var r=t.indexOf(e);-1!==r&&t.splice(r,1)}},e.EMPTY=function(e){return e.closed=!0,e}(new e),e}();function A(e){return e.reduce((function(e,t){return e.concat(t instanceof O?t.errors:t)}),[])}var k=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),P=function(e){function t(r,n,a){var i=e.call(this)||this;switch(i.syncErrorValue=null,i.syncErrorThrown=!1,i.syncErrorThrowable=!1,i.isStopped=!1,arguments.length){case 0:i.destination=S;break;case 1:if(!r){i.destination=S;break}if("object"==typeof r){r instanceof t?(i.syncErrorThrowable=r.syncErrorThrowable,i.destination=r,r.add(i)):(i.syncErrorThrowable=!0,i.destination=new F(i,r));break}default:i.syncErrorThrowable=!0,i.destination=new F(i,r,n,a)}return i}return y(t,e),t.prototype[k]=function(){return this},t.create=function(e,r,n){var a=new t(e,r,n);return a.syncErrorThrowable=!1,a},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t.prototype._unsubscribeAndRecycle=function(){var e=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this},t}(T),F=function(e){function t(t,r,n,a){var i,o=e.call(this)||this;o._parentSubscriber=t;var s=o;return b(r)?i=r:r&&(i=r.next,n=r.error,a=r.complete,r!==S&&(b((s=Object.create(r)).unsubscribe)&&o.add(s.unsubscribe.bind(s)),s.unsubscribe=o.unsubscribe.bind(o))),o._context=s,o._next=i,o._error=n,o._complete=a,o}return y(t,e),t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;w.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}},t.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber,r=w.useDeprecatedSynchronousErrorHandling;if(this._error)r&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)r?(t.syncErrorValue=e,t.syncErrorThrown=!0):x(e),this.unsubscribe();else{if(this.unsubscribe(),r)throw e;x(e)}}},t.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var r=function(){return e._complete.call(e._context)};w.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,r),this.unsubscribe()):(this.__tryOrUnsub(r),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(e){if(this.unsubscribe(),w.useDeprecatedSynchronousErrorHandling)throw e;x(e)}},t.prototype.__tryOrSetError=function(e,t,r){if(!w.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,r)}catch(t){return w.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=t,e.syncErrorThrown=!0,!0):(x(t),!0)}return!1},t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()},t}(P);function N(e,t){return function(r){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return r.lift(new L(e,t))}}var L=function(){function e(e,t){this.project=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new R(e,this.project,this.thisArg))},e}(),R=function(e){function t(t,r,n){var a=e.call(this,t)||this;return a.project=r,a.count=0,a.thisArg=n||a,a}return y(t,e),t.prototype._next=function(e){var t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(P);function D(e,t){var r=(t=t||{}).delimiter||".",n=t.maxDepth||3,a=1,i={};return function e(o,s){Object.keys(o).forEach((function(l){var u=o[l],c=(null==t?void 0:t.safe)&&Array.isArray(u),d="[object Object]"===Object.prototype.toString.call(u),p=s?s+r+l:l;if((null==t?void 0:t.maxDepth)||(n=a+1),!c&&d&&Object.keys(u).length&&a<n)return++a,e(u,p);i[p]=u}))}(e,null),i}var $=function(e){return V[e.type].requiresField},C=function(e){return V[e.type].isPipelineAgg},j=function(e){return V[e.type].supportsMultipleBucketPaths},M=function(e){return V[e.type].hasSettings},V={count:{label:"Count",requiresField:!1,isPipelineAgg:!1,supportsMissing:!1,supportsMultipleBucketPaths:!1,hasSettings:!1,hasMeta:!1,supportsInlineScript:!1,defaults:{}},avg:{label:"Average",requiresField:!0,supportsInlineScript:!0,supportsMissing:!0,isPipelineAgg:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,hasMeta:!1,defaults:{}},sum:{label:"Sum",requiresField:!0,supportsInlineScript:!0,supportsMissing:!0,isPipelineAgg:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,hasMeta:!1,defaults:{}},max:{label:"Max",requiresField:!0,supportsInlineScript:!0,supportsMissing:!0,isPipelineAgg:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,hasMeta:!1,defaults:{}},min:{label:"Min",requiresField:!0,supportsInlineScript:!0,supportsMissing:!0,isPipelineAgg:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,hasMeta:!1,defaults:{}},extended_stats:{label:"Extended Stats",requiresField:!0,supportsMissing:!0,supportsInlineScript:!0,isPipelineAgg:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,hasMeta:!0,defaults:{meta:{std_deviation_bounds_lower:!0,std_deviation_bounds_upper:!0}}},percentiles:{label:"Percentiles",requiresField:!0,supportsMissing:!0,supportsInlineScript:!0,isPipelineAgg:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,hasMeta:!1,defaults:{settings:{percents:["25","50","75","95","99"]}}},cardinality:{label:"Unique Count",requiresField:!0,supportsMissing:!0,isPipelineAgg:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,supportsInlineScript:!1,hasMeta:!1,defaults:{}},moving_avg:{label:"Moving Average",requiresField:!0,isPipelineAgg:!0,supportsMissing:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,supportsInlineScript:!1,hasMeta:!1,defaults:{settings:{model:"simple",window:5}}},moving_fn:{label:"Moving Function",requiresField:!0,isPipelineAgg:!0,supportsMultipleBucketPaths:!1,supportsInlineScript:!1,supportsMissing:!1,hasMeta:!1,hasSettings:!0,defaults:{}},derivative:{label:"Derivative",requiresField:!0,isPipelineAgg:!0,supportsMissing:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,supportsInlineScript:!1,hasMeta:!1,defaults:{}},cumulative_sum:{label:"Cumulative Sum",requiresField:!0,isPipelineAgg:!0,supportsMissing:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,supportsInlineScript:!1,hasMeta:!1,defaults:{}},bucket_script:{label:"Bucket Script",requiresField:!1,isPipelineAgg:!0,supportsMissing:!1,supportsMultipleBucketPaths:!0,hasSettings:!0,supportsInlineScript:!1,hasMeta:!1,defaults:{pipelineVariables:[{name:"var1",pipelineAgg:""}]}},raw_document:{label:"Raw Document (legacy)",requiresField:!1,isSingleMetric:!0,isPipelineAgg:!1,supportsMissing:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,supportsInlineScript:!1,hasMeta:!1,defaults:{settings:{size:"500"}}},raw_data:{label:"Raw Data",requiresField:!1,isSingleMetric:!0,isPipelineAgg:!1,supportsMissing:!1,supportsMultipleBucketPaths:!1,hasSettings:!0,supportsInlineScript:!1,hasMeta:!1,defaults:{settings:{size:"500"}}},logs:{label:"Logs",requiresField:!1,isPipelineAgg:!1,supportsMissing:!1,supportsMultipleBucketPaths:!1,hasSettings:!1,supportsInlineScript:!1,hasMeta:!1,defaults:{}}},q={moving_avg:[{label:"window",default:5},{label:"model",default:"simple"},{label:"predict"},{label:"minimize",default:!1}],moving_fn:[{label:"window",default:5},{label:"script"}],derivative:[{label:"unit"}],cumulative_sum:[{label:"format"}],bucket_script:[]},B=[{label:"Avg",value:"avg"},{label:"Min",value:"min"},{label:"Max",value:"max"},{label:"Sum",value:"sum"},{label:"Count",value:"count"},{label:"Std Dev",value:"std_deviation"},{label:"Std Dev Upper",value:"std_deviation_bounds_upper"},{label:"Std Dev Lower",value:"std_deviation_bounds_lower"}],Q=[{label:"Simple",value:"simple"},{label:"Linear",value:"linear"},{label:"Exponentially Weighted",value:"ewma"},{label:"Holt Linear",value:"holt"},{label:"Holt Winters",value:"holt_winters"}];function G(e){return void 0===e&&(e="1"),{type:"count",id:e}}function U(e){return void 0===e&&(e="1"),{type:"date_histogram",id:e,settings:{interval:"auto"}}}var z=function(e,t){return e.find((function(e){return e.id===t}))};var H,W=function(){function e(e){var t,r,n,a;if(this.columns=[],this.columnMap={},this.rows=[],this.type="table",e){if(e.columns)try{for(var i=c(e.columns),o=i.next();!o.done;o=i.next()){var s=o.value;this.addColumn(s)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}if(e.rows)try{for(var l=c(e.rows),u=l.next();!u.done;u=l.next()){var d=u.value;this.addRow(d)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(a=l.return)&&a.call(l)}finally{if(n)throw n.error}}}}return e.prototype.sort=function(e){null===e.col||this.columns.length<=e.col||(this.rows.sort((function(t,r){return+(null==(t=t[e.col]))-+(null==(r=r[e.col]))||+(t>r)||-(t<r)})),e.desc&&this.rows.reverse(),this.columns[e.col].sort=!0,this.columns[e.col].desc=e.desc)},e.prototype.addColumn=function(e){this.columnMap[e.text]||(this.columns.push(e),this.columnMap[e.text]=e)},e.prototype.addRow=function(e){this.rows.push(e)},e}(),Y=W;function X(e){return(X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e){e.Lucene="lucene",e.PPL="PPL"}(H||(H={}));var J=function(e){return $(e)?V[e.type].label+" "+e.field:V[e.type].label},Z=function e(t){return Object.entries(t).reduce((function(t,r){var n,a,i=d(r,2),s=i[0],l=i[1];if(null==l)return o({},t);if(Array.isArray(l)&&0===l.length)return o({},t);if(0===(null==l?void 0:l.length))return o({},t);if(!Array.isArray(l)&&"object"===X(l)){var u=e(l);return 0===Object.keys(u).length?o({},t):o(o({},t),((n={})[s]=u,n))}return o(o({},t),((a={})[s]=l,a))}),{})},K=function(){function e(e,t,r){var n=this;void 0===r&&(r=H.Lucene),this.targets=e,this.response=t,this.targetType=r,this.processResponseToSeries=function(){for(var e,t=[],r=0;r<n.response.responses.length;r++){var a=n.response.responses[r],i=n.targets[r];if(a.error)throw n.getErrorFromResponse(n.response,a.error);if(a.hits&&a.hits.hits.length>0&&n.processHits(a.hits,t,i),a.aggregations){var o=a.aggregations,s=n.targets[r],l=[],u=new Y;u.refId=s.refId,n.processBuckets(o,s,l,u,{},0),n.trimDatapoints(l,s),n.nameSeries(l,s);for(var c=0;c<l.length;c++)t.push(l[c]);u.rows.length>0&&t.push(u)}}return{data:t,key:null===(e=n.targets[0])||void 0===e?void 0:e.refId}},this.processPPLResponseToSeries=function(){var e,t=n.targets[0],r=n.response,a=[];if(r.datarows.length>0){if(r.error)throw n.getErrorFromResponse(n.response,r.error);var i=re(r),o=i.datapoints,s=i.targetVal;if(i.invalidTS)throw n.getInvalidPPLQuery(n.response);var l={datapoints:o,props:r.schema,refId:t.refId,target:s};a.push(l)}return{data:a,key:null===(e=n.targets[0])||void 0===e?void 0:e.refId}},this.targets=e,this.response=t,this.targetType=r}return e.prototype.processMetrics=function(e,t,r,n){for(var a,i=0;i<t.metrics.length;i++){var o=t.metrics[i];if(!o.hide)switch(o.type){case"count":a={datapoints:[],metric:"count",props:n,refId:t.refId};for(var s=0;s<e.buckets.length;s++){var l=(h=e.buckets[s]).doc_count;a.datapoints.push([l,h.key])}r.push(a);break;case"percentiles":if(0===e.buckets.length)break;var u=e.buckets[0][o.id].values;for(var c in u){a={datapoints:[],metric:"p"+c,props:n,field:o.field,refId:t.refId};for(s=0;s<e.buckets.length;s++){var d=(h=e.buckets[s])[o.id].values;a.datapoints.push([d[c],h.key])}r.push(a)}break;case"extended_stats":for(var p in o.meta)if(o.meta[p]){a={datapoints:[],metric:p,props:n,field:o.field,refId:t.refId};for(s=0;s<e.buckets.length;s++){var f=(h=e.buckets[s])[o.id];f.std_deviation_bounds_upper=f.std_deviation_bounds.upper,f.std_deviation_bounds_lower=f.std_deviation_bounds.lower,a.datapoints.push([f[p],h.key])}r.push(a)}break;default:a={datapoints:[],metric:o.type,metricId:o.id,props:n,refId:t.refId},$(o)&&(a.field=o.field);for(s=0;s<e.buckets.length;s++){var h;void 0!==(l=(h=e.buckets[s])[o.id])&&(l.normalized_value?a.datapoints.push([l.normalized_value,h.key]):a.datapoints.push([l.value,h.key]))}r.push(a)}}},e.prototype.processAggregationDocs=function(e,t,r,n,a){var i,o,s,l,u,d,p,f,h;if(0===n.columns.length){try{for(var g=c(m.a.keys(a)),v=g.next();!v.done;v=g.next()){var y=v.value;n.addColumn({text:y,filterable:!0})}}catch(e){i={error:e}}finally{try{v&&!v.done&&(o=g.return)&&o.call(g)}finally{if(i)throw i.error}}n.addColumn({text:t.field,filterable:!0})}var b=function(e,t,r){n.addColumn({text:t}),e.push(r)},E=m.a.isArray(e.buckets)?e.buckets:[e.buckets];try{for(var w=c(E),x=w.next();!x.done;x=w.next()){var S=x.value,_=[];try{for(var I=(u=void 0,c(m.a.values(a))),O=I.next();!O.done;O=I.next()){var T=O.value;_.push(T)}}catch(e){u={error:e}}finally{try{O&&!O.done&&(d=I.return)&&d.call(I)}finally{if(u)throw u.error}}_.push(S.key);try{for(var A=(p=void 0,c(r.metrics||[])),k=A.next();!k.done;k=A.next()){var P=k.value;switch(P.type){case"count":b(_,this.getMetricName(P.type),S.doc_count);break;case"extended_stats":for(var F in P.meta)if(P.meta[F]){var N=S[P.id];N.std_deviation_bounds_upper=N.std_deviation_bounds.upper,N.std_deviation_bounds_lower=N.std_deviation_bounds.lower,b(_,this.getMetricName(F),N[F])}break;case"percentiles":var L=S[P.id].values;for(var R in L)b(_,"p"+R+" "+P.field,L[R]);break;default:var D=this.getMetricName(P.type);m.a.filter(r.metrics,{type:P.type}).length>1&&($(P)&&(D+=" "+P.field),"bucket_script"===P.type&&(D=(null===(h=P.settings)||void 0===h?void 0:h.script)||"")),b(_,D,S[P.id].value)}}}catch(e){p={error:e}}finally{try{k&&!k.done&&(f=A.return)&&f.call(A)}finally{if(p)throw p.error}}n.rows.push(_)}}catch(e){s={error:e}}finally{try{x&&!x.done&&(l=w.return)&&l.call(w)}finally{if(s)throw s.error}}},e.prototype.processBuckets=function(e,t,r,n,a,i){var o,s,l,u,c=t.bucketAggs.length-1;for(u in e)if(s=m.a.find(t.bucketAggs,{id:u}),l=e[u],s)if(i===c)"date_histogram"===s.type?this.processMetrics(l,t,r,a):this.processAggregationDocs(l,s,t,n,a);else for(var d in l.buckets)o=l.buckets[d],a=m.a.clone(a),void 0!==o.key?a[s.field]=o.key:a.filter=d,o.key_as_string&&(a[s.field]=o.key_as_string),this.processBuckets(o,t,r,n,a,i+1)},e.prototype.getMetricName=function(e){var t=Object.entries(V).filter((function(t){return d(t,1)[0]===e})).map((function(e){var t=d(e,2);t[0];return t[1]}))[0];if(t)return t.label;var r=B.find((function(t){return t.value===e}));return r?r.label:e},e.prototype.getSeriesName=function(e,t,r){var n,a,i=this.getMetricName(e.metric);if(t.alias){return t.alias.replace(/\{\{([\s\S]+?)\}\}/g,(function(t,r,n){var a=r||n;return 0===a.indexOf("term ")?e.props[a.substring(5)]:void 0!==e.props[a]?e.props[a]:"metric"===a?i:"field"===a?e.field||"":t}))}if(e.metric in q)if(e.metric&&function(e){return!!V[e].supportsMultipleBucketPaths}(e.metric)){var o=m.a.find(t.metrics,{id:e.metricId});if(o&&o.settings.script){i=o.settings.script;try{for(var s=c(o.pipelineVariables),l=s.next();!l.done;l=s.next()){var u=l.value;(d=m.a.find(t.metrics,{id:u.pipelineAgg}))&&(i=i.replace("params."+u.name,J(d)))}}catch(e){n={error:e}}finally{try{l&&!l.done&&(a=s.return)&&a.call(s)}finally{if(n)throw n.error}}}else i="Unset"}else{var d;(d=m.a.find(t.metrics,{id:e.field}))?i+=" "+J(d):i="Unset"}else e.field&&(i+=" "+e.field);if(0===m.a.keys(e.props).length)return i;var p="";for(var f in e.props)p+=e.props[f]+" ";return 1===r?p.trim():p.trim()+" "+i},e.prototype.nameSeries=function(e,t){for(var r=m.a.uniq(m.a.map(e,"metric")).length,n=0;n<e.length;n++){var a=e[n];a.target=this.getSeriesName(a,t,r)}},e.prototype.processHits=function(e,t,r){var n,a,i,o,s="number"==typeof e.total?e.total:e.total.value,l={target:r.refId,type:"docs",refId:r.refId,datapoints:[],total:s,filterable:!0};for(o=0;o<e.hits.length;o++){if(i={_id:(a=e.hits[o])._id,_type:a._type,_index:a._index},a._source)for(n in a._source)i[n]=a._source[n];for(n in a.fields)i[n]=a.fields[n];l.datapoints.push(i)}t.push(l)},e.prototype.trimDatapoints=function(e,t){var r=m.a.find(t.bucketAggs,{type:"date_histogram"});if(r&&r.settings&&r.settings.trimEdges){var n=r.settings.trimEdges;for(var a in e){var i=e[a];i.datapoints.length>2*n&&(i.datapoints=i.datapoints.slice(n,i.datapoints.length-n))}}},e.prototype.getErrorFromResponse=function(e,t){var r={};return r.data=JSON.stringify(t,null,4),t.root_cause&&t.root_cause.length>0&&t.root_cause[0].reason?r.message=t.root_cause[0].reason:r.message=t.reason||"Unknown OpenSearch error response",e.$$config&&(r.config=e.$$config),r},e.prototype.getInvalidPPLQuery=function(e){var t={message:"Invalid time series query"};return e.$$config&&(t.config=e.$$config),t},e.prototype.getTimeSeries=function(){return this.targetType===H.PPL?this.processPPLResponseToSeries():this.targets.some((function(e){var t;return null===(t=e.metrics)||void 0===t?void 0:t.some((function(e){return"raw_data"===e.type}))}))?this.processResponseToDataFrames(!1):this.processResponseToSeries()},e.prototype.getLogs=function(e,t){return this.targetType===H.PPL?this.processPPLResponseToDataFrames(!0,e,t):this.processResponseToDataFrames(!0,e,t)},e.prototype.getTable=function(){return this.processPPLResponseToDataFrames(!1)},e.prototype.processResponseToDataFrames=function(e,t,r){for(var a,i,o,s=[],l=0;l<this.response.responses.length;l++){var u=this.response.responses[l];if(u.error)throw this.getErrorFromResponse(this.response,u.error);if(u.hits&&u.hits.hits.length>0){var d=ee(u.hits.hits),p=d.propNames,f=d.docs;if(f.length>0){var h=ne(p,this.targets[0].timeField,e,this.targetType,t,r);try{for(var m=(a=void 0,c(f)),g=m.next();!g.done;g=m.next()){var v=g.value;r&&(v.level=v[r]),h.add(v)}}catch(e){a={error:e}}finally{try{g&&!g.done&&(i=m.return)&&i.call(m)}finally{if(a)throw a.error}}e&&(h=ae(h,"logs"));var y=this.targets[l];h.refId=y.refId,s.push(h)}}if(u.aggregations){var b=u.aggregations,E=(y=this.targets[l],[]),w=new Y;if(this.processBuckets(b,y,E,w,{},0),this.trimDatapoints(E,y),this.nameSeries(E,y),w.rows.length>0)(h=Object(n.toDataFrame)(w)).refId=y.refId,s.push(h);for(var x=0;x<E.length;x++){h=Object(n.toDataFrame)(E[x]);e&&(h=ae(h,"graph")),h.refId=y.refId,s.push(h)}}}return{data:s,key:null===(o=this.targets[0])||void 0===o?void 0:o.refId}},e.prototype.processPPLResponseToDataFrames=function(e,t,r){var n,a,i;if(this.response.error)throw this.getErrorFromResponse(this.response,this.response.error);var o=[],s=this.response.schema.map((function(e){return e.name})),l=m.a.map(this.response.datarows,(function(e){return m.a.zipObject(s,e)})),u=te(l),d=u.flattenSchema,p=u.docs;if(l.length>0){var f=ne(d,this.targets[0].timeField,e,this.targetType,t,r);try{for(var h=c(p),g=h.next();!g.done;g=h.next()){var v=g.value;r&&(v.level=v[r]),f.add(v)}}catch(e){n={error:e}}finally{try{g&&!g.done&&(a=h.return)&&a.call(h)}finally{if(n)throw n.error}}e&&(f=ae(f,"logs"));var y=this.targets[0];f.refId=y.refId,o.push(f)}return{data:o,key:null===(i=this.targets[0])||void 0===i?void 0:i.refId}},e}(),ee=function(e){var t,r,n,a,i=[],s=[];try{for(var l=c(e),u=l.next();!u.done;u=l.next()){var d=u.value,p=d._source?D(d._source):{},f=o({_id:d._id,_type:d._type,_index:d._index,_source:o({},p)},p);try{for(var h=(n=void 0,c(Object.keys(f))),m=h.next();!m.done;m=h.next()){var g=m.value;-1===s.indexOf(g)&&s.push(g)}}catch(e){n={error:e}}finally{try{m&&!m.done&&(a=h.return)&&a.call(h)}finally{if(n)throw n.error}}i.push(f)}}catch(e){t={error:e}}finally{try{u&&!u.done&&(r=l.return)&&r.call(l)}finally{if(t)throw t.error}}return s.sort(),{docs:i,propNames:s}},te=function(e){var t,r,n,a,i=[],o=[];try{for(var s=c(e),l=s.next();!l.done;l=s.next()){var u=D(l.value);try{for(var d=(n=void 0,c(Object.keys(u))),p=d.next();!p.done;p=d.next()){var f=p.value;-1===o.indexOf(f)&&o.push(f)}}catch(e){n={error:e}}finally{try{p&&!p.done&&(a=d.return)&&a.call(d)}finally{if(n)throw n.error}}i.push(u)}}catch(e){t={error:e}}finally{try{l&&!l.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}return{docs:i,flattenSchema:o}},re=function(e){var t,r=!1,a=m.a.findIndex(e.schema,(function(e){return"timestamp"===e.type||"datetime"===e.type||"date"===e.type})),i=0===a?1:0;return-1!==a&&2===e.datarows[0].length&&"number"==typeof e.datarows[0][i]||(r=!0),{datapoints:m.a.map(e.datarows,(function(e){var t=m.a.clone(e),r=d(t.splice(a,1),1)[0];return t.push(1e3*Object(n.dateTime)(r).unix()),t})),targetVal:null===(t=e.schema[i])||void 0===t?void 0:t.name,invalidTS:r}},ne=function(e,t,r,a,i,o){var s,l,u=new n.MutableDataFrame({fields:[]});(a===H.Lucene||r)&&u.addField({config:{filterable:!0},name:t,type:n.FieldType.time}),i&&(u.addField({name:i,type:n.FieldType.string}).parse=function(e){return e||""}),o&&(u.addField({name:"level",type:n.FieldType.string}).parse=function(e){return e||""});var d=u.fields.map((function(e){return e.name}));try{for(var p=c(e),f=p.next();!f.done;f=p.next()){var h=f.value;d.includes(h)||(r||"_source"!==h)&&(u.addField({config:{filterable:!0},name:h,type:n.FieldType.string}).parse=function(e){return e||""})}}catch(e){s={error:e}}finally{try{f&&!f.done&&(l=p.return)&&l.call(p)}finally{if(s)throw s.error}}return u},ae=function(e,t){var r=e;return r.meta?r.meta.preferredVisualisationType=t:r.meta={preferredVisualisationType:t},r},ie={Hourly:{startOf:"hour",amount:"hours"},Daily:{startOf:"day",amount:"days"},Weekly:{startOf:"isoWeek",amount:"weeks"},Monthly:{startOf:"month",amount:"months"},Yearly:{startOf:"year",amount:"years"}},oe=function(){function e(e,t){this.pattern=e,this.interval=t,this.dateLocale="en"}return e.prototype.getIndexForToday=function(){return this.interval?Object(n.toUtc)().locale(this.dateLocale).format(this.pattern):this.pattern},e.prototype.getIndexList=function(e,t){if(!this.interval)return this.pattern;for(var r=ie[this.interval],a=Object(n.dateTime)(e||Object(n.dateTime)(t).add(-7,r.amount)).utc().startOf(r.startOf),i=Object(n.dateTime)(t||Object(n.dateTime)(e).add(7,r.amount)).utc().startOf(r.startOf).valueOf(),o=[];a.valueOf()<=i;)o.push(a.locale(this.dateLocale).format(this.pattern)),a.add(1,r.amount);return o},e.prototype.getPPLIndexPattern=function(){if(!this.interval)return this.pattern;var e=this.pattern.match(/\[(.*?)\]/)[1];return this.pattern.startsWith("[")?e+="*":this.pattern.endsWith("]")&&(e="*"+e),e},e}(),se=function(){function e(e){this.timeField=e.timeField,this.version=e.version}return e.prototype.getRangeFilter=function(){var e={};return e[this.timeField]={gte:"$timeFrom",lte:"$timeTo",format:"epoch_millis"},e},e.prototype.buildTermsAgg=function(e,t,r){var n,a,i,o;if(t.terms={field:e.field},!e.settings)return t;var s=(null===(i=e.settings)||void 0===i?void 0:i.size)?parseInt(e.settings.size,10):500;if(t.terms.size=0===s?500:s,void 0!==e.settings.orderBy&&(t.terms.order={},"_term"===e.settings.orderBy?t.terms.order._key=e.settings.order:t.terms.order[e.settings.orderBy]=e.settings.order,o=parseInt(e.settings.orderBy,10),!isNaN(o)))try{for(var l=c(r.metrics||[]),u=l.next();!u.done;u=l.next()){var d=u.value;if(d.id===e.settings.orderBy){t.aggs={},t.aggs[d.id]={},$(d)&&(t.aggs[d.id][d.type]={field:d.field});break}}}catch(e){n={error:e}}finally{try{u&&!u.done&&(a=l.return)&&a.call(l)}finally{if(n)throw n.error}}return void 0!==e.settings.min_doc_count&&(t.terms.min_doc_count=parseInt(e.settings.min_doc_count,10),isNaN(t.terms.min_doc_count)&&(t.terms.min_doc_count=e.settings.min_doc_count)),e.settings.missing&&(t.terms.missing=e.settings.missing),t},e.prototype.getDateHistogramAgg=function(e){var t={},r=e.settings||{};return t.interval=r.interval,t.field=this.timeField,t.min_doc_count=r.min_doc_count||0,t.extended_bounds={min:"$timeFrom",max:"$timeTo"},t.format="epoch_millis",""!==r.offset&&(t.offset=r.offset),"auto"===t.interval&&(t.interval="$__interval"),t},e.prototype.getHistogramAgg=function(e){var t={},r=e.settings||{};return t.interval=r.interval,t.field=e.field,t.min_doc_count=r.min_doc_count||0,t},e.prototype.getFiltersAgg=function(e){var t,r,n,a={};try{for(var i=c((null===(n=e.settings)||void 0===n?void 0:n.filters)||[]),o=i.next();!o.done;o=i.next()){var s=o.value,l=s.query;a[s.label||l]={query_string:{query:l,analyze_wildcard:!0}}}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return a},e.prototype.documentQuery=function(e,t){return e.size=t,e.sort={},e.sort[this.timeField]={order:"desc",unmapped_type:"boolean"},e.script_fields={},e},e.prototype.addAdhocFilters=function(e,t){var r,n,a,i;if(t)for(r=0;r<t.length;r++)switch((a={})[(n=t[r]).key]=n.value,(i={})[n.key]={query:n.value},n.operator){case"=":e.query.bool.must||(e.query.bool.must=[]),e.query.bool.must.push({match_phrase:i});break;case"!=":e.query.bool.must_not||(e.query.bool.must_not=[]),e.query.bool.must_not.push({match_phrase:i});break;case"<":a[n.key]={lt:n.value},e.query.bool.filter.push({range:a});break;case">":a[n.key]={gt:n.value},e.query.bool.filter.push({range:a});break;case"=~":e.query.bool.filter.push({regexp:a});break;case"!~":e.query.bool.filter.push({bool:{must_not:{regexp:a}}})}},e.prototype.build=function(e,t,r){var n,a,i,s,l,u,c,d,p,f,h;e.metrics=e.metrics||[G()],e.bucketAggs=e.bucketAggs||[U()],e.timeField=this.timeField,e.queryType=H.Lucene;var m={size:0,query:{bool:{filter:[{range:this.getRangeFilter()},{query_string:{analyze_wildcard:!0,query:r}}]}}};if(this.addAdhocFilters(m,t),0===e.bucketAggs.length&&(!(h=e.metrics[0])||"raw_document"!==h.type&&"raw_data"!==h.type))throw{message:"Invalid query"};if("raw_document"===(null===(a=null===(n=e.metrics)||void 0===n?void 0:n[0])||void 0===a?void 0:a.type)||"raw_data"===(null===(s=null===(i=e.metrics)||void 0===i?void 0:i[0])||void 0===s?void 0:s.type)){var g=(null===(l=(h=e.metrics[0]).settings)||void 0===l?void 0:l.size)?parseInt(h.settings.size,10):500;return this.documentQuery(m,g||500)}for(f=m,c=0;c<e.bucketAggs.length;c++){var v=e.bucketAggs[c],y={};switch(v.type){case"date_histogram":y.date_histogram=this.getDateHistogramAgg(v);break;case"histogram":y.histogram=this.getHistogramAgg(v);break;case"filters":y.filters={filters:this.getFiltersAgg(v)};break;case"terms":this.buildTermsAgg(v,y,e);break;case"geohash_grid":y.geohash_grid={field:v.field,precision:null===(u=v.settings)||void 0===u?void 0:u.precision}}f.aggs=f.aggs||{},f.aggs[v.id]=y,f=y}for(f.aggs={},c=0;c<e.metrics.length;c++)if("count"!==(h=e.metrics[c]).type){var b={},E=null;if(C(h))if(j(h)){if(!h.pipelineVariables)continue;for(E={buckets_path:{}},d=0;d<h.pipelineVariables.length;d++){if((p=h.pipelineVariables[d]).name&&p.pipelineAgg&&/^\d*$/.test(p.pipelineAgg))(w=z(e.metrics,p.pipelineAgg))&&("count"===w.type?E.buckets_path[p.name]="_count":E.buckets_path[p.name]=p.pipelineAgg)}}else{if(!h.field||!/^\d*$/.test(h.field))continue;var w;(w=z(e.metrics,h.field))&&(E="count"===w.type?{buckets_path:"_count"}:{buckets_path:h.field})}else $(h)&&(E={field:h.field});E=o(o({},E),M(h)&&h.settings),b[h.type]=E,f.aggs[h.id]=b}return m},e.prototype.getTermsQuery=function(e){var t={size:0,query:{bool:{filter:[{range:this.getRangeFilter()}]}}};e.query&&t.query.bool.filter.push({query_string:{analyze_wildcard:!0,query:e.query}});var r=500;e.size&&(r=e.size),t.aggs={1:{terms:{field:e.field,size:r,order:{}}}};var n=e.orderBy,a=void 0===n?"key":n,i=e.order,o=void 0===i?"doc_count"===a?"desc":"asc":i;if(["asc","desc"].indexOf(o)<0)throw{message:"Invalid query sort order "+o};switch(a){case"key":case"term":t.aggs[1].terms.order._key=o;break;case"doc_count":t.aggs[1].terms.order._count=o;break;default:throw{message:"Invalid query sort type "+a}}return t},e.prototype.getLogsQuery=function(e,t,r){var n={size:0,query:{bool:{filter:[{range:this.getRangeFilter()}]}}};return this.addAdhocFilters(n,t),e.query&&n.query.bool.filter.push({query_string:{analyze_wildcard:!0,query:r}}),n=this.documentQuery(n,500),o(o({},n),{aggs:this.build(e,null,r).aggs})},e.prototype.addPPLAdhocFilters=function(e,t){var r,a,i;for(r=0;r<t.length;r++){if(n.dateMath.isValid(t[r].value))a="timestamp('"+Object(n.dateTime)(t[r].value).format("YYYY-MM-DD HH:mm:ss.SSSSSS")+"')";else a="string"==typeof t[r].value?"'"+t[r].value+"'":t[r].value;i="`"+t[r].key+"` "+t[r].operator+" "+a,e+=r>0?" and "+i:" | where "+i}return e},e.prototype.buildPPLQuery=function(e,t,r){e.format=e.format||"table",e.queryType=H.PPL,e.isLogsQuery="logs"===e.format,t&&(r=this.addPPLAdhocFilters(r,t));var n=" where $timestamp >= timestamp('$timeFrom') and $timestamp <= timestamp('$timeTo')";if(r){var a=r.indexOf("|");r=-1===a?[r.trimEnd(),n].join(" |"):[r.slice(0,a).trimEnd(),n,r.slice(a+1)].join(" |")}return{query:r}},e}(),le=r(4),ue={terms:{label:"Terms",requiresField:!0,defaultSettings:{min_doc_count:"0",size:"10",order:"desc",orderBy:"_term"}},filters:{label:"Filters",requiresField:!1,defaultSettings:{filters:[{label:"",query:"*"}]}},geohash_grid:{label:"Geo Hash Grid",requiresField:!0,defaultSettings:{precision:"3"}},date_histogram:{label:"Date Histogram",requiresField:!0,defaultSettings:{interval:"auto",min_doc_count:"0",trimEdges:"0"}},histogram:{label:"Histogram",requiresField:!0,defaultSettings:{interval:"1000",min_doc_count:"0"}}},ce=[{label:"Top",value:"desc"},{label:"Bottom",value:"asc"}],de=[{label:"No limit",value:"0"},{label:"1",value:"1"},{label:"2",value:"2"},{label:"3",value:"3"},{label:"5",value:"5"},{label:"10",value:"10"},{label:"15",value:"15"},{label:"20",value:"20"}],pe=[{label:"Term value",value:"_term"},{label:"Doc Count",value:"_count"}],fe=[{label:"auto",value:"auto"},{label:"10s",value:"10s"},{label:"1m",value:"1m"},{label:"5m",value:"5m"},{label:"10m",value:"10m"},{label:"20m",value:"20m"},{label:"1h",value:"1h"},{label:"1d",value:"1d"}],he=function(e){return ue[e.type].requiresField};function me(e){return(me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var ge=["_index","_type","_id","_source","_size","_field_names","_ignored","_routing","_meta"],ve=function(e){function t(t){var r,n,a=e.call(this,t)||this;a.basicAuth=t.basicAuth,a.withCredentials=t.withCredentials,a.url=t.url,a.name=t.name;var i=t.jsonData||{};return a.index=null!==(r=i.database)&&void 0!==r?r:"",a.timeField=i.timeField,a.version=i.version,a.indexPattern=new oe(a.index,i.interval),a.interval=i.timeInterval,a.maxConcurrentShardRequests=i.maxConcurrentShardRequests,a.queryBuilder=new se({timeField:a.timeField,version:a.version}),a.logMessageField=i.logMessageField||"",a.logLevelField=i.logLevelField||"",a.dataLinks=i.dataLinks||[],""===a.logMessageField&&(a.logMessageField=void 0),""===a.logLevelField&&(a.logLevelField=void 0),a.pplEnabled=null===(n=i.pplEnabled)||void 0===n||n,a}return i(t,e),t.prototype.request=function(e,t,r){var n={url:this.url+"/"+t,method:e,data:r};return(this.basicAuth||this.withCredentials)&&(n.withCredentials=!0),this.basicAuth&&(n.headers={Authorization:this.basicAuth}),Object(le.getBackendSrv)().datasourceRequest(n).catch((function(e){if(e.data&&e.data.error)throw{message:"OpenSearch error: "+e.data.error.reason+". "+e.data.error.details,error:e.data.error};throw e}))},t.prototype.get=function(e,t){void 0===t&&(t=Object(n.getDefaultTimeRange)());var r=this.indexPattern.getIndexList(t.from,t.to);return m.a.isArray(r)&&r.length?this.requestAllIndices(r,e).then((function(e){return e.data.$$config=e.config,e.data})):this.request("GET",this.indexPattern.getIndexForToday()+e).then((function(e){return e.data.$$config=e.config,e.data}))},t.prototype.requestAllIndices=function(e,t){return l(this,void 0,Promise,(function(){var r,n,a,i;return u(this,(function(o){switch(o.label){case 0:r=7,n=e.length,a=0,o.label=1;case 1:if(!(a<Math.min(n,r)))return[3,6];o.label=2;case 2:return o.trys.push([2,4,,5]),[4,this.request("GET",e[n-a-1]+t)];case 3:return[2,o.sent()];case 4:if(404!==(i=o.sent()).status||a===r-1)throw i;return[3,5];case 5:return a++,[3,1];case 6:return[2]}}))}))},t.prototype.post=function(e,t){return this.request("POST",e,t).then((function(e){return e.data.$$config=e.config,e.data}))},t.prototype.annotationQuery=function(e){var t=e.annotation,r=t.timeField||"@timestamp",a=t.timeEndField||null,i=t.query||"*",o=t.tagsField||"tags",s=t.textField||null,l=[],u={};if(u[r]={from:e.range.from.valueOf(),to:e.range.to.valueOf(),format:"epoch_millis"},l.push({range:u}),a){var c={};c[a]={from:e.range.from.valueOf(),to:e.range.to.valueOf(),format:"epoch_millis"},l.push({range:c})}var d={query:{bool:{filter:[{bool:{should:l,minimum_should_match:1}},{query_string:{query:Object(le.getTemplateSrv)().replace(i,{},"lucene")}}]}},size:1e4},p={search_type:"query_then_fetch",ignore_unavailable:!0};t.index?p.index=t.index:p.index=this.indexPattern.getIndexList(e.range.from,e.range.to);var f=JSON.stringify(p)+"\n"+JSON.stringify(d)+"\n";return this.post("_msearch",f).then((function(e){for(var i=[],l=e.responses[0].hits.hits,u=function(e,t){if(t){for(var r=t.split("."),n=e,a=0;a<r.length;a++)if(!(n=n[r[a]]))return"";return n}},c=0;c<l.length;c++){var d=l[c]._source,p=u(d,r);if(void 0!==l[c].fields){var f=l[c].fields;(m.a.isString(f[r])||m.a.isNumber(f[r]))&&(p=f[r])}var h={annotation:t,time:Object(n.toUtc)(p).valueOf(),text:u(d,s),tags:u(d,o)};if(a){var g=u(d,a);g&&(h.timeEnd=Object(n.toUtc)(g).valueOf())}if(t.titleField){var v=u(d,t.titleField);v&&(h.text=v+"\n"+h.text)}"string"==typeof h.tags&&(h.tags=h.tags.split(",")),i.push(h)}return i}))},t.prototype.interpolateLuceneQuery=function(e,t){return Object(le.getTemplateSrv)().replace(e,t,"lucene")||"*"},t.prototype.interpolatePPLQuery=function(e,t){return Object(le.getTemplateSrv)().replace(e,t,"pipe")},t.prototype.interpolateVariablesInQueries=function(e,t){var r=this,n=e;return e&&e.length>0&&(n=e.map((function(e){var n,a,i,s,l,u;u=e.queryType===H.PPL?r.interpolatePPLQuery(e.query||"",t):r.interpolateLuceneQuery(e.query||"",t);var d=o(o({},e),{datasource:r.name,query:u});try{for(var p=c(e.bucketAggs||[]),f=p.next();!f.done;f=p.next()){var h=f.value;if("filters"===h.type)try{for(var m=(i=void 0,c((null===(l=h.settings)||void 0===l?void 0:l.filters)||[])),g=m.next();!g.done;g=m.next()){var v=g.value;v.query=r.interpolateLuceneQuery(v.query,t)}}catch(e){i={error:e}}finally{try{g&&!g.done&&(s=m.return)&&s.call(m)}finally{if(i)throw i.error}}}}catch(e){n={error:e}}finally{try{f&&!f.done&&(a=p.return)&&a.call(p)}finally{if(n)throw n.error}}return d}))),n},t.prototype.testDatasource=function(){var e=this;return this.getFields("date").then((function(t){return m.a.find(t,{text:e.timeField})?{status:"success",message:"Index OK. Time field name OK."}:{status:"error",message:"No date field named "+e.timeField+" found"}}),(function(e){return e.message?{status:"error",message:e.message}:{status:"error",message:e.status}}))},t.prototype.getQueryHeader=function(e,t,r){var n={search_type:e,ignore_unavailable:!0,index:this.indexPattern.getIndexList(t,r)};return JSON.stringify(n)},t.prototype.getQueryDisplayText=function(e){var t=e.metrics,r=e.bucketAggs,n="";return e.query&&(n+="Query: "+e.query+", "),n+="Metrics: ",n+=null==t?void 0:t.reduce((function(e,t){var r,n,a=V[t.type].label+"(";return $(t)&&(a+=t.field),j(t)&&(a+=null===(n=null===(r=t.settings)||void 0===r?void 0:r.script)||void 0===n?void 0:n.replace(new RegExp("params.","g"),"")),e+" "+(a+="), ")}),""),n+=null==r?void 0:r.reduce((function(e,t,r){var n="";return 0===r&&(n+=" Group by: "),n+=ue[t.type].label+"(",he(t)&&(n+=t.field),e+" "+n+"), "}),""),e.alias&&(n+="Alias: "+e.alias),n},t.prototype.query=function(e){var t,r,a=this.interpolateVariablesInQueries(m.a.cloneDeep(e.targets),e.scopedVars),i=[],o=[];try{for(var s=c(a),l=s.next();!l.done;l=s.next()){var u=l.value;if(!u.hide)switch(u.queryType){case H.PPL:o.push(u);break;case H.Lucene:default:i.push(u)}}}catch(e){t={error:e}}finally{try{l&&!l.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}var f=[];if(i.length){var h=this.executeLuceneQueries(i,e);f.push(h)}if(o.length){var v=this.executePPLQueries(o,e);f.push(v)}return 0===f.length?Object(g.of)({data:[],state:n.LoadingState.Done}):g.merge.apply(void 0,p([],d(f)))},t.prototype.executeLuceneQueries=function(e,t){var r,n,a=this,i="";try{for(var o=c(e),s=o.next();!s.done;s=o.next()){var l=s.value;i+=this.createLuceneQuery(l,t)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i=(i=i.replace(/"\$timeFrom"/g,t.range.from.valueOf().toString())).replace(/"\$timeTo"/g,t.range.to.valueOf().toString()),i=Object(le.getTemplateSrv)().replace(i,t.scopedVars),Object(g.from)(this.post(this.getMultiSearchUrl(),i)).pipe(N((function(t){var r,n,i=new K(e,t);if(e.some((function(e){return e.isLogsQuery}))){var o=i.getLogs(a.logMessageField,a.logLevelField);try{for(var s=c(o.data),l=s.next();!l.done;l=s.next()){ye(l.value,a.dataLinks)}}catch(e){r={error:e}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return o}return i.getTimeSeries()})))},t.prototype.executePPLQueries=function(e,t){var r,a,i=this,o=[],s=function(r){var a=l.createPPLQuery(r,t),s=Object(n.dateTime)(t.range.from.valueOf()).format("YYYY-MM-DD HH:mm:ss"),u=Object(n.dateTime)(t.range.to.valueOf()).format("YYYY-MM-DD HH:mm:ss");a=(a=(a=a.replace(/\$timeTo/g,u)).replace(/\$timeFrom/g,s)).replace(/\$timestamp/g,"`"+l.timeField+"`"),o.push(Object(g.from)(l.post(l.getPPLUrl(),a)).pipe(N((function(t){var n,a,o=new K([r],t,H.PPL);if(e.some((function(e){return e.isLogsQuery}))){var s=o.getLogs(i.logMessageField,i.logLevelField);try{for(var l=(n=void 0,c(s.data)),u=l.next();!u.done;u=l.next()){ye(u.value,i.dataLinks)}}catch(e){n={error:e}}finally{try{u&&!u.done&&(a=l.return)&&a.call(l)}finally{if(n)throw n.error}}return s}return e.some((function(e){return"table"===e.format}))?o.getTable():o.getTimeSeries()}))))},l=this;try{for(var u=c(e),f=u.next();!f.done;f=u.next()){s(f.value)}}catch(e){r={error:e}}finally{try{f&&!f.done&&(a=u.return)&&a.call(u)}finally{if(r)throw r.error}}return g.merge.apply(void 0,p([],d(o)))},t.prototype.createLuceneQuery=function(e,t){var r,n=Object(le.getTemplateSrv)().replace(e.query,t.scopedVars,"lucene"),a=Object(le.getTemplateSrv)().getAdhocFilters(this.name);n&&""!==n||(n="*"),e.isLogsQuery||function(e,t){return e&&e.metrics&&e.metrics.some((function(e){return e.type===t}))}(e,"logs")?(e.bucketAggs=[U()],e.metrics=[],e.isLogsQuery=!0,r=this.queryBuilder.getLogsQuery(e,a,n)):(e.alias&&(e.alias=Object(le.getTemplateSrv)().replace(e.alias,t.scopedVars,"lucene")),r=this.queryBuilder.build(e,a,n));var i=JSON.stringify(r);return this.getQueryHeader("query_then_fetch",t.range.from,t.range.to)+"\n"+i+"\n"},t.prototype.createPPLQuery=function(e,t){var r,n=Object(le.getTemplateSrv)().replace(e.query,t.scopedVars,"pipe"),a=Object(le.getTemplateSrv)().getAdhocFilters(this.name);return n||(n="source=`"+this.indexPattern.getPPLIndexPattern()+"`"),r=this.queryBuilder.buildPPLQuery(e,a,n),JSON.stringify(r)},t.prototype.isMetadataField=function(e){return ge.includes(e)},t.prototype.getFields=function(e,t){return l(this,void 0,Promise,(function(){var r=this;return u(this,(function(n){return[2,this.get("/_mapping",t).then((function(t){var n={float:"number",double:"number",integer:"number",long:"number",date:"date",date_nanos:"date",string:"string",text:"string",scaled_float:"number",nested:"nested"},a=function(t,a){return!r.isMetadataField(a)&&(!e||(e===t.type||e===n[t.type]))},i=[],o={};function s(e){for(var t in e){var r=e[t];if(m.a.isObject(r.properties)&&(i.push(t),s(r.properties)),m.a.isObject(r.fields)&&(i.push(t),s(r.fields)),m.a.isString(r.type)){var n=i.concat(t).join(".");a(r,t)&&(o[n]={text:n,type:r.type})}}i.pop()}for(var l in t){var u=t[l];if(u&&u.mappings)s(u.mappings.properties)}return m.a.map(o,(function(e){return e}))}))]}))}))},t.prototype.getTerms=function(e,t){void 0===t&&(t=Object(n.getDefaultTimeRange)());var r=this.getQueryHeader("query_then_fetch",t.from,t.to),a=JSON.stringify(this.queryBuilder.getTermsQuery(e));a=r+"\n"+(a=(a=a.replace(/\$timeFrom/g,t.from.valueOf().toString())).replace(/\$timeTo/g,t.to.valueOf().toString()))+"\n";var i=this.getMultiSearchUrl();return this.post(i,a).then((function(e){if(!e.responses[0].aggregations)return[];var t=e.responses[0].aggregations[1].buckets;return m.a.map(t,(function(e){return{text:e.key_as_string||e.key,value:e.key}}))}))},t.prototype.getMultiSearchUrl=function(){return this.maxConcurrentShardRequests?"_msearch?max_concurrent_shard_requests="+this.maxConcurrentShardRequests:"_msearch"},t.prototype.getPPLUrl=function(){return"_opendistro/_ppl"},t.prototype.metricFindQuery=function(e,t){var r=null==t?void 0:t.range,n=JSON.parse(e);if(e){if("fields"===n.find)return n.type=Object(le.getTemplateSrv)().replace(n.type,{},"lucene"),this.getFields(n.type,r);if("terms"===n.find)return n.field=Object(le.getTemplateSrv)().replace(n.field,{},"lucene"),n.query=Object(le.getTemplateSrv)().replace(n.query||"*",{},"lucene"),this.getTerms(n,r)}return Promise.resolve([])},t.prototype.getTagKeys=function(){return this.getFields()},t.prototype.getTagValues=function(e){return this.getTerms({field:e.key,query:"*"})},t.prototype.targetContainsTemplate=function(e){var t,r,n,a;if(Object(le.getTemplateSrv)().variableExists(e.query)||Object(le.getTemplateSrv)().variableExists(e.alias))return!0;try{for(var i=c(e.bucketAggs),o=i.next();!o.done;o=i.next()){var s=o.value;if(Object(le.getTemplateSrv)().variableExists(s.field)||this.objectContainsTemplate(s.settings))return!0}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}try{for(var l=c(e.metrics),u=l.next();!u.done;u=l.next()){var d=u.value;if(Object(le.getTemplateSrv)().variableExists(d.field)||this.objectContainsTemplate(d.settings)||this.objectContainsTemplate(d.meta))return!0}}catch(e){n={error:e}}finally{try{u&&!u.done&&(a=l.return)&&a.call(l)}finally{if(n)throw n.error}}return!1},t.prototype.isPrimitive=function(e){return null==e||!!["string","number","boolean"].some((function(e){return e===me(!0)}))},t.prototype.objectContainsTemplate=function(e){var t,r,n,a;if(!e)return!1;try{for(var i=c(Object.keys(e)),o=i.next();!o.done;o=i.next()){var s=o.value;if(this.isPrimitive(e[s])){if(Object(le.getTemplateSrv)().variableExists(e[s]))return!0}else if(Array.isArray(e[s]))try{for(var l=(n=void 0,c(e[s])),u=l.next();!u.done;u=l.next()){var d=u.value;if(this.objectContainsTemplate(d))return!0}}catch(e){n={error:e}}finally{try{u&&!u.done&&(a=l.return)&&a.call(l)}finally{if(n)throw n.error}}else if(this.objectContainsTemplate(e[s]))return!0}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return!1},t.prototype.getSupportedQueryTypes=function(){return p([H.Lucene],d(this.pplEnabled?[H.PPL]:[]))},t}(n.DataSourceApi);function ye(e,t){var r,n,a,i=Object(le.getDataSourceSrv)();if(t.length){var o=function(e){var r=t.find((function(t){return e.name&&e.name.match(t.field)}));if(!r)return"continue";var n=void 0;if(r.datasourceUid){var o=i.getInstanceSettings(r.datasourceUid);n={title:"",url:"",internal:{query:{query:r.url},datasourceUid:r.datasourceUid,datasourceName:null!==(a=null==o?void 0:o.name)&&void 0!==a?a:"Data source not found"}}}else n={title:"",url:r.url};e.config=e.config||{},e.config.links=p(p([],d(e.config.links||[])),[n])};try{for(var s=c(e.fields),l=s.next();!l.done;l=s.next()){o(l.value)}}catch(e){r={error:e}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}}}var be=r(0),Ee=r.n(be),we=r(1),xe=we.LegacyForms.Select,Se=we.LegacyForms.Input,_e=we.LegacyForms.FormField,Ie=we.LegacyForms.Switch,Oe=[{label:"No pattern",value:"none"},{label:"Hourly",value:"Hourly",example:"[logstash-]YYYY.MM.DD.HH"},{label:"Daily",value:"Daily",example:"[logstash-]YYYY.MM.DD"},{label:"Weekly",value:"Weekly",example:"[logstash-]GGGG.WW"},{label:"Monthly",value:"Monthly",example:"[logstash-]YYYY.MM"},{label:"Yearly",value:"Yearly",example:"[logstash-]YYYY"}],Te=[{label:"1.0.x",value:"1.0.0"}],Ae=function(e){var t,r,n=e.value,a=e.onChange;return Ee.a.createElement(Ee.a.Fragment,null,Ee.a.createElement("h3",{className:"page-heading"},"OpenSearch details"),Ee.a.createElement("div",{className:"gf-form-group"},Ee.a.createElement("div",{className:"gf-form-inline"},Ee.a.createElement("div",{className:"gf-form"},Ee.a.createElement(_e,{labelWidth:10,inputWidth:15,label:"Index name",value:n.jsonData.database||"",onChange:ke("database",n,a),placeholder:"es-index-name",required:!0})),Ee.a.createElement("div",{className:"gf-form"},Ee.a.createElement(_e,{labelWidth:10,label:"Pattern",inputEl:Ee.a.createElement(xe,{options:Oe,onChange:Fe(n,a),value:Oe.find((function(e){return e.value===(void 0===n.jsonData.interval?"none":n.jsonData.interval)}))})}))),Ee.a.createElement("div",{className:"gf-form max-width-25"},Ee.a.createElement(_e,{labelWidth:10,inputWidth:15,label:"Time field name",value:n.jsonData.timeField||"",onChange:ke("timeField",n,a),required:!0})),Ee.a.createElement("div",{className:"gf-form"},Ee.a.createElement(_e,{labelWidth:10,label:"Version",inputEl:Ee.a.createElement(xe,{options:Te,onChange:function(e){a(o(o({},n),{jsonData:o(o({},n.jsonData),{version:e.value})}))},value:Te.find((function(e){return e.value===n.jsonData.version}))})})),Ee.a.createElement("div",{className:"gf-form max-width-30"},Ee.a.createElement(_e,{"aria-label":"Max concurrent Shard Requests input",labelWidth:15,label:"Max concurrent Shard Requests",value:n.jsonData.maxConcurrentShardRequests||"",onChange:ke("maxConcurrentShardRequests",n,a)})),Ee.a.createElement("div",{className:"gf-form-inline"},Ee.a.createElement("div",{className:"gf-form"},Ee.a.createElement(_e,{labelWidth:10,label:"Min time interval",inputEl:Ee.a.createElement(Se,{className:"width-6",value:n.jsonData.timeInterval||"",onChange:ke("timeInterval",n,a),placeholder:"10s",validationEvents:(t={},t[we.EventsWithValidation.onBlur]=[Object(we.regexValidation)(/^\d+(ms|[Mwdhmsy])$/,"Value is not valid, you can use number with time unit specifier: y, M, w, d, h, m, s")],t)}),tooltip:Ee.a.createElement(Ee.a.Fragment,null,"A lower limit for the auto group by time interval. Recommended to be set to write frequency, for example ",Ee.a.createElement("code",null,"1m")," if your data is written every minute.")}))),Ee.a.createElement("div",{className:"gf-form"},Ee.a.createElement(Ie,{label:"PPL enabled",labelClass:"width-10",tooltip:"Allow Piped Processing Language as an alternative query syntax in the OpenSearch query editor.",checked:null===(r=n.jsonData.pplEnabled)||void 0===r||r,onChange:Pe("pplEnabled",n,a)}))))},ke=function(e,t,r){return function(n){var a;r(o(o({},t),{jsonData:o(o({},t.jsonData),(a={},a[e]=n.currentTarget.value,a))}))}},Pe=function(e,t,r){return function(n){var a;r(o(o({},t),{jsonData:o(o({},t.jsonData),(a={},a[e]=n.currentTarget.checked,a))}))}},Fe=function(e,t){return function(r){var n,a=e.database,i="none"===r.value?void 0:r.value;if(!a||0===a.length||a.startsWith("[logstash-]")){var s="";if(void 0!==i){var l=Oe.find((function(e){return e.value===i}));l&&(s=null!==(n=l.example)&&void 0!==n?n:"")}t(o(o({},e),{database:s,jsonData:o(o({},e.jsonData),{interval:i})}))}else t(o(o({},e),{jsonData:o(o({},e.jsonData),{interval:i})}))}},Ne=we.LegacyForms.FormField,Le=function(e){var t=e.value,r=e.onChange,n=function(e){return function(n){var a;r(o(o({},t),((a={})[e]=n.currentTarget.value,a)))}};return Ee.a.createElement(Ee.a.Fragment,null,Ee.a.createElement("h3",{className:"page-heading"},"Logs"),Ee.a.createElement("div",{className:"gf-form-group"},Ee.a.createElement("div",{className:"gf-form max-width-30"},Ee.a.createElement(Ne,{labelWidth:11,label:"Message field name",value:t.logMessageField,onChange:n("logMessageField"),placeholder:"_source"})),Ee.a.createElement("div",{className:"gf-form max-width-30"},Ee.a.createElement(Ne,{labelWidth:11,label:"Level field name",value:t.logLevelField,onChange:n("logLevelField")}))))};var Re=function(){function e(e){var t=this;this._insertTag=function(e){var r;r=0===t.tags.length?t.prepend?t.container.firstChild:t.before:t.tags[t.tags.length-1].nextSibling,t.container.insertBefore(e,r),t.tags.push(e)},this.isSpeedy=void 0===e.speedy||e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.prepend=e.prepend,this.before=null}var t=e.prototype;return t.hydrate=function(e){e.forEach(this._insertTag)},t.insert=function(e){this.ctr%(this.isSpeedy?65e3:1)==0&&this._insertTag(function(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),void 0!==e.nonce&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}(this));var t=this.tags[this.tags.length-1];if(this.isSpeedy){var r=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}(t);try{r.insertRule(e,r.cssRules.length)}catch(e){0}}else t.appendChild(document.createTextNode(e));this.ctr++},t.flush=function(){this.tags.forEach((function(e){return e.parentNode.removeChild(e)})),this.tags=[],this.ctr=0},e}(),De="-moz-",$e="-webkit-",Ce="comm",je="decl",Me=Math.abs,Ve=String.fromCharCode;function qe(e){return e.trim()}function Be(e,t,r){return e.replace(t,r)}function Qe(e,t){return e.indexOf(t)}function Ge(e,t){return 0|e.charCodeAt(t)}function Ue(e,t,r){return e.slice(t,r)}function ze(e){return e.length}function He(e){return e.length}function We(e,t){return t.push(e),e}function Ye(e,t){return e.map(t).join("")}var Xe=1,Je=1,Ze=0,Ke=0,et=0,tt="";function rt(e,t,r,n,a,i,o){return{value:e,root:t,parent:r,type:n,props:a,children:i,line:Xe,column:Je,length:o,return:""}}function nt(e,t,r){return rt(e,t.root,t.parent,r,t.props,t.children,0)}function at(){return et=Ke>0?Ge(tt,--Ke):0,Je--,10===et&&(Je=1,Xe--),et}function it(){return et=Ke<Ze?Ge(tt,Ke++):0,Je++,10===et&&(Je=1,Xe++),et}function ot(){return Ge(tt,Ke)}function st(){return Ke}function lt(e,t){return Ue(tt,e,t)}function ut(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function ct(e){return Xe=Je=1,Ze=ze(tt=e),Ke=0,[]}function dt(e){return tt="",e}function pt(e){return qe(lt(Ke-1,function e(t){for(;it();)switch(et){case t:return Ke;case 34:case 39:return e(34===t||39===t?t:et);case 40:41===t&&e(t);break;case 92:it()}return Ke}(91===e?e+2:40===e?e+1:e)))}function ft(e){for(;(et=ot())&&et<33;)it();return ut(e)>2||ut(et)>3?"":" "}function ht(e,t){for(;--t&&it()&&!(et<48||et>102||et>57&&et<65||et>70&&et<97););return lt(e,st()+(t<6&&32==ot()&&32==it()))}function mt(e,t){for(;it()&&e+et!==57&&(e+et!==84||47!==ot()););return"/*"+lt(t,Ke-1)+"*"+Ve(47===e?e:it())}function gt(e){for(;!ut(ot());)it();return lt(e,Ke)}function vt(e){return dt(function e(t,r,n,a,i,o,s,l,u){var c=0,d=0,p=s,f=0,h=0,m=0,g=1,v=1,y=1,b=0,E="",w=i,x=o,S=a,_=E;for(;v;)switch(m=b,b=it()){case 34:case 39:case 91:case 40:_+=pt(b);break;case 9:case 10:case 13:case 32:_+=ft(m);break;case 92:_+=ht(st()-1,7);continue;case 47:switch(ot()){case 42:case 47:We(bt(mt(it(),st()),r,n),u);break;default:_+="/"}break;case 123*g:l[c++]=ze(_)*y;case 125*g:case 59:case 0:switch(b){case 0:case 125:v=0;case 59+d:h>0&&ze(_)-p&&We(h>32?Et(_+";",a,n,p-1):Et(Be(_," ","")+";",a,n,p-2),u);break;case 59:_+=";";default:if(We(S=yt(_,r,n,c,d,i,l,E,w=[],x=[],p),o),123===b)if(0===d)e(_,r,S,S,w,o,p,l,x);else switch(f){case 100:case 109:case 115:e(t,S,S,a&&We(yt(t,S,S,0,0,i,l,E,i,w=[],p),x),i,x,p,l,a?w:x);break;default:e(_,S,S,S,[""],x,p,l,x)}}c=d=h=0,g=y=1,E=_="",p=s;break;case 58:p=1+ze(_),h=m;default:if(g<1)if(123==b)--g;else if(125==b&&0==g++&&125==at())continue;switch(_+=Ve(b),b*g){case 38:y=d>0?1:(_+="\f",-1);break;case 44:l[c++]=(ze(_)-1)*y,y=1;break;case 64:45===ot()&&(_+=pt(it())),f=ot(),d=ze(E=_+=gt(st())),b++;break;case 45:45===m&&2==ze(_)&&(g=0)}}return o}("",null,null,null,[""],e=ct(e),0,[0],e))}function yt(e,t,r,n,a,i,o,s,l,u,c){for(var d=a-1,p=0===a?i:[""],f=He(p),h=0,m=0,g=0;h<n;++h)for(var v=0,y=Ue(e,d+1,d=Me(m=o[h])),b=e;v<f;++v)(b=qe(m>0?p[v]+" "+y:Be(y,/&\f/g,p[v])))&&(l[g++]=b);return rt(e,t,r,0===a?"rule":s,l,u,c)}function bt(e,t,r){return rt(e,t,r,Ce,Ve(et),Ue(e,2,-2),0)}function Et(e,t,r,n){return rt(e,t,r,je,Ue(e,0,n),Ue(e,n+1,-1),n)}function wt(e,t){switch(function(e,t){return(((t<<2^Ge(e,0))<<2^Ge(e,1))<<2^Ge(e,2))<<2^Ge(e,3)}(e,t)){case 5103:return $e+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return $e+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return $e+e+De+e+"-ms-"+e+e;case 6828:case 4268:return $e+e+"-ms-"+e+e;case 6165:return $e+e+"-ms-flex-"+e+e;case 5187:return $e+e+Be(e,/(\w+).+(:[^]+)/,$e+"box-$1$2-ms-flex-$1$2")+e;case 5443:return $e+e+"-ms-flex-item-"+Be(e,/flex-|-self/,"")+e;case 4675:return $e+e+"-ms-flex-line-pack"+Be(e,/align-content|flex-|-self/,"")+e;case 5548:return $e+e+"-ms-"+Be(e,"shrink","negative")+e;case 5292:return $e+e+"-ms-"+Be(e,"basis","preferred-size")+e;case 6060:return $e+"box-"+Be(e,"-grow","")+$e+e+"-ms-"+Be(e,"grow","positive")+e;case 4554:return $e+Be(e,/([^-])(transform)/g,"$1"+$e+"$2")+e;case 6187:return Be(Be(Be(e,/(zoom-|grab)/,$e+"$1"),/(image-set)/,$e+"$1"),e,"")+e;case 5495:case 3959:return Be(e,/(image-set\([^]*)/,$e+"$1$`$1");case 4968:return Be(Be(e,/(.+:)(flex-)?(.*)/,$e+"box-pack:$3-ms-flex-pack:$3"),/s.+-b[^;]+/,"justify")+$e+e+e;case 4095:case 3583:case 4068:case 2532:return Be(e,/(.+)-inline(.+)/,$e+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(ze(e)-1-t>6)switch(Ge(e,t+1)){case 109:if(45!==Ge(e,t+4))break;case 102:return Be(e,/(.+:)(.+)-([^]+)/,"$1"+$e+"$2-$3$1"+De+(108==Ge(e,t+3)?"$3":"$2-$3"))+e;case 115:return~Qe(e,"stretch")?wt(Be(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(115!==Ge(e,t+1))break;case 6444:switch(Ge(e,ze(e)-3-(~Qe(e,"!important")&&10))){case 107:return Be(e,":",":"+$e)+e;case 101:return Be(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+$e+(45===Ge(e,14)?"inline-":"")+"box$3$1"+$e+"$2$3$1-ms-$2box$3")+e}break;case 5936:switch(Ge(e,t+11)){case 114:return $e+e+"-ms-"+Be(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return $e+e+"-ms-"+Be(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return $e+e+"-ms-"+Be(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return $e+e+"-ms-"+e+e}return e}function xt(e,t){for(var r="",n=He(e),a=0;a<n;a++)r+=t(e[a],a,e,t)||"";return r}function St(e,t,r,n){switch(e.type){case"@import":case je:return e.return=e.return||e.value;case Ce:return"";case"rule":e.value=e.props.join(",")}return ze(r=xt(e.children,n))?e.return=e.value+"{"+r+"}":""}var _t=function(e){var t=Object.create(null);return function(r){return void 0===t[r]&&(t[r]=e(r)),t[r]}},It=function(e,t){return dt(function(e,t){var r=-1,n=44;do{switch(ut(n)){case 0:38===n&&12===ot()&&(t[r]=1),e[r]+=gt(Ke-1);break;case 2:e[r]+=pt(n);break;case 4:if(44===n){e[++r]=58===ot()?"&\f":"",t[r]=e[r].length;break}default:e[r]+=Ve(n)}}while(n=it());return e}(ct(e),t))},Ot=new WeakMap,Tt=function(e){if("rule"===e.type&&e.parent&&e.length){for(var t=e.value,r=e.parent,n=e.column===r.column&&e.line===r.line;"rule"!==r.type;)if(!(r=r.parent))return;if((1!==e.props.length||58===t.charCodeAt(0)||Ot.get(r))&&!n){Ot.set(e,!0);for(var a=[],i=It(t,a),o=r.props,s=0,l=0;s<i.length;s++)for(var u=0;u<o.length;u++,l++)e.props[l]=a[s]?i[s].replace(/&\f/g,o[u]):o[u]+" "+i[s]}}},At=function(e){if("decl"===e.type){var t=e.value;108===t.charCodeAt(0)&&98===t.charCodeAt(2)&&(e.return="",e.value="")}},kt=[function(e,t,r,n){if(!e.return)switch(e.type){case je:e.return=wt(e.value,e.length);break;case"@keyframes":return xt([nt(Be(e.value,"@","@"+$e),e,"")],n);case"rule":if(e.length)return Ye(e.props,(function(t){switch(function(e,t){return(e=t.exec(e))?e[0]:e}(t,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return xt([nt(Be(t,/:(read-\w+)/,":-moz-$1"),e,"")],n);case"::placeholder":return xt([nt(Be(t,/:(plac\w+)/,":"+$e+"input-$1"),e,""),nt(Be(t,/:(plac\w+)/,":-moz-$1"),e,""),nt(Be(t,/:(plac\w+)/,"-ms-input-$1"),e,"")],n)}return""}))}}],Pt=function(e){var t=e.key;if("css"===t){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,(function(e){-1!==e.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(e),e.setAttribute("data-s",""))}))}var n=e.stylisPlugins||kt;var a,i,o={},s=[];a=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),(function(e){for(var t=e.getAttribute("data-emotion").split(" "),r=1;r<t.length;r++)o[t[r]]=!0;s.push(e)}));var l,u,c=[St,(u=function(e){l.insert(e)},function(e){e.root||(e=e.return)&&u(e)})],d=function(e){var t=He(e);return function(r,n,a,i){for(var o="",s=0;s<t;s++)o+=e[s](r,n,a,i)||"";return o}}([Tt,At].concat(n,c));i=function(e,t,r,n){l=r,xt(vt(e?e+"{"+t.styles+"}":t.styles),d),n&&(p.inserted[t.name]=!0)};var p={key:t,sheet:new Re({key:t,container:a,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend}),nonce:e.nonce,inserted:o,registered:{},insert:i};return p.sheet.hydrate(s),p};var Ft=function(e){for(var t,r=0,n=0,a=e.length;a>=4;++n,a-=4)t=1540483477*(65535&(t=255&e.charCodeAt(n)|(255&e.charCodeAt(++n))<<8|(255&e.charCodeAt(++n))<<16|(255&e.charCodeAt(++n))<<24))+(59797*(t>>>16)<<16),r=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&r)+(59797*(r>>>16)<<16);switch(a){case 3:r^=(255&e.charCodeAt(n+2))<<16;case 2:r^=(255&e.charCodeAt(n+1))<<8;case 1:r=1540483477*(65535&(r^=255&e.charCodeAt(n)))+(59797*(r>>>16)<<16)}return(((r=1540483477*(65535&(r^=r>>>13))+(59797*(r>>>16)<<16))^r>>>15)>>>0).toString(36)},Nt={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Lt=/[A-Z]|^ms/g,Rt=/_EMO_([^_]+?)_([^]*?)_EMO_/g,Dt=function(e){return 45===e.charCodeAt(1)},$t=function(e){return null!=e&&"boolean"!=typeof e},Ct=_t((function(e){return Dt(e)?e:e.replace(Lt,"-$&").toLowerCase()})),jt=function(e,t){switch(e){case"animation":case"animationName":if("string"==typeof t)return t.replace(Rt,(function(e,t,r){return Vt={name:t,styles:r,next:Vt},t}))}return 1===Nt[e]||Dt(e)||"number"!=typeof t||0===t?t:t+"px"};function Mt(e,t,r){if(null==r)return"";if(void 0!==r.__emotion_styles)return r;switch(typeof r){case"boolean":return"";case"object":if(1===r.anim)return Vt={name:r.name,styles:r.styles,next:Vt},r.name;if(void 0!==r.styles){var n=r.next;if(void 0!==n)for(;void 0!==n;)Vt={name:n.name,styles:n.styles,next:Vt},n=n.next;return r.styles+";"}return function(e,t,r){var n="";if(Array.isArray(r))for(var a=0;a<r.length;a++)n+=Mt(e,t,r[a])+";";else for(var i in r){var o=r[i];if("object"!=typeof o)null!=t&&void 0!==t[o]?n+=i+"{"+t[o]+"}":$t(o)&&(n+=Ct(i)+":"+jt(i,o)+";");else if(!Array.isArray(o)||"string"!=typeof o[0]||null!=t&&void 0!==t[o[0]]){var s=Mt(e,t,o);switch(i){case"animation":case"animationName":n+=Ct(i)+":"+s+";";break;default:n+=i+"{"+s+"}"}}else for(var l=0;l<o.length;l++)$t(o[l])&&(n+=Ct(i)+":"+jt(i,o[l])+";")}return n}(e,t,r);case"function":if(void 0!==e){var a=Vt,i=r(e);return Vt=a,Mt(e,t,i)}break;case"string":}if(null==t)return r;var o=t[r];return void 0!==o?o:r}var Vt,qt=/label:\s*([^\s;\n{]+)\s*(;|$)/g;var Bt=function(e,t,r){if(1===e.length&&"object"==typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var n=!0,a="";Vt=void 0;var i=e[0];null==i||void 0===i.raw?(n=!1,a+=Mt(r,t,i)):a+=i[0];for(var o=1;o<e.length;o++)a+=Mt(r,t,e[o]),n&&(a+=i[o]);qt.lastIndex=0;for(var s,l="";null!==(s=qt.exec(a));)l+="-"+s[1];return{name:Ft(a)+l,styles:a,next:Vt}};function Qt(e,t,r){var n="";return r.split(" ").forEach((function(r){void 0!==e[r]?t.push(e[r]+";"):n+=r+" "})),n}var Gt=function(e,t,r){var n=e.key+"-"+t.name;if(!1===r&&void 0===e.registered[n]&&(e.registered[n]=t.styles),void 0===e.inserted[t.name]){var a=t;do{e.insert(t===a?"."+n:"",a,e.sheet,!0);a=a.next}while(void 0!==a)}};function Ut(e,t){if(void 0===e.inserted[t.name])return e.insert("",t,e.sheet,!0)}function zt(e,t,r){var n=[],a=Qt(e,n,r);return n.length<2?r:a+t(n)}var Ht=function e(t){for(var r="",n=0;n<t.length;n++){var a=t[n];if(null!=a){var i=void 0;switch(typeof a){case"boolean":break;case"object":if(Array.isArray(a))i=e(a);else for(var o in i="",a)a[o]&&o&&(i&&(i+=" "),i+=o);break;default:i=a}i&&(r&&(r+=" "),r+=i)}}return r},Wt=function(e){var t=Pt(e);t.sheet.speedy=function(e){this.isSpeedy=e},t.compat=!0;var r=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var a=Bt(r,t.registered,void 0);return Gt(t,a,!1),t.key+"-"+a.name};return{css:r,cx:function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return zt(t.registered,r,Ht(n))},injectGlobal:function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var a=Bt(r,t.registered);Ut(t,a)},keyframes:function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var a=Bt(r,t.registered),i="animation-"+a.name;return Ut(t,{name:a.name,styles:"@keyframes "+i+"{"+a.styles+"}"}),i},hydrate:function(e){e.forEach((function(e){t.inserted[e]=!0}))},flush:function(){t.registered={},t.inserted={},t.sheet.flush()},sheet:t.sheet,cache:t,getRegisteredStyles:Qt.bind(null,t.registered),merge:zt.bind(null,t.registered,r)}}({key:"css"}),Yt=(Wt.flush,Wt.hydrate,Wt.cx),Xt=(Wt.merge,Wt.getRegisteredStyles,Wt.injectGlobal,Wt.keyframes,Wt.css),Jt=(Wt.sheet,Wt.cache,function(e){var t=Object(be.useRef)();return Object(be.useEffect)((function(){t.current=e})),t.current}),Zt=r(27),Kt=function(e){var t=e.status,r=s(e,["status"]),a=function(e){e||(e=n.PluginSignatureStatus.invalid);switch(e){case n.PluginSignatureStatus.internal:return{text:"Core",icon:"cube",color:"blue",tooltip:"Core plugin that is bundled with Grafana"};case n.PluginSignatureStatus.valid:return{text:"Signed",icon:"lock",color:"green",tooltip:"Signed and verified plugin"};case n.PluginSignatureStatus.invalid:return{text:"Invalid signature",icon:"exclamation-triangle",color:"red",tooltip:"Invalid plugin signature"};case n.PluginSignatureStatus.modified:return{text:"Modified signature",icon:"exclamation-triangle",color:"red",tooltip:"Valid signature but content has been modified"};case n.PluginSignatureStatus.missing:return{text:"Missing signature",icon:"exclamation-triangle",color:"red",tooltip:"Missing plugin signature"}}return{text:"Unsigned",icon:"exclamation-triangle",color:"red",tooltip:"Unsigned external plugin"}}(t);return Ee.a.createElement(we.Badge,o({text:a.text,color:a.color,icon:a.icon,tooltip:a.tooltip},r))};Kt.displayName="PluginSignatureBadge";var er,tr,rr,nr,ar,ir=function(e){function t(t){var r=e.call(this,t)||this;return r.dataSourceSrv=Object(le.getDataSourceSrv)(),r.state={},r.onChange=function(e){var t=r.dataSourceSrv.getInstanceSettings(e.value);t&&(r.props.onChange(t),r.setState({error:void 0}))},r}return i(t,e),t.prototype.componentDidMount=function(){var e=this.props.current;this.dataSourceSrv.getInstanceSettings(e)||this.setState({error:"Could not find data source "+e})},t.prototype.getCurrentValue=function(){var e=this.props,t=e.current,r=e.hideTextValue,n=e.noDefault;if(!t&&n)return null;var a=this.dataSourceSrv.getInstanceSettings(t);return a?{label:a.name.substr(0,37),value:a.name,imgUrl:a.meta.info.logos.small,hideText:r,meta:a.meta}:{label:(null!=t?t:"no name")+" - not found",value:t,imgUrl:"",hideText:r}},t.prototype.getDataSourceOptions=function(){var e=this.props,t=e.tracing,r=e.metrics,n=e.mixed,a=e.dashboard,i=e.variables,o=e.annotations,s=e.pluginId;return this.dataSourceSrv.getList({tracing:t,metrics:r,dashboard:a,mixed:n,variables:i,annotations:o,pluginId:s}).map((function(e){return{value:e.name,label:e.name+(e.isDefault?" (default)":""),imgUrl:e.meta.info.logos.small,meta:e.meta}}))},t.prototype.render=function(){var e=this.props,t=e.autoFocus,r=e.onBlur,a=e.openMenuOnFocus,i=e.placeholder,o=this.state.error,s=this.getDataSourceOptions(),l=this.getCurrentValue();return Ee.a.createElement("div",{"aria-label":Zt.selectors.components.DataSourcePicker.container},Ee.a.createElement(we.Select,{className:"ds-picker select-container",isMulti:!1,isClearable:!1,backspaceRemovesValue:!1,onChange:this.onChange,options:s,autoFocus:t,onBlur:r,openMenuOnFocus:a,maxMenuHeight:500,menuPlacement:"bottom",placeholder:i,noOptionsMessage:"No datasources found",value:l,invalid:!!o,getOptionLabel:function(e){return e.meta&&((t=e.meta.signature)&&t!==n.PluginSignatureStatus.valid&&t!==n.PluginSignatureStatus.internal)&&e!==l?Ee.a.createElement(we.HorizontalGroup,{align:"center",justify:"space-between"},Ee.a.createElement("span",null,e.label)," ",Ee.a.createElement(Kt,{status:e.meta.signature})):e.label||"";var t}}))},t.defaultProps={autoFocus:!1,openMenuOnFocus:!1,placeholder:"Select datasource"},t}(be.PureComponent),or=we.LegacyForms.FormField,sr=we.LegacyForms.Switch,lr=Object(we.stylesFactory)((function(){return{firstRow:Xt(er||(er=f(["\n    display: flex;\n  "],["\n    display: flex;\n  "]))),nameField:Xt(tr||(tr=f(["\n    flex: 2;\n  "],["\n    flex: 2;\n  "]))),regexField:Xt(rr||(rr=f(["\n    flex: 3;\n  "],["\n    flex: 3;\n  "]))),row:Xt(nr||(nr=f(["\n    display: flex;\n    align-items: baseline;\n  "],["\n    display: flex;\n    align-items: baseline;\n  "])))}})),ur=function(e){var t,r=e.value,n=e.onChange,a=e.onDelete,i=e.suggestions,s=e.className,l=lr(),u=d(function(e){var t=d(Object(be.useState)(!!e),2),r=t[0],n=t[1],a=Jt(e);return Object(be.useEffect)((function(){a||!e||r||n(!0),a&&!e&&r&&n(!1)}),[a,e,r]),[r,n]}(r.datasourceUid),2),c=u[0],p=u[1];return Ee.a.createElement("div",{className:s},Ee.a.createElement("div",{className:l.firstRow+" gf-form"},Ee.a.createElement(or,{className:l.nameField,labelWidth:6,inputWidth:null,label:"Field",type:"text",value:r.field,tooltip:"Can be exact field name or a regex pattern that will match on the field name.",onChange:(t="field",function(e){var a;n(o(o({},r),((a={})[t]=e.currentTarget.value,a)))})}),Ee.a.createElement(we.Button,{variant:"destructive",title:"Remove field",icon:"times",onClick:function(e){e.preventDefault(),a()}})),Ee.a.createElement("div",{className:"gf-form"},Ee.a.createElement(or,{label:c?"Query":"URL",labelWidth:6,inputEl:Ee.a.createElement(we.DataLinkInput,{placeholder:c?"${__value.raw}":"http://example.com/${__value.raw}",value:r.url||"",onChange:function(e){return n(o(o({},r),{url:e}))},suggestions:i}),className:Xt(ar||(ar=f(["\n            width: 100%;\n          "],["\n            width: 100%;\n          "])))})),Ee.a.createElement("div",{className:l.row},Ee.a.createElement(sr,{labelClass:"width-6",label:"Internal link",checked:c,onChange:function(){c&&n(o(o({},r),{datasourceUid:void 0})),p(!c)}}),c&&Ee.a.createElement(ir,{tracing:!0,onChange:function(e){n(o(o({},r),{datasourceUid:e.uid}))},current:r.datasourceUid})))};var cr,dr,pr,fr,hr,mr,gr,vr,yr,br=Object(we.stylesFactory)((function(e){return{infoText:Xt(cr||(cr=f(["\n    padding-bottom: ",";\n    color: ",";\n  "],["\n    padding-bottom: ",";\n    color: ",";\n  "])),e.spacing.md,e.colors.textWeak),dataLink:Xt(dr||(dr=f(["\n    margin-bottom: ",";\n  "],["\n    margin-bottom: ",";\n  "])),e.spacing.sm)}})),Er=function(e){var t=e.value,r=e.onChange,a=Object(we.useTheme)(),i=br(a);return Ee.a.createElement(Ee.a.Fragment,null,Ee.a.createElement("h3",{className:"page-heading"},"Data links"),Ee.a.createElement("div",{className:i.infoText},"Add links to existing fields. Links will be shown in log row details next to the field value."),t&&t.length>0&&Ee.a.createElement("div",{className:"gf-form-group"},t.map((function(e,a){return Ee.a.createElement(ur,{className:i.dataLink,key:a,value:e,onChange:function(e){var n=p([],d(t));n.splice(a,1,e),r(n)},onDelete:function(){var e=p([],d(t));e.splice(a,1),r(e)},suggestions:[{value:n.DataLinkBuiltInVars.valueRaw,label:"Raw value",documentation:"Raw value of the field",origin:n.VariableOrigin.Value}]})}))),Ee.a.createElement(we.Button,{variant:"secondary",className:Xt(pr||(pr=f(["\n          margin-right: 10px;\n        "],["\n          margin-right: 10px;\n        "]))),icon:"plus",onClick:function(e){e.preventDefault();var n=p(p([],d(t||[])),[{field:"",url:""}]);r(n)}},"Add"))},wr=r(11),xr=function(e){var t;return o(o({},e),{jsonData:o(o({},e.jsonData),{timeField:e.jsonData.timeField||"@timestamp",version:Object(wr.valid)(e.jsonData.version)||"1.0.0",maxConcurrentShardRequests:e.jsonData.maxConcurrentShardRequests||5,logMessageField:e.jsonData.logMessageField||"",logLevelField:e.jsonData.logLevelField||"",pplEnabled:null===(t=e.jsonData.pplEnabled)||void 0===t||t})})},Sr=function(e,t,r){return Object(be.useCallback)((function(n){e(r(t,n))}),[e,t,r])},_r=Object(be.createContext)(void 0),Ir=function(){var e=Object(be.useContext)(_r);if(!e)throw new Error("Use DispatchContext first.");return e},Or="init",Tr=function(e){return{type:"change_query",payload:{query:e}}},Ar=function(e,t){switch(t.type){case"change_query":return t.payload.query;case Or:return e||"";default:return e}},kr=function(e,t){switch(t.type){case"change_alias_pattern":return t.payload.aliasPattern;case Or:return e||"";default:return e}},Pr=function(e,t){switch(t.type){case"@metrics/add":return p(p([],d(e)),[G(t.payload.id)]);case"@metrics/remove":var r=e.find((function(e){return e.id===t.payload.id})),n=p([r],d(function e(t,r){var n=r.filter((function(e){var r;return j(e)?null===(r=e.pipelineVariables)||void 0===r?void 0:r.some((function(e){return e.pipelineAgg===t.id})):$(e)&&t.id===e.field}));return p(p([],d(n)),d(n.flatMap((function(t){return e(t,r)}))))}(r,e))),a=e.filter((function(e){return!n.some((function(t){return t.id===e.id}))}));return 0===a.length?[G("1")]:a;case"@metrics/change_type":return e.filter((function(e){return!V[t.payload.type].isSingleMetric||e.id===t.payload.id})).map((function(e){return e.id!==t.payload.id?e:o({id:e.id,type:t.payload.type},V[t.payload.type].defaults)}));case"@metrics/change_field":return e.map((function(e){return e.id!==t.payload.id?e:o(o({},e),{field:t.payload.field})}));case"@metrics/toggle_visibility":return e.map((function(e){return e.id!==t.payload.id?e:o(o({},e),{hide:!e.hide})}));case"@metrics/change_setting":return e.map((function(e){var r;if(e.id!==t.payload.metric.id)return e;if(M(e)){var n=Z(o(o({},e.settings),((r={})[t.payload.settingName]=t.payload.newValue,r)));return o(o({},e),{settings:o({},n)})}return e}));case"@metrics/change_meta":return e.map((function(e){var r;return e.id!==t.payload.metric.id?e:function(e){return V[e.type].hasMeta}(e)?o(o({},e),{meta:o(o({},e.meta),(r={},r[t.payload.meta]=t.payload.newValue,r))}):e}));case"@metrics/change_attr":return e.map((function(e){var r;return e.id!==t.payload.metric.id?e:o(o({},e),((r={})[t.payload.attribute]=t.payload.newValue,r))}));case Or:return(null==e?void 0:e.length)?e:[G("1")];default:return e}},Fr=function(e,t){switch(t.type){case"change_query_type":return t.payload.queryType;case Or:return H.Lucene;default:return e}},Nr=function(e,t){switch(t.type){case"change_format":return t.payload.format;case Or:return"table";default:return e}},Lr=Object(be.createContext)(void 0),Rr=Object(be.createContext)(void 0),Dr=function(e){var t,r,n=e.children,a=e.onChange,i=e.query,s=e.datasource,l=(t={query:Ar,queryType:Fr,alias:kr,metrics:Pr,bucketAggs:(r=s.timeField,function(e,t){switch(t.type){case"@bucketAggs/add":var n={id:t.payload.id,type:"terms",settings:ue.terms.defaultSettings},a=e[e.length-1];return"date_histogram"===(null==a?void 0:a.type)?p(p([],d(e.slice(0,e.length-1))),[n,a]):p(p([],d(e)),[n]);case"@bucketAggs/remove":return e.filter((function(e){return e.id!==t.payload.id}));case"@bucketAggs/change_type":return e.map((function(e){return e.id!==t.payload.id?e:{id:e.id,type:t.payload.newType,settings:ue[t.payload.newType].defaultSettings}}));case"@bucketAggs/change_field":return e.map((function(e){return e.id!==t.payload.id?e:o(o({},e),{field:t.payload.newField})}));case"@metrics/change_type":return V[t.payload.type].isSingleMetric?[]:0===e.length?[U()]:e;case"@bucketAggs/change_setting":return e.map((function(e){var r;if(e.id!==t.payload.bucketAgg.id)return e;var n=Z(o(o({},e.settings),((r={})[t.payload.settingName]=t.payload.newValue,r)));return o(o({},e),{settings:o({},n)})}));case Or:return(null==e?void 0:e.length)?e:[o(o({},U("2")),{field:r})];default:return e}}),format:Nr},function(e,r){var n={};for(var a in t)n[a]=t[a](e[a],r);return n}),u=Sr((function(e){return a(o(o(o({},i),e),{timeField:s.timeField}))}),i,l);return i.metrics&&i.bucketAggs&&void 0!==i.query?Ee.a.createElement(Lr.Provider,{value:s},Ee.a.createElement(Rr.Provider,{value:i},Ee.a.createElement(_r.Provider,{value:u},n))):(u({type:Or}),null)},$r=function(){var e=Object(be.useContext)(Rr);if(!e)throw new Error("use OpenSearchProvider first.");return e},Cr=function(){var e=Object(be.useContext)(Lr);if(!e)throw new Error("use OpenSearchProvider first.");return e},jr=((fr={})[H.Lucene]={label:"Lucene"},fr[H.PPL]={label:"PPL"},fr),Mr=Xt(hr||(hr=f(["\n  min-width: 150px;\n"],["\n  min-width: 150px;\n"]))),Vr=function(e){var t,r,n=e.value,a=Cr(),i=Ir();return Ee.a.createElement(we.Segment,{className:Mr,options:(r=a.getSupportedQueryTypes(),Object.entries(jr).filter((function(e){var t=d(e,2),n=t[0];return t[1],r.includes(n)})).map((function(e){var t=d(e,2),r=t[0];return{label:t[1].label,value:r}}))),onChange:function(e){return i({type:"change_query_type",payload:{queryType:e.value}})},value:(t=n,{label:jr[t].label,value:t})})},qr=Object(we.stylesFactory)((function(e,t){return{color:t&&Xt(mr||(mr=f(["\n      &,\n      &:hover,\n      label,\n      a {\n        color: ",";\n      }\n    "],["\n      &,\n      &:hover,\n      label,\n      a {\n        color: ",";\n      }\n    "])),t?e.colors.textFaint:e.colors.text)}})),Br=function(e,t){return{type:"@metrics/change_field",payload:{id:e,field:t}}},Qr=function(e,t,r){return{type:"@metrics/change_setting",payload:{metric:e,settingName:t,newValue:r}}},Gr=Xt(gr||(gr=f(["\n  clip: rect(0 0 0 0);\n  clip-path: inset(50%);\n  height: 1px;\n  overflow: hidden;\n  position: absolute;\n  white-space: nowrap;\n  width: 1px;\n"],["\n  clip: rect(0 0 0 0);\n  clip-path: inset(50%);\n  height: 1px;\n  overflow: hidden;\n  position: absolute;\n  white-space: nowrap;\n  width: 1px;\n"]))),Ur=function(e){var t=e.iconName,r=e.onClick,n=e.className,a=e.label,i=s(e,["iconName","onClick","className","label"]);return Ee.a.createElement("button",o({className:Yt("gf-form-label gf-form-label--btn query-part",n),onClick:r},i),Ee.a.createElement("span",{className:Gr},a),Ee.a.createElement(we.Icon,{name:t,"aria-hidden":"true"}))},zr=function(e){var t=e.index,r=e.onAdd,n=e.onRemove,a=e.elements;return Ee.a.createElement("div",{className:Xt(vr||(vr=f(["\n        display: flex;\n      "],["\n        display: flex;\n      "])))},0===t&&Ee.a.createElement(Ur,{iconName:"plus",onClick:r,label:"add"}),a.length>=2&&Ee.a.createElement(Ur,{iconName:"minus",onClick:n,label:"remove"}))},Hr=Xt(yr||(yr=f(["\n  white-space: nowrap;\n"],["\n  white-space: nowrap;\n"]))),Wr=function(e){return{label:J(e),value:e}},Yr=function(e){var t,r=e.options,n=e.onChange,a=e.className,i=e.value;return Ee.a.createElement(we.Segment,{className:Yt(a,Hr),options:(t=r,t.map(Wr)),onChange:n,placeholder:"Select Metric",value:i?Wr(r.find((function(e){return e.id===i}))):null})},Xr=function(e,t){switch(void 0===e&&(e=[]),t.type){case"@pipelineVariables/add":return p(p([],d(e)),[{name:"var1",pipelineAgg:""}]);case"@pipelineVariables/remove":return e.slice(0,t.payload.index).concat(e.slice(t.payload.index+1));case"@pipelineVariables/rename":return e.map((function(e,r){return r!==t.payload.index?e:o(o({},e),{name:t.payload.newName})}));case"@pipelineVariables/change_metric":return e.map((function(e,r){return r!==t.payload.index?e:o(o({},e),{pipelineAgg:t.payload.newMetric})}));default:return e}};function Jr(e){var t=e.label,r=e.settingName,n=e.metric,a=e.placeholder,i=e.tooltip,o=Ir(),s=d(Object(be.useState)(Object(h.uniqueId)("es-field-id-")),1)[0],l=n.settings;return Ee.a.createElement(we.InlineField,{label:t,labelWidth:16,tooltip:i},Ee.a.createElement(we.Input,{id:s,placeholder:a,onBlur:function(e){return o(Qr(n,r,e.target.value))},defaultValue:null==l?void 0:l[r]}))}var Zr,Kr,en,tn,rn,nn,an,on,sn,ln,un,cn,dn,pn,fn,hn=function(e){var t=e.value,r=e.previousMetrics,n=Ir(),a=Sr((function(e){return n({type:"@metrics/change_attr",payload:{metric:t,attribute:"pipelineVariables",newValue:e}})}),t.pipelineVariables,Xr);return Object(be.useEffect)((function(){var e;(null===(e=t.pipelineVariables)||void 0===e?void 0:e.length)||a({type:"@pipelineVariables/add"})}),[]),Ee.a.createElement(Ee.a.Fragment,null,Ee.a.createElement("div",{className:Xt(Zr||(Zr=f(["\n          display: flex;\n        "],["\n          display: flex;\n        "])))},Ee.a.createElement(we.InlineLabel,{width:16},"Variables"),Ee.a.createElement("div",{className:Xt(Kr||(Kr=f(["\n            display: grid;\n            grid-template-columns: 1fr auto;\n            row-gap: 4px;\n            margin-bottom: 4px;\n          "],["\n            display: grid;\n            grid-template-columns: 1fr auto;\n            row-gap: 4px;\n            margin-bottom: 4px;\n          "])))},t.pipelineVariables.map((function(e,n){return Ee.a.createElement(be.Fragment,{key:e.name},Ee.a.createElement("div",{className:Xt(en||(en=f(["\n                  display: grid;\n                  column-gap: 4px;\n                  grid-template-columns: auto auto;\n                "],["\n                  display: grid;\n                  column-gap: 4px;\n                  grid-template-columns: auto auto;\n                "])))},Ee.a.createElement(we.Input,{defaultValue:e.name,placeholder:"Variable Name",onBlur:function(e){return a(function(e,t){return{type:"@pipelineVariables/rename",payload:{index:t,newName:e}}}(e.target.value,n))}}),Ee.a.createElement(Yr,{onChange:function(e){return a(function(e,t){return{type:"@pipelineVariables/change_metric",payload:{index:t,newMetric:e}}}(e.value.id,n))},options:r,value:e.pipelineAgg})),Ee.a.createElement(zr,{index:n,elements:t.pipelineVariables||[],onAdd:function(){return a({type:"@pipelineVariables/add"})},onRemove:function(){return a(function(e){return{type:"@pipelineVariables/remove",payload:{index:e}}}(n))}}))})))),Ee.a.createElement(Jr,{label:"Script",metric:t,settingName:"script",tooltip:"Scripting language is Painless. Use params.<var> to reference a variable.",placeholder:"params.var1 / params.var2"}))},mn=Object(we.stylesFactory)((function(e,t){return{wrapper:Xt(tn||(tn=f(["\n      display: flex;\n      flex-direction: column;\n    "],["\n      display: flex;\n      flex-direction: column;\n    "]))),settingsWrapper:Xt(rn||(rn=f(["\n      padding-top: ",";\n    "],["\n      padding-top: ",";\n    "])),e.spacing.xs),icon:Xt(nn||(nn=f(["\n      margin-right: ",";\n    "],["\n      margin-right: ",";\n    "])),e.spacing.xs),button:Xt(on||(on=f(["\n      justify-content: start;\n      ","\n    "],["\n      justify-content: start;\n      ","\n    "])),t&&Xt(an||(an=f(["\n          color: ",";\n        "],["\n          color: ",";\n        "])),e.colors.textFaint))}})),gn=function(e){var t=e.label,r=e.children,n=e.hidden,a=void 0!==n&&n,i=d(Object(be.useState)(!1),2),o=i[0],s=i[1],l=mn(Object(we.useTheme)(),a);return Ee.a.createElement("div",{className:Yt(l.wrapper)},Ee.a.createElement("button",{className:Yt("gf-form-label query-part",l.button,Mr),onClick:function(){return s(!o)},"aria-expanded":o},Ee.a.createElement(we.Icon,{name:o?"angle-down":"angle-right","aria-hidden":"true",className:l.icon}),t),o&&Ee.a.createElement("div",{className:l.settingsWrapper},r))},vn=function(e){var t,r,n,a,i,s,l,u,c,d,p,f,h,m,g,v,y,b,E,w,x,S=e.metric,_=Ir();return Ee.a.createElement(Ee.a.Fragment,null,Ee.a.createElement(we.InlineField,{label:"Model"},Ee.a.createElement(we.Select,{onChange:function(e){return _(Qr(S,"model",e.value))},options:Q,value:null===(t=S.settings)||void 0===t?void 0:t.model})),Ee.a.createElement(we.InlineField,{label:"Window"},Ee.a.createElement(we.Input,{onBlur:function(e){return _(Qr(S,"window",parseInt(e.target.value,10)))},defaultValue:null===(r=S.settings)||void 0===r?void 0:r.window})),Ee.a.createElement(we.InlineField,{label:"Predict"},Ee.a.createElement(we.Input,{onBlur:function(e){return _(Qr(S,"predict",parseInt(e.target.value,10)))},defaultValue:null===(n=S.settings)||void 0===n?void 0:n.predict})),function(e){var t;return"ewma"===(null===(t=e.settings)||void 0===t?void 0:t.model)}(S)&&Ee.a.createElement(Ee.a.Fragment,null,Ee.a.createElement(we.InlineField,{label:"Alpha"},Ee.a.createElement(we.Input,{onBlur:function(e){return _(Qr(S,"alpha",parseInt(e.target.value,10)))},defaultValue:null===(a=S.settings)||void 0===a?void 0:a.alpha})),Ee.a.createElement(we.InlineField,{label:"Minimize"},Ee.a.createElement(we.Switch,{onChange:function(e){return _(Qr(S,"minimize",e.target.checked))},checked:!!(null===(i=S.settings)||void 0===i?void 0:i.minimize)}))),function(e){var t;return"holt"===(null===(t=e.settings)||void 0===t?void 0:t.model)}(S)&&Ee.a.createElement(Ee.a.Fragment,null,Ee.a.createElement(we.InlineField,{label:"Alpha"},Ee.a.createElement(we.Input,{onBlur:function(e){var t;return _(Qr(S,"settings",o(o({},null===(t=S.settings)||void 0===t?void 0:t.settings),{alpha:parseInt(e.target.value,10)})))},defaultValue:null===(l=null===(s=S.settings)||void 0===s?void 0:s.settings)||void 0===l?void 0:l.alpha})),Ee.a.createElement(we.InlineField,{label:"Beta"},Ee.a.createElement(we.Input,{onBlur:function(e){var t;return _(Qr(S,"settings",o(o({},null===(t=S.settings)||void 0===t?void 0:t.settings),{beta:parseInt(e.target.value,10)})))},defaultValue:null===(c=null===(u=S.settings)||void 0===u?void 0:u.settings)||void 0===c?void 0:c.beta})),Ee.a.createElement(we.InlineField,{label:"Minimize"},Ee.a.createElement(we.Switch,{onChange:function(e){return _(Qr(S,"minimize",e.target.checked))},checked:!!(null===(d=S.settings)||void 0===d?void 0:d.minimize)}))),function(e){var t;return"holt_winters"===(null===(t=e.settings)||void 0===t?void 0:t.model)}(S)&&Ee.a.createElement(Ee.a.Fragment,null,Ee.a.createElement(we.InlineField,{label:"Alpha"},Ee.a.createElement(we.Input,{onBlur:function(e){var t;return _(Qr(S,"settings",o(o({},null===(t=S.settings)||void 0===t?void 0:t.settings),{alpha:parseInt(e.target.value,10)})))},defaultValue:null===(f=null===(p=S.settings)||void 0===p?void 0:p.settings)||void 0===f?void 0:f.alpha})),Ee.a.createElement(we.InlineField,{label:"Beta"},Ee.a.createElement(we.Input,{onBlur:function(e){var t;return _(Qr(S,"settings",o(o({},null===(t=S.settings)||void 0===t?void 0:t.settings),{beta:parseInt(e.target.value,10)})))},defaultValue:null===(m=null===(h=S.settings)||void 0===h?void 0:h.settings)||void 0===m?void 0:m.beta})),Ee.a.createElement(we.InlineField,{label:"Gamma"},Ee.a.createElement(we.Input,{onBlur:function(e){var t;return _(Qr(S,"settings",o(o({},null===(t=S.settings)||void 0===t?void 0:t.settings),{gamma:parseInt(e.target.value,10)})))},defaultValue:null===(v=null===(g=S.settings)||void 0===g?void 0:g.settings)||void 0===v?void 0:v.gamma})),Ee.a.createElement(we.InlineField,{label:"Period"},Ee.a.createElement(we.Input,{onBlur:function(e){var t;return _(Qr(S,"settings",o(o({},null===(t=S.settings)||void 0===t?void 0:t.settings),{period:parseInt(e.target.value,10)})))},defaultValue:null===(b=null===(y=S.settings)||void 0===y?void 0:y.settings)||void 0===b?void 0:b.period})),Ee.a.createElement(we.InlineField,{label:"Pad"},Ee.a.createElement(we.Switch,{onChange:function(e){var t;return _(Qr(S,"settings",o(o({},null===(t=S.settings)||void 0===t?void 0:t.settings),{pad:e.target.checked})))},checked:!!(null===(w=null===(E=S.settings)||void 0===E?void 0:E.settings)||void 0===w?void 0:w.pad)})),Ee.a.createElement(we.InlineField,{label:"Minimize"},Ee.a.createElement(we.Switch,{onChange:function(e){return _(Qr(S,"minimize",e.target.checked))},checked:!!(null===(x=S.settings)||void 0===x?void 0:x.minimize)}))))},yn={labelWidth:16},bn=function(e){var t,r,n,a,i,s=e.metric,l=e.previousMetrics,u=Ir(),c=function(e){var t,r,n,a,i,o;switch(e.type){case"cardinality":return"Precision threshold: "+((null===(t=e.settings)||void 0===t?void 0:t.precision_threshold)||"");case"percentiles":return(null===(r=e.settings)||void 0===r?void 0:r.percents)&&(null===(a=null===(n=e.settings)||void 0===n?void 0:n.percents)||void 0===a?void 0:a.length)>=1?"Values: "+(null===(i=e.settings)||void 0===i?void 0:i.percents):"Percents: Default";case"extended_stats":var s=Object.entries(e.meta||{}).map((function(e){var t,r=d(e,2),n=r[0];return r[1]&&(null===(t=B.find(function(e){return function(t){return t.value===e}}(n)))||void 0===t?void 0:t.label)})).filter(Boolean);return"Stats: "+(s.length>0?s.join(", "):"None selected");case"raw_document":case"raw_data":return"Size: "+((null===(o=e.settings)||void 0===o?void 0:o.size)||500);default:return"Options"}}(s),p=$r();return Ee.a.createElement(gn,{label:c,hidden:s.hide},"derivative"===s.type&&Ee.a.createElement(Jr,{label:"Unit",metric:s,settingName:"unit"}),"cumulative_sum"===s.type&&Ee.a.createElement(Jr,{label:"Format",metric:s,settingName:"format"}),"moving_avg"===s.type&&Ee.a.createElement(vn,{metric:s}),"moving_fn"===s.type&&Ee.a.createElement(Ee.a.Fragment,null,Ee.a.createElement(Jr,{label:"Window",metric:s,settingName:"window"}),Ee.a.createElement(Jr,{label:"Script",metric:s,settingName:"script"}),Ee.a.createElement(Jr,{label:"Shift",metric:s,settingName:"shift"})),"bucket_script"===s.type&&Ee.a.createElement(hn,{value:s,previousMetrics:l}),("raw_data"===s.type||"raw_document"===s.type)&&Ee.a.createElement(we.InlineField,o({label:"Size"},yn),Ee.a.createElement(we.Input,{id:"ES-query-"+p.refId+"_metric-"+s.id+"-size",onBlur:function(e){return u(Qr(s,"size",e.target.value))},defaultValue:null!==(r=null===(t=s.settings)||void 0===t?void 0:t.size)&&void 0!==r?r:null===(n=V.raw_data.defaults.settings)||void 0===n?void 0:n.size})),"cardinality"===s.type&&Ee.a.createElement(Jr,{label:"Precision Threshold",metric:s,settingName:"precision_threshold"}),"extended_stats"===s.type&&Ee.a.createElement(Ee.a.Fragment,null,B.map((function(e){var t,r,n;return Ee.a.createElement(En,{key:e.value,stat:e,onChange:function(t){return u(function(e,t,r){return{type:"@metrics/change_meta",payload:{metric:e,meta:t,newValue:r}}}(s,e.value,t))},value:void 0!==(null===(t=s.meta)||void 0===t?void 0:t[e.value])?!!(null===(r=s.meta)||void 0===r?void 0:r[e.value]):!!(null===(n=V.extended_stats.defaults.meta)||void 0===n?void 0:n[e.value])})})),Ee.a.createElement(Jr,{label:"Sigma",metric:s,settingName:"sigma",placeholder:"3"})),"percentiles"===s.type&&Ee.a.createElement(we.InlineField,o({label:"Percentiles"},yn),Ee.a.createElement(we.Input,{onBlur:function(e){return u(Qr(s,"percents",e.target.value.split(",").filter(Boolean)))},defaultValue:(null===(a=s.settings)||void 0===a?void 0:a.percents)||(null===(i=V.percentiles.defaults.settings)||void 0===i?void 0:i.percents),placeholder:"1,5,25,50,75,95,99"})),function(e){return V[e.type].supportsInlineScript}(s)&&Ee.a.createElement(Jr,{label:"Script",metric:s,settingName:"script",placeholder:"_value * 1"}),function(e){return V[e.type].supportsMissing}(s)&&Ee.a.createElement(Jr,{label:"Missing",metric:s,settingName:"missing",tooltip:"The missing parameter defines how documents that are missing a value should be treated. By default\n            they will be ignored but it is also possible to treat them as if they had a value"}))},En=function(e){var t=e.stat,r=e.onChange,n=e.value,a=d(Object(be.useState)(Object(h.uniqueId)("es-field-id-")),1)[0];return Ee.a.createElement(we.InlineField,o({label:t.label},yn,{key:t.value}),Ee.a.createElement(we.Switch,{id:a,onChange:function(e){return r(e.target.checked)},value:n}))},wn=function(e){var t=e.value,r=e.text;return{label:r,value:""+(t||r)}},xn=function(e){return!V[e.type].isPipelineAgg},Sn=function(e,t){var r=e.some(xn);return Object.entries(V).filter((function(e){var r=d(e,2),n=(r[0],r[1].versionRange),a=void 0===n?"*":n;return Object(wr.satisfies)(t,a)})).filter((function(e){var t=d(e,2),n=(t[0],t[1]);return r||!n.isPipelineAgg})).map((function(e){var t=d(e,2),r=t[0];return{label:t[1].label,value:r}}))},_n=function(e){var t,r=e.value,n=qr(Object(we.useTheme)(),!!r.hide),a=Cr(),i=$r(),o=Ir(),s=i.metrics.slice(0,i.metrics.findIndex((function(e){return e.id===r.id})));return Ee.a.createElement(Ee.a.Fragment,null,Ee.a.createElement(we.Segment,{className:Yt(n.color,Mr),options:Sn(s,a.version),onChange:function(e){return o((t=r.id,n=e.value,{type:"@metrics/change_type",payload:{id:t,type:n}}));var t,n},value:(t=r,{label:V[t.type].label,value:t.type})}),$(r)&&!C(r)&&Ee.a.createElement(we.SegmentAsync,{className:Yt(n.color,Mr),loadOptions:function(){return l(void 0,void 0,void 0,(function(){return u(this,(function(e){switch(e.label){case 0:return[4,function(){return"cardinality"===r.type?a.getFields():a.getFields("number")}()];case 1:return[2,e.sent().map(wn)]}}))}))},onChange:function(e){return o(Br(r.id,e.value))},placeholder:"Select Field",value:r.field}),C(r)&&!j(r)&&Ee.a.createElement(Yr,{className:Yt(n.color,Mr),onChange:function(e){var t;return o(Br(r.id,null===(t=e.value)||void 0===t?void 0:t.id))},options:s,value:r.field}),M(r)&&Ee.a.createElement(bn,{metric:r,previousMetrics:s}))},In=function(e){var t=e.children,r=e.label,n=e.onRemoveClick,a=e.onHideClick,i=e.hidden,o=void 0!==i&&i,s=e.disableRemove,l=void 0!==s&&s,u=Object(we.useTheme)(),c=On(u);return Ee.a.createElement(we.InlineFieldRow,null,Ee.a.createElement(we.InlineSegmentGroup,null,Ee.a.createElement(we.InlineLabel,{width:17,as:"div"},Ee.a.createElement("span",null,r),Ee.a.createElement("span",{className:c.iconWrapper},a&&Ee.a.createElement(we.IconButton,{name:o?"eye-slash":"eye",onClick:a,surface:"header",size:"sm","aria-pressed":o,"aria-label":"hide metric",className:c.icon}),n&&Ee.a.createElement(we.IconButton,{name:"trash-alt",surface:"header",size:"sm",className:c.icon,onClick:n||h.noop,disabled:l,"aria-label":"remove metric"})))),t)},On=Object(we.stylesFactory)((function(e){return{iconWrapper:Xt(sn||(sn=f(["\n      display: flex;\n    "],["\n      display: flex;\n    "]))),icon:Xt(ln||(ln=f(["\n      color: ",";\n      margin-left: ",";\n    "],["\n      color: ",";\n      margin-left: ",";\n    "])),e.colors.textWeak,e.spacing.xxs)}})),Tn=function(e){var t=e.nextId,r=Ir(),n=$r().metrics,a=(null==n?void 0:n.length)||0;return Ee.a.createElement(Ee.a.Fragment,null,null==n?void 0:n.map((function(e,n){return Ee.a.createElement(In,{key:e.id,label:"Metric ("+e.id+")",hidden:e.hide,onHideClick:function(){return r({type:"@metrics/toggle_visibility",payload:{id:e.id}})},onRemoveClick:function(){return r({type:"@metrics/remove",payload:{id:e.id}})},disableRemove:!(a>1)},Ee.a.createElement(_n,{value:e}),!V[e.type].isSingleMetric&&0===n&&Ee.a.createElement(Ur,{iconName:"plus",onClick:function(){return r({type:"@metrics/add",payload:{id:t}})},label:"add"}))})))},An=function(e,t,r){return{type:"@bucketAggs/change_setting",payload:{bucketAgg:e,settingName:t,newValue:r}}},kn=function(e,t){return{type:"@bucketAggregations/filter/change",payload:{index:e,filter:t}}},Pn=function(e,t){switch(void 0===e&&(e=[]),t.type){case"@bucketAggregations/filter/add":return p(p([],d(e)),[{label:"",query:"*"}]);case"@bucketAggregations/filter/remove":return e.slice(0,t.payload.index).concat(e.slice(t.payload.index+1));case"@bucketAggregations/filter/change":return e.map((function(e,r){return r!==t.payload.index?e:t.payload.filter}))}},Fn=function(e){var t,r,n=e.value,a=Ir(),i=Sr((function(e){return a(An(n,"filters",e))}),null===(t=n.settings)||void 0===t?void 0:t.filters,Pn);return Object(be.useEffect)((function(){var e,t;(null===(t=null===(e=n.settings)||void 0===e?void 0:e.filters)||void 0===t?void 0:t.length)||i({type:"@bucketAggregations/filter/add"})}),[]),Ee.a.createElement(Ee.a.Fragment,null,Ee.a.createElement("div",{className:Xt(un||(un=f(["\n          display: flex;\n          flex-direction: column;\n        "],["\n          display: flex;\n          flex-direction: column;\n        "])))},null===(r=n.settings)||void 0===r?void 0:r.filters.map((function(e,t){var r;return Ee.a.createElement("div",{key:t,className:Xt(cn||(cn=f(["\n              display: flex;\n            "],["\n              display: flex;\n            "])))},Ee.a.createElement("div",{className:Xt(dn||(dn=f(["\n                width: 250px;\n              "],["\n                width: 250px;\n              "])))},Ee.a.createElement(we.InlineField,{label:"Query",labelWidth:10},Ee.a.createElement(we.QueryField,{placeholder:"Lucene Query",portalOrigin:"opensearch",onBlur:function(){},onChange:function(r){return i(kn(t,o(o({},e),{query:r})))},query:e.query}))),Ee.a.createElement(we.InlineField,{label:"Label",labelWidth:10},Ee.a.createElement(we.Input,{placeholder:"Label",onBlur:function(r){return i(kn(t,o(o({},e),{label:r.target.value})))},defaultValue:e.label})),Ee.a.createElement(zr,{index:t,elements:(null===(r=n.settings)||void 0===r?void 0:r.filters)||[],onAdd:function(){return i({type:"@bucketAggregations/filter/add"})},onRemove:function(){return i(function(e){return{type:"@bucketAggregations/filter/remove",payload:{index:e}}}(t))}}))}))))},Nn=function(e){return function(t){return t.value===e}},Ln={labelWidth:16},Rn=function(e){var t,r,n,a,i,s,l,u,c,f,h,m,g,v,y,b,E,w,x,S,_,I,O,T,A=e.bucketAgg,k=Ir(),P=$r().metrics,F=function(e){var t,r,n,a,i,o,s,l,u,c,d,p,f,h=$r().metrics;switch(e.type){case"terms":var m=(null===(t=e.settings)||void 0===t?void 0:t.order)||"desc",g=(null===(r=e.settings)||void 0===r?void 0:r.size)||"10",v=parseInt((null===(n=e.settings)||void 0===n?void 0:n.min_doc_count)||"0",10),y=(null===(a=e.settings)||void 0===a?void 0:a.orderBy)||"_term",b="";if("0"!==g)b=(null===(i=ce.find(Nn(m)))||void 0===i?void 0:i.label)+" "+g+", ";v>0&&(b+="Min Doc Count: "+v+", "),b+="Order by: ";var E=pe.find(Nn(y));if(E)b+=E.label;else{var w=null==h?void 0:h.find((function(e){return e.id===y}));b+=w?J(w):"metric not found"}return"0"===g&&(b+=" ("+m+")"),b;case"histogram":return"Interval: "+(x=(null===(o=e.settings)||void 0===o?void 0:o.interval)||1e3)+((v=(null===(s=e.settings)||void 0===s?void 0:s.min_doc_count)||1)>0?", Min Doc Count: "+v:"");case"filters":return"Filter Queries ("+((null===(l=e.settings)||void 0===l?void 0:l.filters)||(null===(u=ue.filters.defaultSettings)||void 0===u?void 0:u.filters)).length+")";case"geohash_grid":return"Precision: "+Math.max(Math.min(parseInt((null===(c=e.settings)||void 0===c?void 0:c.precision)||"5",10),12),1);case"date_histogram":var x=(null===(d=e.settings)||void 0===d?void 0:d.interval)||"auto",S=(v=(null===(p=e.settings)||void 0===p?void 0:p.min_doc_count)||0,(null===(f=e.settings)||void 0===f?void 0:f.trimEdges)||0);b="Interval: "+x;return v>0&&(b+=", Min Doc Count: "+v),S>0&&(b+=", Trim edges: "+S),b;default:return"Settings"}}(A),N=p(p([],d(pe)),d((P||[]).map((function(e){return{label:J(e),value:e.id}}))));return Ee.a.createElement(gn,{label:F},"terms"===A.type&&Ee.a.createElement(Ee.a.Fragment,null,Ee.a.createElement(we.InlineField,o({label:"Order"},Ln),Ee.a.createElement(we.Select,{onChange:function(e){return k(An(A,"order",e.value))},options:ce,value:(null===(t=A.settings)||void 0===t?void 0:t.order)||(null===(r=ue[A.type].defaultSettings)||void 0===r?void 0:r.order)})),Ee.a.createElement(we.InlineField,o({label:"Size"},Ln),Ee.a.createElement(we.Select,{onChange:function(e){return k(An(A,"size",e.value))},options:de,value:(null===(n=A.settings)||void 0===n?void 0:n.size)||(null===(a=ue[A.type].defaultSettings)||void 0===a?void 0:a.size),allowCustomValue:!0})),Ee.a.createElement(we.InlineField,o({label:"Min Doc Count"},Ln),Ee.a.createElement(we.Input,{onBlur:function(e){return k(An(A,"min_doc_count",e.target.value))},defaultValue:(null===(i=A.settings)||void 0===i?void 0:i.min_doc_count)||(null===(s=ue[A.type].defaultSettings)||void 0===s?void 0:s.min_doc_count)})),Ee.a.createElement(we.InlineField,o({label:"Order By"},Ln),Ee.a.createElement(we.Select,{onChange:function(e){return k(An(A,"orderBy",e.value))},options:N,value:(null===(l=A.settings)||void 0===l?void 0:l.orderBy)||(null===(u=ue[A.type].defaultSettings)||void 0===u?void 0:u.orderBy)})),Ee.a.createElement(we.InlineField,o({label:"Missing"},Ln),Ee.a.createElement(we.Input,{onBlur:function(e){return k(An(A,"missing",e.target.value))},defaultValue:(null===(c=A.settings)||void 0===c?void 0:c.missing)||(null===(f=ue[A.type].defaultSettings)||void 0===f?void 0:f.missing)}))),"geohash_grid"===A.type&&Ee.a.createElement(we.InlineField,o({label:"Precision"},Ln),Ee.a.createElement(we.Input,{onBlur:function(e){return k(An(A,"precision",e.target.value))},defaultValue:(null===(h=A.settings)||void 0===h?void 0:h.precision)||(null===(m=ue[A.type].defaultSettings)||void 0===m?void 0:m.precision)})),"date_histogram"===A.type&&Ee.a.createElement(Ee.a.Fragment,null,Ee.a.createElement(we.InlineField,o({label:"Interval"},Ln),Ee.a.createElement(we.Select,{onChange:function(e){return k(An(A,"interval",e.value))},options:fe,value:(null===(g=A.settings)||void 0===g?void 0:g.interval)||(null===(v=ue[A.type].defaultSettings)||void 0===v?void 0:v.interval),allowCustomValue:!0})),Ee.a.createElement(we.InlineField,o({label:"Min Doc Count"},Ln),Ee.a.createElement(we.Input,{onBlur:function(e){return k(An(A,"min_doc_count",e.target.value))},defaultValue:(null===(y=A.settings)||void 0===y?void 0:y.min_doc_count)||(null===(b=ue[A.type].defaultSettings)||void 0===b?void 0:b.min_doc_count)})),Ee.a.createElement(we.InlineField,o({label:"Trim Edges"},Ln,{tooltip:"Trim the edges on the timeseries datapoints"}),Ee.a.createElement(we.Input,{onBlur:function(e){return k(An(A,"trimEdges",e.target.value))},defaultValue:(null===(E=A.settings)||void 0===E?void 0:E.trimEdges)||(null===(w=ue[A.type].defaultSettings)||void 0===w?void 0:w.trimEdges)})),Ee.a.createElement(we.InlineField,o({label:"Offset"},Ln,{tooltip:"Change the start value of each bucket by the specified positive (+) or negative offset (-) duration, such as 1h for an hour, or 1d for a day"}),Ee.a.createElement(we.Input,{onBlur:function(e){return k(An(A,"offset",e.target.value))},defaultValue:(null===(x=A.settings)||void 0===x?void 0:x.offset)||(null===(S=ue[A.type].defaultSettings)||void 0===S?void 0:S.offset)}))),"histogram"===A.type&&Ee.a.createElement(Ee.a.Fragment,null,Ee.a.createElement(we.InlineField,o({label:"Interval"},Ln),Ee.a.createElement(we.Input,{onBlur:function(e){return k(An(A,"interval",e.target.value))},defaultValue:(null===(_=A.settings)||void 0===_?void 0:_.interval)||(null===(I=ue[A.type].defaultSettings)||void 0===I?void 0:I.interval)})),Ee.a.createElement(we.InlineField,o({label:"Min Doc Count"},Ln),Ee.a.createElement(we.Input,{onBlur:function(e){return k(An(A,"min_doc_count",e.target.value))},defaultValue:(null===(O=A.settings)||void 0===O?void 0:O.min_doc_count)||(null===(T=ue[A.type].defaultSettings)||void 0===T?void 0:T.min_doc_count)}))),"filters"===A.type&&Ee.a.createElement(Fn,{value:A}))},Dn=Object.entries(ue).map((function(e){var t=d(e,2),r=t[0];return{label:t[1].label,value:r}})),$n=function(e){var t=e.value,r=e.text;return{label:r,value:""+(t||r)}},Cn=function(e){var t,r=e.value,n=Cr(),a=Ir();return Ee.a.createElement(Ee.a.Fragment,null,Ee.a.createElement(we.Segment,{className:Mr,options:Dn,onChange:function(e){return a((t=r.id,n=e.value,{type:"@bucketAggs/change_type",payload:{id:t,newType:n}}));var t,n},value:(t=r,{label:ue[t.type].label,value:t.type})}),he(r)&&Ee.a.createElement(we.SegmentAsync,{className:Mr,loadOptions:function(){return l(void 0,void 0,void 0,(function(){return u(this,(function(e){switch(e.label){case 0:return[4,function(){switch(r.type){case"date_histogram":return n.getFields("date");case"geohash_grid":return n.getFields("geo_point");default:return n.getFields()}}()];case 1:return[2,e.sent().map($n)]}}))}))},onChange:function(e){return a((t=r.id,n=e.value,{type:"@bucketAggs/change_field",payload:{id:t,newField:n}}));var t,n},placeholder:"Select Field",value:r.field}),Ee.a.createElement(Rn,{bucketAgg:r}))},jn=function(e){var t=e.nextId,r=Ir(),n=$r().bucketAggs,a=(null==n?void 0:n.length)||0;return Ee.a.createElement(Ee.a.Fragment,null,n.map((function(e,n){return Ee.a.createElement(In,{key:e.id,label:0===n?"Group By":"Then By",onRemoveClick:function(){return r({type:"@bucketAggs/remove",payload:{id:e.id}})},disableRemove:!(a>1)},Ee.a.createElement(Cn,{value:e}),0===n&&Ee.a.createElement(Ur,{iconName:"plus",onClick:function(){return r({type:"@bucketAggs/add",payload:{id:t}})},label:"add"}))})))},Mn=function(e){return e.id},Vn=function(e){return parseInt(e,10)},qn=function(e){var t=e.query,r=Ir(),n=function(){var e=$r(),t=e.metrics,r=e.bucketAggs;return Object(be.useMemo)((function(){return(Math.max.apply(Math,p([],d(p(p([],d((null==t?void 0:t.map(Mn))||["0"])),d((null==r?void 0:r.map(Mn))||["0"])).map(Vn))))+1).toString()}),[t,r])}();return Ee.a.createElement(Ee.a.Fragment,null,Ee.a.createElement(we.InlineFieldRow,null,Ee.a.createElement(we.InlineField,{label:"Query",labelWidth:17,grow:!0},Ee.a.createElement(Ee.a.Fragment,null,Ee.a.createElement(Vr,{value:H.Lucene}),Ee.a.createElement(we.QueryField,{query:t,onBlur:function(){},onChange:function(e){return r(Tr(e))},placeholder:"Lucene Query",portalOrigin:"opensearch"}))),Ee.a.createElement(we.InlineField,{label:"Alias",labelWidth:15},Ee.a.createElement(we.Input,{placeholder:"Alias Pattern",onBlur:function(e){return r({type:"change_alias_pattern",payload:{aliasPattern:e.currentTarget.value}})}}))),Ee.a.createElement(Tn,{nextId:n}),Ee.a.createElement(jn,{nextId:n}))},Bn={table:{label:"Table"},logs:{label:"Logs"},time_series:{label:"Time series"}},Qn=Object.entries(Bn).map((function(e){var t=d(e,2),r=t[0];return{label:t[1].label,value:r}})),Gn=function(e){var t,r=e.value,n=Ir();return Ee.a.createElement(we.Segment,{className:Mr,options:Qn,onChange:function(e){return n({type:"change_format",payload:{format:e.value}})},value:(t=r,{label:Bn[t].label,value:t})})},Un=Object(we.stylesFactory)((function(e){return{icon:Xt(pn||(pn=f(["\n      margin-right: ",";\n    "],["\n      margin-right: ",";\n    "])),e.spacing.xs),button:Xt(fn||(fn=f(["\n      justify-content: start;\n    "],["\n      justify-content: start;\n    "])))}})),zn=function(e){var t=e.label,r=e.open,n=e.onClick,a=Un(Object(we.useTheme)());return Ee.a.createElement("button",{className:Yt("gf-form-label",a.button,Mr),onClick:n,"aria-expanded":r},Ee.a.createElement(we.Icon,{name:r?"angle-down":"angle-right","aria-hidden":"true",className:a.icon}),t)},Hn=function(){return Ee.a.createElement("div",{className:"gf-form grafana-info-box"},Ee.a.createElement("div",null,Ee.a.createElement("h5",null,"Table"),Ee.a.createElement("ul",null,Ee.a.createElement("li",null,"return any set of columns")),Ee.a.createElement("br",null),Ee.a.createElement("h5",null,"Logs"),Ee.a.createElement("ul",null,Ee.a.createElement("li",null,"return any set of columns")),Ee.a.createElement("br",null),Ee.a.createElement("h5",null,"Time series"),Ee.a.createElement("ul",null,Ee.a.createElement("li",null,"return column as date, datetime, or timestamp"),Ee.a.createElement("li",null,"return column with numeric datatype as values")),Ee.a.createElement("br",null),"Example PPL query for time series:",Ee.a.createElement("br",null),Ee.a.createElement("code",null,"source=<index> | eval dateValue=timestamp(timestamp) | stats count(response) by dateValue")))},Wn=function(){var e=$r().format,t=d(Object(be.useState)(!1),2),r=t[0],n=t[1];return Ee.a.createElement(Ee.a.Fragment,null,Ee.a.createElement(In,{label:"Format"},Ee.a.createElement(Gn,{value:null!=e?e:"table"}),Ee.a.createElement(zn,{label:"Show help",open:r,onClick:function(){return n(!r)}})),r&&Ee.a.createElement(Hn,null))},Yn=function(e){var t=e.query,r=Ir();return Ee.a.createElement(Ee.a.Fragment,null,Ee.a.createElement(we.InlineFieldRow,null,Ee.a.createElement(we.InlineField,{label:"Query",labelWidth:17,grow:!0},Ee.a.createElement(Ee.a.Fragment,null,Ee.a.createElement(Vr,{value:H.PPL}),Ee.a.createElement(we.QueryField,{query:t,onBlur:function(){},onChange:function(e){return r(Tr(e))},placeholder:"PPL Query",portalOrigin:"opensearch"})))),Ee.a.createElement(Wn,null))},Xn=function(e){var t=e.value;switch(t.queryType){case H.PPL:return Ee.a.createElement(Yn,{query:t.query});default:return Ee.a.createElement(qn,{query:t.query})}};r.d(t,"plugin",(function(){return Zn}));var Jn=function(){function e(){}return e.templateUrl="partials/annotations.editor.html",e}(),Zn=new n.DataSourcePlugin(ve).setQueryEditor((function(e){var t=e.query,r=e.onChange,n=e.datasource;return Ee.a.createElement(Dr,{datasource:n,onChange:r,query:t},Ee.a.createElement(Xn,{value:t}))})).setConfigEditor((function(e){var t=e.options,r=e.onOptionsChange,n=xr(t);return Object(be.useEffect)((function(){(function(e){return!!Object(wr.valid)(e.jsonData.version)&&!!e.jsonData.timeField&&!!e.jsonData.maxConcurrentShardRequests&&void 0!==e.jsonData.logMessageField&&void 0!==e.jsonData.logLevelField})(t)||r(xr(t))}),[]),Ee.a.createElement(Ee.a.Fragment,null,Ee.a.createElement(we.DataSourceHttpSettings,{defaultUrl:"http://localhost:9200",dataSourceConfig:n,showAccessOptions:!0,onChange:r,sigV4AuthToggleEnabled:le.config.sigV4AuthEnabled}),Ee.a.createElement(Ae,{value:n,onChange:r}),Ee.a.createElement(Le,{value:n.jsonData,onChange:function(e){return r(o(o({},n),{jsonData:e}))}}),Ee.a.createElement(Er,{value:n.jsonData.dataLinks,onChange:function(e){r(o(o({},n),{jsonData:o(o({},n.jsonData),{dataLinks:e})}))}}))})).setAnnotationQueryCtrl(Jn)}])}));
//# sourceMappingURL=module.js.map